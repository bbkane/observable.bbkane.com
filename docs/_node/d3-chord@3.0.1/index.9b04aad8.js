import{path as H}from"../d3-path@3.1.0/index.c2b3c473.js";var I=Math.abs,T=Math.cos,w=Math.sin,O=Math.PI,q=O/2,R=O*2,S=Math.max,j=1e-12;function D(s,y){return Array.from({length:y-s},(h,p)=>s+p)}function J(s){return function(y,h){return s(y.source.value+y.target.value,h.source.value+h.target.value)}}function P(){return F(!1,!1)}function Q(){return F(!1,!0)}function k(){return F(!0,!1)}function F(s,y){var h=0,p=null,A=null,m=null;function f(u){var t=u.length,a=new Array(t),r=D(0,t),g=new Array(t*t),M=new Array(t),i=0,v;u=Float64Array.from({length:t*t},y?(l,n)=>u[n%t][n/t|0]:(l,n)=>u[n/t|0][n%t]);for(let l=0;l<t;++l){let n=0;for(let c=0;c<t;++c)n+=u[l*t+c]+s*u[c*t+l];i+=a[l]=n}i=S(0,R-h*t)/i,v=i?h:R/t;{let l=0;p&&r.sort((n,c)=>p(a[n],a[c]));for(const n of r){const c=l;if(s){const d=D(~t+1,t).filter(e=>e<0?u[~e*t+n]:u[n*t+e]);A&&d.sort((e,o)=>A(e<0?-u[~e*t+n]:u[n*t+e],o<0?-u[~o*t+n]:u[n*t+o]));for(const e of d)if(e<0){const o=g[~e*t+n]||(g[~e*t+n]={source:null,target:null});o.target={index:n,startAngle:l,endAngle:l+=u[~e*t+n]*i,value:u[~e*t+n]}}else{const o=g[n*t+e]||(g[n*t+e]={source:null,target:null});o.source={index:n,startAngle:l,endAngle:l+=u[n*t+e]*i,value:u[n*t+e]}}M[n]={index:n,startAngle:c,endAngle:l,value:a[n]}}else{const d=D(0,t).filter(e=>u[n*t+e]||u[e*t+n]);A&&d.sort((e,o)=>A(u[n*t+e],u[n*t+o]));for(const e of d){let o;if(n<e?(o=g[n*t+e]||(g[n*t+e]={source:null,target:null}),o.source={index:n,startAngle:l,endAngle:l+=u[n*t+e]*i,value:u[n*t+e]}):(o=g[e*t+n]||(g[e*t+n]={source:null,target:null}),o.target={index:n,startAngle:l,endAngle:l+=u[n*t+e]*i,value:u[n*t+e]},n===e&&(o.source=o.target)),o.source&&o.target&&o.source.value<o.target.value){const C=o.source;o.source=o.target,o.target=C}}M[n]={index:n,startAngle:c,endAngle:l,value:a[n]}}l+=v}}return g=Object.values(g),g.groups=M,m?g.sort(m):g}return f.padAngle=function(u){return arguments.length?(h=S(0,u),f):h},f.sortGroups=function(u){return arguments.length?(p=u,f):p},f.sortSubgroups=function(u){return arguments.length?(A=u,f):A},f.sortChords=function(u){return arguments.length?(u==null?m=null:(m=J(u))._=u,f):m&&m._},f}var z=Array.prototype.slice;function x(s){return function(){return s}}function B(s){return s.source}function K(s){return s.target}function _(s){return s.radius}function L(s){return s.startAngle}function N(s){return s.endAngle}function U(){return 0}function V(){return 10}function E(s){var y=B,h=K,p=_,A=_,m=L,f=N,u=U,t=null;function a(){var r,g=y.apply(this,arguments),M=h.apply(this,arguments),i=u.apply(this,arguments)/2,v=z.call(arguments),l=+p.apply(this,(v[0]=g,v)),n=m.apply(this,v)-q,c=f.apply(this,v)-q,d=+A.apply(this,(v[0]=M,v)),e=m.apply(this,v)-q,o=f.apply(this,v)-q;if(t||(t=r=H()),i>j&&(I(c-n)>i*2+j?c>n?(n+=i,c-=i):(n-=i,c+=i):n=c=(n+c)/2,I(o-e)>i*2+j?o>e?(e+=i,o-=i):(e-=i,o+=i):e=o=(e+o)/2),t.moveTo(l*T(n),l*w(n)),t.arc(0,0,l,n,c),n!==e||c!==o)if(s){var C=+s.apply(this,arguments),b=d-C,G=(e+o)/2;t.quadraticCurveTo(0,0,b*T(e),b*w(e)),t.lineTo(d*T(G),d*w(G)),t.lineTo(b*T(o),b*w(o))}else t.quadraticCurveTo(0,0,d*T(e),d*w(e)),t.arc(0,0,d,e,o);if(t.quadraticCurveTo(0,0,l*T(n),l*w(n)),t.closePath(),r)return t=null,r+""||null}return s&&(a.headRadius=function(r){return arguments.length?(s=typeof r=="function"?r:x(+r),a):s}),a.radius=function(r){return arguments.length?(p=A=typeof r=="function"?r:x(+r),a):p},a.sourceRadius=function(r){return arguments.length?(p=typeof r=="function"?r:x(+r),a):p},a.targetRadius=function(r){return arguments.length?(A=typeof r=="function"?r:x(+r),a):A},a.startAngle=function(r){return arguments.length?(m=typeof r=="function"?r:x(+r),a):m},a.endAngle=function(r){return arguments.length?(f=typeof r=="function"?r:x(+r),a):f},a.padAngle=function(r){return arguments.length?(u=typeof r=="function"?r:x(+r),a):u},a.source=function(r){return arguments.length?(y=r,a):y},a.target=function(r){return arguments.length?(h=r,a):h},a.context=function(r){return arguments.length?(t=r??null,a):t},a}function W(){return E()}function X(){return E(V)}export{P as chord,k as chordDirected,Q as chordTranspose,W as ribbon,X as ribbonArrow};
