import{ascending as cr,descending as _e,timeSecond as Va,timeMinute as Ha,timeHour as Ua,timeDay as Za,timeMonday as Hh,timeTuesday as Uh,timeWednesday as Zh,timeThursday as Kh,timeFriday as Qh,timeSaturday as Jh,timeSunday as td,timeWeek as ed,timeMonth as Ka,timeYear as Qa,utcSecond as Ja,utcMinute as tl,utcHour as el,unixDay as nl,utcMonday as nd,utcTuesday as rd,utcWednesday as od,utcThursday as id,utcFriday as ad,utcSaturday as ld,utcSunday as sd,utcWeek as cd,utcMonth as rl,utcYear as ol,bisector as ud,max as zt,pairs as fd,timeFormat as hd,utcFormat as zo,range as Mn,quantile as An,symbolAsterisk as dd,symbolCircle as So,symbolCross as pd,symbolDiamond as md,symbolDiamond2 as yd,symbolPlus as gd,symbolSquare as $d,symbolSquare2 as vd,symbolStar as xd,symbolTimes as wd,symbolTriangle as bd,symbolTriangle2 as kd,symbolWye as Md,randomLcg as Eo,group as Ce,sort as il,rollup as Ln,sum as qt,InternSet as zn,mode as al,variance as ll,median as Sn,mean as ur,maxIndex as Ad,minIndex as Ld,min as Nt,deviation as fr,rollups as zd,quantize as Bt,schemeAccent as Sd,schemeCategory10 as Ed,schemeDark2 as Od,schemeObservable10 as Cd,schemePaired as Nd,schemePastel1 as Rd,schemePastel2 as Td,schemeSet1 as Id,schemeSet2 as Bd,schemeSet3 as Wd,schemeTableau10 as jd,interpolateBrBG as sl,schemeBrBG as Fd,interpolatePRGn as cl,schemePRGn as Dd,interpolatePiYG as ul,schemePiYG as qd,interpolatePuOr as fl,schemePuOr as Yd,interpolateRdBu as hr,schemeRdBu as hl,interpolateRdGy as dl,schemeRdGy as Pd,interpolateRdYlBu as dr,schemeRdYlBu as pl,interpolateRdYlGn as ml,schemeRdYlGn as Xd,interpolateSpectral as yl,schemeSpectral as _d,interpolateBlues as gl,schemeBlues as Gd,interpolateGreens as $l,schemeGreens as Vd,interpolateGreys as vl,schemeGreys as Hd,interpolateOranges as xl,schemeOranges as Ud,interpolatePurples as wl,schemePurples as Zd,interpolateReds as bl,schemeReds as Kd,interpolateTurbo as kl,interpolateViridis as Ml,interpolateMagma as Al,interpolateInferno as Ll,interpolatePlasma as zl,interpolateCividis as Sl,interpolateCubehelixDefault as El,interpolateWarm as Ol,interpolateCool as Cl,interpolateBuGn as Nl,schemeBuGn as Qd,interpolateBuPu as Rl,schemeBuPu as Jd,interpolateGnBu as Tl,schemeGnBu as tp,interpolateOrRd as Il,schemeOrRd as ep,interpolatePuBu as Bl,schemePuBu as np,interpolatePuBuGn as Wl,schemePuBuGn as rp,interpolatePuRd as jl,schemePuRd as op,interpolateRdPu as Fl,schemeRdPu as ip,interpolateYlGn as Dl,schemeYlGn as ap,interpolateYlGnBu as ql,schemeYlGnBu as lp,interpolateYlOrBr as Yl,schemeYlOrBr as sp,interpolateYlOrRd as Pl,schemeYlOrRd as cp,interpolateRainbow as Xl,interpolateSinebow as _l,scaleLinear as Gl,scalePow as up,scaleLog as fp,scaleSymlog as hp,scaleQuantile as dp,extent as yt,ticks as Oo,interpolateNumber as En,reverse as pr,scaleThreshold as pp,scaleIdentity as mp,piecewise as Co,interpolateRgb as No,interpolateRound as yp,interpolateHsl as gp,interpolateHcl as $p,interpolateLab as vp,scaleDiverging as xp,scaleDivergingPow as wp,scaleDivergingLog as bp,scaleDivergingSymlog as kp,scaleTime as Mp,scaleUtc as Ap,scaleImplicit as Lp,scaleOrdinal as zp,scalePoint as Sp,scaleBand as Vl,symbolsStroke as Ep,symbolsFill as Op,cross as Cp,InternMap as Ro,geoTransform as mr,geoPath as Kt,geoClipRectangle as Np,geoStream as Rp,geoTransverseMercator as Tp,geoStereographic as Ip,geoOrthographic as Bp,geoMercator as Wp,geoGnomonic as jp,geoEquirectangular as Fp,geoEqualEarth as Dp,geoAzimuthalEquidistant as qp,geoAzimuthalEqualArea as Yp,geoAlbersUsa as Pp,geoConicEquidistant as Xp,geoConicEqualArea as _p,geoConicConformal as Gp,geoAlbers as Vp,select as de,creator as Hl,namespaces as Ne,pointer as Hp,format as To,axisBottom as Up,pathRound as Qt,rgb as On,cumsum as Zp,groupSort as Io,greatest as Bo,curveLinear as Wo,curveBasis as Kp,curveBasisClosed as Qp,curveBasisOpen as Jp,curveBundle as tm,curveBumpX as em,curveBumpY as nm,curveCardinal as rm,curveCardinalClosed as om,curveCardinalOpen as im,curveCatmullRom as am,curveCatmullRomClosed as lm,curveCatmullRomOpen as sm,curveLinearClosed as cm,curveMonotoneX as um,curveMonotoneY as fm,curveNatural as hm,curveStep as dm,curveStepAfter as pm,curveStepBefore as mm,thresholdSturges as Ul,thresholdScott as Zl,thresholdFreedmanDiaconis as ym,utcTickInterval as gm,tickIncrement as $m,bisect as vm,area as jo,line as xm,rank as Kl,count as wm,blurImage as bm,Delaunay as Ge,blur2 as km,contours as Mm,nice as Am,contourDensity as Lm,geoCentroid as zm,geoGraticule10 as Sm,stratify as Ql,tree as yr,cluster as Jl,least as Em}from"../../d3@7.9.0/index.e21134d2.js";import{parse as ts,format as Om}from"../../isoformat@0.2.1/index.0882e9d9.js";import Cm from"../../interval-tree-1d@1.0.4/index.f507a53c.js";function vt(t){return t!=null&&!Number.isNaN(t)}function Rt(t,e){return+vt(e)-+vt(t)||cr(t,e)}function gr(t,e){return+vt(e)-+vt(t)||_e(t,e)}function Fo(t){return t!=null&&`${t}`!=""}function $r(t){return isFinite(t)?t:NaN}function Jt(t){return t>0&&isFinite(t)?t:NaN}function vr(t){return t<0&&isFinite(t)?t:NaN}function Ve(t){if(t==null)return;const e=t[0],n=t[t.length-1];return _e(e,n)}const He=1e3,pe=He*60,me=pe*60,Yt=me*24,Pt=Yt*7,Re=Yt*30,ye=Yt*365,Do=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",He],["5 seconds",5*He],["15 seconds",15*He],["30 seconds",30*He],["minute",pe],["5 minutes",5*pe],["15 minutes",15*pe],["30 minutes",30*pe],["hour",me],["3 hours",3*me],["6 hours",6*me],["12 hours",12*me],["day",Yt],["2 days",2*Yt],["week",Pt],["2 weeks",2*Pt],["month",Re],["3 months",3*Re],["6 months",6*Re],["year",ye],["2 years",2*ye],["5 years",5*ye],["10 years",10*ye],["20 years",20*ye],["50 years",50*ye],["100 years",100*ye]],qo=new Map([["second",He],["minute",pe],["hour",me],["day",Yt],["monday",Pt],["tuesday",Pt],["wednesday",Pt],["thursday",Pt],["friday",Pt],["saturday",Pt],["sunday",Pt],["week",Pt],["month",Re],["year",ye]]),es=new Map([["second",Va],["minute",Ha],["hour",Ua],["day",Za],["monday",Hh],["tuesday",Uh],["wednesday",Zh],["thursday",Kh],["friday",Qh],["saturday",Jh],["sunday",td],["week",ed],["month",Ka],["year",Qa]]),Yo=new Map([["second",Ja],["minute",tl],["hour",el],["day",nl],["monday",nd],["tuesday",rd],["wednesday",od],["thursday",id],["friday",ad],["saturday",ld],["sunday",sd],["week",cd],["month",rl],["year",ol]]),Cn=Symbol("intervalDuration"),xr=Symbol("intervalType");for(const[t,e]of es)e[Cn]=qo.get(t),e[xr]="time";for(const[t,e]of Yo)e[Cn]=qo.get(t),e[xr]="utc";const Nn=[["year",ol,"utc"],["month",rl,"utc"],["day",nl,"utc",6*Re],["hour",el,"utc",3*Yt],["minute",tl,"utc",6*me],["second",Ja,"utc",30*pe]],wr=[["year",Qa,"time"],["month",Ka,"time"],["day",Za,"time",6*Re],["hour",Ua,"time",3*Yt],["minute",Ha,"time",6*me],["second",Va,"time",30*pe]],Nm=[Nn[0],wr[0],Nn[1],wr[1],Nn[2],wr[2],...Nn.slice(3)];function Po(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(e);switch(r&&(e=e.slice(r[0].length),n=+r[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6;break}let o=Yo.get(e);if(!o)throw new Error(`unknown interval: ${t}`);if(n>1&&!o.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function Xo(t){return ns(Po(t),"time")}function br(t){return ns(Po(t),"utc")}function ns([t,e],n){let r=(n==="time"?es:Yo).get(t);return e>1&&(r=r.every(e),r[Cn]=qo.get(t)*e,r[xr]=n),r}function rs(t,e){if(!(e>1))return;const n=t[Cn];if(!Do.some(([,o])=>o===n)||n%Yt===0&&Yt<n&&n<Re)return;const[r]=Do[ud(([,o])=>Math.log(o)).center(Do,Math.log(n*e))];return(t[xr]==="time"?Xo:br)(r)}function os(t,e,n){const r=e==="time"?hd:zo;if(n==null)return r(t==="year"?"%Y":t==="month"?"%Y-%m":t==="day"?"%Y-%m-%d":t==="hour"||t==="minute"?"%Y-%m-%dT%H:%M":t==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const o=Rm(n);switch(t){case"millisecond":return Ue(r(".%L"),r(":%M:%S"),o);case"second":return Ue(r(":%S"),r("%-I:%M"),o);case"minute":return Ue(r("%-I:%M"),r("%p"),o);case"hour":return Ue(r("%-I %p"),r("%b %-d"),o);case"day":return Ue(r("%-d"),r("%b"),o);case"month":return Ue(r("%b"),r("%Y"),o);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function Rm(t){return t==="left"||t==="right"?(e,n)=>`
${e}
${n}`:t==="top"?(e,n)=>`${n}
${e}`:(e,n)=>`${e}
${n}`}function Tm(t){return t==="time"?wr:t==="utc"?Nn:Nm}function Im(t,e,n){const r=zt(fd(e,(o,i)=>Math.abs(i-o)));if(r<1e3)return os("millisecond","utc",n);for(const[o,i,a,l]of Tm(t)){if(r>l||o==="hour"&&!r)break;if(e.every(s=>i.floor(s)>=s))return os(o,a,n)}}function Ue(t,e,n){return(r,o,i)=>{const a=t(r,o),l=e(r,o),s=o-Ve(i);return o!==s&&i[s]!==void 0&&l===e(i[s],s)?a:n(a,l)}}const kr=Object.getPrototypeOf(Uint8Array),Bm=Object.prototype.toString;function te(t){return t instanceof Array||t instanceof kr}function is(t){return t instanceof kr&&!Wm(t)}function as(t){return t?.prototype instanceof kr&&!jm(t)}function Wm(t){return t instanceof BigInt64Array||t instanceof BigUint64Array}function jm(t){return t===BigInt64Array||t===BigUint64Array}const ls=Symbol("reindex");function V(t,e,n){const r=typeof e;return r==="string"?ws(t)?Go(t.getChild(e),n):ss(t,cs(e),n):r==="function"?ss(t,e,n):r==="number"||e instanceof Date||r==="boolean"?J(t,xt(e),n):typeof e?.transform=="function"?_o(e.transform(t),n):Fm(_o(e,n),t?.[ls])}function Fm(t,e){return t!=null&&e?Ar(t,e):t}function ss(t,e,n){return J(t,as(n)?(r,o)=>Uo(e(r,o)):e,n)}function _o(t,e){return e===void 0?ee(t):bs(t)?Go(t,e):t instanceof e?t:e.from(t,as(e)&&!is(t)?Uo:void 0)}function Go(t,e){return t==null?t:(e===void 0||e===Array)&&Jm(t.type)?us(t.toArray()):_o(t.toArray(),e)}const Rn=[null],cs=t=>e=>{const n=e[t];return n===void 0&&e.type==="Feature"?e.properties?.[t]:n},gt={transform:ne},D={transform:t=>t},Vo=()=>1,Dm=()=>!0,kt=t=>t==null?t:`${t}`,rt=t=>t==null?t:+t,Mr=t=>t?t[0]:void 0,Tn=t=>t?t[1]:void 0,qm=t=>t?t[2]:void 0,xt=t=>()=>t;function Ho(t){const e=+`${t}`.slice(1)/100;return(n,r)=>An(n,e,r)}function St(t){return is(t)?t:J(t,Uo,Float64Array)}function Uo(t){return t==null?NaN:Number(t)}function us(t){return J(t,fs)}function fs(t){return t instanceof Date&&!isNaN(t)?t:typeof t=="string"?ts(t):t==null||isNaN(t=Number(t))?void 0:new Date(t)}function Mt(t,e){return t===void 0&&(t=e),t===null?[void 0,"none"]:Wn(t)?[void 0,t]:[t,void 0]}function ht(t,e){return t===void 0&&(t=e),t===null||typeof t=="number"?[void 0,t]:[t,void 0]}function hs(t,e,n){if(t!=null)return Ot(t,e,n)}function Ot(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function Ze(t){return ws(t)?t:ee(t)}function ee(t){if(t==null||te(t))return t;if(bs(t))return Go(t);switch(t.type){case"FeatureCollection":return t.features;case"GeometryCollection":return t.geometries;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return[t]}return Array.from(t)}function J(t,e,n=Array){return t==null?t:t instanceof n?t.map(e):n.from(t,e)}function In(t,e=Array){return t instanceof e?t.slice():e.from(t)}function ds({x:t,x1:e,x2:n}){return t!==void 0||e!==void 0||n!==void 0}function ps({y:t,y1:e,y2:n}){return t!==void 0||e!==void 0||n!==void 0}function Ke(t){return ds(t)||ps(t)||t.interval!==void 0}function Tt(t){return t?.toString===Bm}function Te(t){return Tt(t)&&(t.type!==void 0||t.domain!==void 0)}function Xt(t){return Tt(t)&&typeof t.transform!="function"}function ge(t){return Xt(t)&&t.value===void 0&&t.channel===void 0}function ms(t,e,n,r=D){return e===void 0&&n===void 0?(e=0,n=t===void 0?r:t):e===void 0?e=t===void 0?0:t:n===void 0&&(n=t===void 0?0:t),[e,n]}function Wt(t,e){return t===void 0&&e===void 0?[Mr,Tn]:[t,e]}function $e({z:t,fill:e,stroke:n}={}){return t===void 0&&([t]=Mt(e)),t===void 0&&([t]=Mt(n)),t}function Bn(t){return te(t)?t.length:t?.numRows}function ne(t){const e=Bn(t),n=new Uint32Array(e);for(let r=0;r<e;++r)n[r]=r;return n}function Ar(t,e){return te(t)?J(e,n=>t[n],t.constructor):J(e,n=>t.at(n))}function Zo(t){return t.length===1?(e,n)=>t(Ar(n,e)):t}function Ie(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function re(t){return t!==null&&typeof t=="object"?t.valueOf():t}function ys(t,e){if(e[t]!==void 0)return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y";break}return e[t]}function Ct(t){let e;return[{transform:()=>e,label:_t(t)},n=>e=n]}function Et(t){return t==null?[t]:Ct(t)}function _t(t,e){return typeof t=="string"?t:t&&t.label!==void 0?t.label:e}function Lr(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return At(r)||At(o)?J(r,(i,a)=>new Date((+r[a]+ +o[a])/2)):J(r,(i,a)=>(+r[a]+ +o[a])/2,Float64Array)},label:t.label}}function zr(t,e){const n=gs(e?.interval,e?.type);return n?J(t,n):t}function gs(t,e){const n=Sr(t,e);return n&&(r=>vt(r)?n.floor(r):r)}function Sr(t,e){if(t!=null){if(typeof t=="number")return $s(t);if(typeof t=="string")return(e==="time"?Xo:br)(t);if(typeof t.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof t.offset!="function")throw new Error("invalid interval; missing offset method");return t}}function $s(t){t=+t,0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const e=Math.abs(t);return t<0?{floor:n=>Math.floor(n*e)/e,offset:(n,r=1)=>(n*e+Math.floor(r))/e,range:(n,r)=>Mn(Math.ceil(n*e),r*e).map(o=>o/e)}:{floor:n=>Math.floor(n/e)*e,offset:(n,r=1)=>n+e*Math.floor(r),range:(n,r)=>Mn(Math.ceil(n/e),r/e).map(o=>o*e)}}function Qe(t,e){if(t=Sr(t,e),t&&typeof t.range!="function")throw new Error("invalid interval: missing range method");return t}function Ym(t,e){if(t=Qe(t,e),t&&typeof t.ceil!="function")throw new Error("invalid interval: missing ceil method");return t}function Pm(t){return Je(t)&&typeof t?.floor=="function"&&t.floor()instanceof Date}function Je(t){return typeof t?.range=="function"}function tn(t){return t===void 0||Xt(t)?t:{value:t}}function Xm(t){return t==null?null:{transform:e=>V(e,t,Float64Array),label:_t(t)}}function _m(t){if(!oe(t))return!1;for(const e of t)if(e!=null)return typeof e=="object"&&"0"in e&&"1"in e}function oe(t){return t&&typeof t[Symbol.iterator]=="function"}function vs(t){for(const e of t)if(e!=null)return typeof e!="object"||e instanceof Date}function ct(t){for(const e of t){if(e==null)continue;const n=typeof e;return n==="string"||n==="boolean"}}function At(t){for(const e of t)if(e!=null)return e instanceof Date}function Gm(t){for(const e of t)if(e!=null)return typeof e=="string"&&isNaN(e)&&ts(e)}function Vm(t){for(const e of t)if(e!=null){if(typeof e!="string")return!1;if(e.trim())return!isNaN(e)}}function en(t){for(const e of t)if(e!=null)return typeof e=="number"}function Ko(t,e){let n;for(const r of t)if(r!=null){if(!e(r))return!1;n=!0}return n}const Hm=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Wn(t){return typeof t!="string"?!1:(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||Hm.has(t))}function Um(t){return typeof t=="number"&&(0<=t&&t<=1||isNaN(t))}function lt(t){return t==null||nn(t)}function nn(t){return/^\s*none\s*$/i.test(t)}function Zm(t){return/^\s*round\s*$/i.test(t)}function Qo(t,e){return hs(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function jn(t="middle"){return Qo(t,"frameAnchor")}function Km(t={},...e){let n=t;for(const r of e)for(const o in r)if(n[o]===void 0){const i=r[o];n===t?n={...n,[o]:i}:n[o]=i}return n}function Qm(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const o=`${r}`;if(o==="__proto__")throw new Error(`illegal name: ${o}`);if(e.has(o))throw new Error(`duplicate name: ${o}`);return e.add(o),[r,n]}))}function Jo(t){return oe(t)?Qm(t):t}function xs(t){return t===!0?t="frame":t===!1?t=null:t!=null&&(t=Ot(t,"clip",["frame","sphere"])),t}function ws(t){return t&&typeof t.getChild=="function"&&typeof t.toArray=="function"&&t.schema&&Array.isArray(t.schema.fields)}function bs(t){return t&&typeof t.toArray=="function"&&t.type}function Jm(t){return t&&(t.typeId===8||t.typeId===10)&&t.unit===1}const Gt=Symbol("position"),ie=Symbol("color"),Fn=Symbol("radius"),Dn=Symbol("length"),qn=Symbol("opacity"),Er=Symbol("symbol"),ks=Symbol("projection"),st=new Map([["x",Gt],["y",Gt],["fx",Gt],["fy",Gt],["r",Fn],["color",ie],["opacity",qn],["symbol",Er],["length",Dn],["projection",ks]]);function ty(t){return t===Gt||t===ks}function ey(t){return t===Gt||t===Fn||t===Dn||t===qn}const Ms=Math.sqrt(3),As=2/Ms,ny={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*As,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},ti=new Map([["asterisk",dd],["circle",So],["cross",pd],["diamond",md],["diamond2",yd],["hexagon",ny],["plus",gd],["square",$d],["square2",vd],["star",xd],["times",wd],["triangle",bd],["triangle2",kd],["wye",Md]]);function ei(t){return t&&typeof t.draw=="function"}function ry(t){return ei(t)?!0:typeof t!="string"?!1:ti.has(t.toLowerCase())}function ni(t){if(t==null||ei(t))return t;const e=ti.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function oy(t){if(t==null||ei(t))return[void 0,t];if(typeof t=="string"){const e=ti.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}function jt({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(r===void 0&&(t!=null&&(r=ii(t)),e!=null&&!ge(e)&&(r=ri(r,li(e))),n&&(r=ri(r,ai))),a!=null&&o!=null)throw new Error("transforms cannot be applied after initializers");return{...i,...(e===null||ge(e))&&{sort:e},transform:ri(r,a)}}function Lt({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return r===void 0&&(t!=null&&(r=ii(t)),e!=null&&!ge(e)&&(r=oi(r,li(e))),n&&(r=oi(r,ai))),{...o,...(e===null||ge(e))&&{sort:e},initializer:oi(r,i)}}function ri(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,o){return{data:n,facets:r}=t.call(this,n,r,o),e.call(this,Ze(n),r,o)}}function oi(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return{data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i),{data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i),{data:u,facets:f,channels:{...a,...c}}}}function Or(t,e){return(t.initializer!=null?Lt:jt)(t,e)}function iy(t,e){return Or(e,ii(t))}function ii(t){return(e,n)=>{const r=V(e,t);return{data:e,facets:n.map(o=>o.filter(i=>r[i]))}}}function ay({sort:t,...e}={}){return{...Or(e,ai),sort:ge(t)?t:null}}function ai(t,e){return{data:t,facets:e.map(n=>n.slice().reverse())}}function ly({seed:t,sort:e,...n}={}){return{...Or(n,zs(t==null?Math.random:Eo(t))),sort:ge(e)?e:null}}function Ls(t,{sort:e,...n}={}){return{...(Xt(t)&&t.channel!==void 0?Lt:Or)(n,li(t)),sort:ge(e)?e:null}}function li(t){return(typeof t=="function"&&t.length!==1?sy:zs)(t)}function sy(t){return(e,n)=>{const r=te(e)?(o,i)=>t(e[o],e[i]):(o,i)=>t(e.get(o),e.get(i));return{data:e,facets:n.map(o=>o.slice().sort(r))}}}function zs(t){let e,n;({channel:e,value:t,order:n}={...tn(t)});const r=e?.startsWith("-");if(r&&(e=e.slice(1)),n===void 0&&(n=r?gr:Rt),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=Rt;break;case"descending":n=gr;break;default:throw new Error(`invalid order: ${n}`)}return(o,i,a)=>{let l;if(e===void 0)l=V(o,t);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(l=a[e],!l)return{};l=l.value}const s=(c,u)=>n(l[c],l[u]);return{data:o,facets:i.map(c=>c.slice().sort(s))}}}function si(t,e){return Cr(null,null,t,e)}function Yn(t={y:"count"},e={}){const{x:n=D}=e;if(n==null)throw new Error("missing channel: x");return Cr(n,null,t,e)}function Pn(t={x:"count"},e={}){const{y:n=D}=e;if(n==null)throw new Error("missing channel: y");return Cr(null,n,t,e)}function ci(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=Wt(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return Cr(n,r,t,e)}function Cr(t,e,{data:n=di,filter:r,sort:o,reverse:i,...a}={},l={}){a=Es(a,l),n=Ns(n,D),o=o==null?void 0:Os("sort",o,l),r=r==null?void 0:Cs("filter",r,l);const[s,c]=Et(t),[u,f]=Et(e),{z:h,fill:d,stroke:p,x1:m,x2:$,y1:y,y2:g,...x}=l,[v,b]=Et(h),[w]=Mt(d),[k]=Mt(p),[M,A]=Et(w),[z,S]=Et(k);return{..."z"in l&&{z:v||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:z||p},...jt(x,(L,C,E)=>{const O=zr(V(L,t),E?.x),R=zr(V(L,e),E?.y),N=V(L,h),F=V(L,w),T=V(L,k),B=hi(a,{z:N,fill:F,stroke:T}),j=[],I=[],Y=O&&c([]),H=R&&f([]),G=N&&b([]),X=F&&A([]),W=T&&S([]);let P=0;for(const _ of a)_.initialize(L);o&&o.initialize(L),r&&r.initialize(L);for(const _ of C){const Z=[];for(const K of a)K.scope("facet",_);o&&o.scope("facet",_),r&&r.scope("facet",_);for(const[K,nt]of Be(_,B))for(const[ft,at]of Be(nt,R))for(const[dt,mt]of Be(at,O)){const bt={data:L};if(O&&(bt.x=dt),R&&(bt.y=ft),B&&(bt.z=K),!(r&&!r.reduce(mt,bt))){Z.push(P++),I.push(n.reduceIndex(mt,L,bt)),O&&Y.push(dt),R&&H.push(ft),N&&G.push(B===N?K:N[mt[0]]),F&&X.push(B===F?K:F[mt[0]]),T&&W.push(B===T?K:T[mt[0]]);for(const Ee of a)Ee.reduce(mt,bt);o&&o.reduce(mt,bt)}}j.push(Z)}return Rs(j,o,i),{data:I,facets:j}}),...!ve(a,"x")&&(s?{x:s}:{x1:m,x2:$}),...!ve(a,"y")&&(u?{y:u}:{y1:y,y2:g}),...Object.fromEntries(a.map(({name:L,output:C})=>[L,C]))}}function ve(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function Ss(t,e,n=ui){const r=Object.entries(t);return e.title!=null&&t.title===void 0&&r.push(["title",py]),e.href!=null&&t.href===void 0&&r.push(["href",pi]),r.filter(([,o])=>o!==void 0).map(([o,i])=>i===null?cy(o):n(o,i,e))}function ui(t,e,n,r=fi){let o;Tt(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=Ct(i.label);let s;return{name:t,output:o===void 0?a:{value:a,scale:o},initialize(c){i.initialize(c),s=l([])},scope(c,u){i.scope(c,u)},reduce(c,u){s.push(i.reduce(c,u))}}}function cy(t){return{name:t,initialize(){},scope(){},reduce(){}}}function fi(t,e,n,r=Nr){const o=ys(t,n),i=r(e,o);let a,l;return{label:_t(i===Rr?null:o,i.label),initialize(s){a=o===void 0?s:V(s,o),i.scope==="data"&&(l=i.reduceIndex(ne(s),a))},scope(s,c){i.scope===s&&(l=i.reduceIndex(c,a))},reduce(s,c){return i.scope==null?i.reduceIndex(s,a,c):i.reduceIndex(s,a,l,c)}}}function Be(t,e){return e?Ce(t,n=>e[n]):[[,t]]}function Nr(t,e,n=uy){if(t==null)return n(t);if(typeof t.reduceIndex=="function")return t;if(typeof t.reduce=="function"&&Tt(t))return hy(t);if(typeof t=="function")return dy(t);if(/^p\d{2}$/i.test(t))return ae(Ho(t));switch(`${t}`.toLowerCase()){case"first":return pi;case"last":return my;case"identity":return di;case"count":return Rr;case"distinct":return yy;case"sum":return e==null?Rr:gy;case"proportion":return Is(e,"data");case"proportion-facet":return Is(e,"facet");case"deviation":return ae(fr);case"min":return ae(Nt);case"min-index":return ae(Ld);case"max":return ae(zt);case"max-index":return ae(Ad);case"mean":return Ts(ur);case"median":return Ts(Sn);case"variance":return ae(ll);case"mode":return ae(al)}return n(t)}function uy(t){throw new Error(`invalid reduce: ${t}`)}function Es(t,e){return Ss(t,e,Os)}function Os(t,e,n){return ui(t,e,n,Cs)}function Cs(t,e,n){return fi(t,e,n,Ns)}function Ns(t,e){return Nr(t,e,fy)}function fy(t){switch(`${t}`.toLowerCase()){case"x":return $y;case"y":return vy;case"z":return Bs}throw new Error(`invalid group reduce: ${t}`)}function hi(t,e){for(const n in e){const r=e[n];if(r!==void 0&&!t.some(o=>o.name===n))return r}}function Rs(t,e,n){if(e){const r=e.output.transform(),o=(i,a)=>Rt(r[i],r[a]);t.forEach(i=>i.sort(o))}n&&t.forEach(r=>r.reverse())}function hy(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}function dy(t){return{reduceIndex(e,n,r){return t(Ar(n,e),r)}}}function ae(t){return{reduceIndex(e,n){return t(e,r=>n[r])}}}function Ts(t){return{reduceIndex(e,n){const r=t(e,o=>n[o]);return At(n)?new Date(r):r}}}const di={reduceIndex(t,e){return Ar(e,t)}},pi={reduceIndex(t,e){return e[t[0]]}},py={reduceIndex(t,e){const n=il(Ln(t,o=>o.length,o=>e[o]),Tn),r=n.slice(-5).reverse();if(r.length<n.length){const o=n.slice(0,-4);r[4]=[`\u2026 ${o.length.toLocaleString("en-US")} more`,qt(o,Tn)]}return r.map(([o,i])=>`${o} (${i.toLocaleString("en-US")})`).join(`
`)}},my={reduceIndex(t,e){return e[t[t.length-1]]}},Rr={label:"Frequency",reduceIndex(t){return t.length}},yy={label:"Distinct",reduceIndex(t,e){const n=new zn;for(const r of t)n.add(e[r]);return n.size}},gy=ae(qt);function Is(t,e){return t==null?{scope:e,label:"Frequency",reduceIndex:(n,r,o=1)=>n.length/o}:{scope:e,reduceIndex:(n,r,o=1)=>qt(n,i=>r[i])/o}}const $y={reduceIndex(t,e,{x:n}){return n}},vy={reduceIndex(t,e,{y:n}){return n}},Bs={reduceIndex(t,e,{z:n}){return n}};function xy(t){if(typeof t!="function")throw new Error(`invalid test function: ${t}`);return{reduceIndex(e,n,{data:r}){return n[e.find(te(r)?o=>t(r[o],o,r):o=>t(r.get(o),o,r))]}}}function Xn(t,{scale:e,type:n,value:r,filter:o,hint:i,label:a=_t(r)},l){return i===void 0&&typeof r?.transform=="function"&&(i=r.hint),js(l,{scale:e,type:n,value:V(t,r),label:a,filter:o,hint:i})}function Ws(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,Xn(e,r,n)]))}function mi(t,e){const n=Object.fromEntries(Object.entries(t).map(([r,{scale:o,value:i}])=>{const a=o==null?null:e[o];return[r,a==null?i:J(i,a)]}));return n.channels=t,n}function js(t,e){const{scale:n,value:r}=e;if(n===!0||n==="auto")switch(t){case"fill":case"stroke":case"color":e.scale=n!==!0&&Ko(r,Wn)?null:"color",e.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=n!==!0&&Ko(r,Um)?null:"opacity",e.defaultScale="opacity";break;case"symbol":n!==!0&&Ko(r,ry)?(e.scale=null,e.value=J(r,ni)):e.scale="symbol",e.defaultScale="symbol";break;default:e.scale=st.has(t)?t:null;break}else if(n===!1)e.scale=null;else if(n!=null&&!st.has(n))throw new Error(`unknown scale: ${n}`);return e}function wy(t,e,n,r,o){const{order:i,reverse:a,reduce:l=!0,limit:s}=o;for(const c in o){if(!st.has(c))continue;let{value:u,order:f=i,reverse:h=a,reduce:d=l,limit:p=s}=tn(o[c]);const m=u?.startsWith("-");if(m&&(u=u.slice(1)),f=f===void 0?m!==(u==="width"||u==="height")?qs:Ds:My(f),d==null||d===!1)continue;const $=c==="fx"||c==="fy"?ky(e,r[c]):by(n,c);if(!$)throw new Error(`missing channel for scale: ${c}`);const y=$.value,[g=0,x=1/0]=oe(p)?p:p<0?[p]:[0,p];if(u==null)$.domain=()=>{let v=Array.from(new zn(y));return h&&(v=v.reverse()),(g!==0||x!==1/0)&&(v=v.slice(g,x)),v};else{const v=u==="data"?t:u==="height"?Fs(n,"y1","y2"):u==="width"?Fs(n,"x1","x2"):yi(n,u,u==="y"?"y2":u==="x"?"x2":void 0),b=Nr(d===!0?"max":d,v);$.domain=()=>{let w=zd(ne(y),k=>b.reduceIndex(k,v),k=>y[k]);return f&&w.sort(f),h&&w.reverse(),(g!==0||x!==1/0)&&(w=w.slice(g,x)),w.map(Mr)}}}}function by(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function ky(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let i=0;i<n.length;++i){const a=r[n[i][0]];for(const l of t[i])o[l]=a}return e}function Fs(t,e,n){const r=yi(t,e),o=yi(t,n);return J(o,(i,a)=>Math.abs(i-r[a]),Float64Array)}function yi(t,e,n){let r=t[e];if(!r&&n!==void 0&&(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function My(t){if(t==null||typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"ascending":return Ds;case"descending":return qs}throw new Error(`invalid order: ${t}`)}function Ds([t,e],[n,r]){return Rt(e,r)||Rt(t,n)}function qs([t,e],[n,r]){return gr(e,r)||Rt(t,n)}function gi(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}const Ys=new Map([["accent",Sd],["category10",Ed],["dark2",Od],["observable10",Cd],["paired",Nd],["pastel1",Rd],["pastel2",Td],["set1",Id],["set2",Bd],["set3",Wd],["tableau10",jd]]);function Ay(t){return t!=null&&Ys.has(`${t}`.toLowerCase())}const Ps=new Map([...Ys,["brbg",le(Fd,sl)],["prgn",le(Dd,cl)],["piyg",le(qd,ul)],["puor",le(Yd,fl)],["rdbu",le(hl,hr)],["rdgy",le(Pd,dl)],["rdylbu",le(pl,dr)],["rdylgn",le(Xd,ml)],["spectral",le(_d,yl)],["burd",Xs(hl,hr)],["buylrd",Xs(pl,dr)],["blues",$t(Gd,gl)],["greens",$t(Vd,$l)],["greys",$t(Hd,vl)],["oranges",$t(Ud,xl)],["purples",$t(Zd,wl)],["reds",$t(Kd,bl)],["turbo",se(kl)],["viridis",se(Ml)],["magma",se(Al)],["inferno",se(Ll)],["plasma",se(zl)],["cividis",se(Sl)],["cubehelix",se(El)],["warm",se(Ol)],["cool",se(Cl)],["bugn",$t(Qd,Nl)],["bupu",$t(Jd,Rl)],["gnbu",$t(tp,Tl)],["orrd",$t(ep,Il)],["pubu",$t(np,Bl)],["pubugn",$t(rp,Wl)],["purd",$t(op,jl)],["rdpu",$t(ip,Fl)],["ylgn",$t(ap,Dl)],["ylgnbu",$t(lp,ql)],["ylorbr",$t(sp,Yl)],["ylorrd",$t(cp,Pl)],["rainbow",_s(Xl)],["sinebow",_s(_l)]]);function $t(t,e){return({length:n})=>n===1?[t[3][1]]:n===2?[t[3][1],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?Bt(e,n):t[n])}function le(t,e){return({length:n})=>n===2?[t[3][0],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?Bt(e,n):t[n])}function Xs(t,e){return({length:n})=>n===2?[t[3][2],t[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?Bt(r=>e(1-r),n):t[n].slice().reverse())}function se(t){return({length:e})=>Bt(t,Math.max(2,Math.floor(e)))}function _s(t){return({length:e})=>Bt(t,Math.floor(e)+1).slice(0,-1)}function Gs(t){const e=`${t}`.toLowerCase();if(!Ps.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return Ps.get(e)}function Tr(t,e){const n=Gs(t),r=typeof n=="function"?n({length:e}):n;return r.length!==e?r.slice(0,e):r}function Ly(t,e="greys"){const n=new Set,[r,o]=Tr(e,2);for(const i of t)if(i!=null)if(i===!0)n.add(o);else if(i===!1)n.add(r);else return;return[...n]}const Vs=new Map([["brbg",sl],["prgn",cl],["piyg",ul],["puor",fl],["rdbu",hr],["rdgy",dl],["rdylbu",dr],["rdylgn",ml],["spectral",yl],["burd",t=>hr(1-t)],["buylrd",t=>dr(1-t)],["blues",gl],["greens",$l],["greys",vl],["purples",wl],["reds",bl],["oranges",xl],["turbo",kl],["viridis",Ml],["magma",Al],["inferno",Ll],["plasma",zl],["cividis",Sl],["cubehelix",El],["warm",Ol],["cool",Cl],["bugn",Nl],["bupu",Rl],["gnbu",Tl],["orrd",Il],["pubugn",Wl],["pubu",Bl],["purd",jl],["rdpu",Fl],["ylgnbu",ql],["ylgn",Dl],["ylorbr",Yl],["ylorrd",Pl],["rainbow",Xl],["sinebow",_l]]);function $i(t){const e=`${t}`.toLowerCase();if(!Vs.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Vs.get(e)}const zy=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Sy(t){return t!=null&&zy.has(`${t}`.toLowerCase())}const Hs=t=>e=>t(1-e),vi=[0,1],Us=new Map([["number",En],["rgb",No],["hsl",gp],["hcl",$p],["lab",vp]]);function Zs(t){const e=`${t}`.toLowerCase();if(!Us.has(e))throw new Error(`unknown interpolator: ${e}`);return Us.get(e)}function _n(t,e,n,{type:r,nice:o,clamp:i,zero:a,domain:l=Qs(t,n),unknown:s,round:c,scheme:u,interval:f,range:h=st.get(t)===Fn?Fy(n,l):st.get(t)===Dn?Dy(n,l):st.get(t)===qn?vi:void 0,interpolate:d=st.get(t)===ie?u==null&&h!==void 0?No:$i(u!==void 0?u:r==="cyclical"?"rainbow":"turbo"):c?yp:En,reverse:p}){if(f=Qe(f,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof d!="function"&&(d=Zs(d)),p=!!p,h!==void 0){const m=(l=ee(l)).length,$=(h=ee(h)).length;if(m!==$){if(d.length===1)throw new Error("invalid piecewise interpolator");d=Co(d,h),h=void 0}}if(d.length===1?(p&&(d=Hs(d),p=!1),h===void 0&&(h=Float64Array.from(l,(m,$)=>$/(l.length-1)),h.length===2&&(h=vi)),e.interpolate((h===vi?xt:wi)(d))):e.interpolate(d),a){const[m,$]=yt(l);(m>0||$<0)&&(l=In(l),(Ve(l)||1)===Math.sign(m)?l[0]=0:l[l.length-1]=0)}return p&&(l=pr(l)),e.domain(l).unknown(s),o&&(e.nice(Ey(o,r)),l=e.domain()),h!==void 0&&e.range(h),i&&e.clamp(i),{type:r,domain:l,range:h,scale:e,interpolate:d,interval:f}}function Ey(t,e){return t===!0?void 0:typeof t=="number"?t:Ym(t,e)}function Oy(t,e,n){return _n(t,Gl(),e,n)}function Cy(t,e,n){return Ks(t,e,{...n,exponent:.5})}function Ks(t,e,{exponent:n=1,...r}){return _n(t,up().exponent(n),e,{...r,type:"pow"})}function Ny(t,e,{base:n=10,domain:r=qy(e),...o}){return _n(t,fp().base(n),e,{...o,domain:r})}function Ry(t,e,{constant:n=1,...r}){return _n(t,hp().constant(n),e,r)}function Ty(t,e,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:o=r,scheme:i="rdylbu",domain:a=Yy(e),unknown:l,interpolate:s,reverse:c}){return n===void 0&&(n=s!==void 0?Bt(s,o):st.get(t)===ie?Tr(i,o):void 0),a.length>0&&(a=dp(a,n===void 0?{length:o}:n).quantiles()),xi(t,e,{domain:a,range:n,reverse:c,unknown:l})}function Iy(t,e,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:o="rdylbu",domain:i=Qs(t,e),unknown:a,interpolate:l,reverse:s}){const[c,u]=yt(i);let f;return n===void 0?(f=Oo(c,u,r),f[0]<=c&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),r=f.length+1,n=l!==void 0?Bt(l,r):st.get(t)===ie?Tr(o,r):void 0):(f=Bt(En(c,u),r+1).slice(1,-1),c instanceof Date&&(f=f.map(h=>new Date(h)))),Ve(ee(i))<0&&f.reverse(),xi(t,e,{domain:f,range:n,reverse:s,unknown:a})}function xi(t,e,{domain:n=[0],unknown:r,scheme:o="rdylbu",interpolate:i,range:a=i!==void 0?Bt(i,n.length+1):st.get(t)===ie?Tr(o,n.length+1):void 0,reverse:l}){n=ee(n);const s=Ve(n);if(!isNaN(s)&&!By(n,s))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(a=pr(a)),{type:"threshold",scale:pp(s<0?pr(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function By(t,e){for(let n=1,r=t.length,o=t[0];n<r;++n){const i=_e(o,o=t[n]);if(i!==0&&i!==e)return!1}return!0}function Wy(t){return{type:"identity",scale:ey(st.get(t))?mp():e=>e}}function Gn(t,e=$r){return t.length?[Nt(t,({value:n})=>n===void 0?n:Nt(n,e)),zt(t,({value:n})=>n===void 0?n:zt(n,e))]:[0,1]}function Qs(t,e){const n=st.get(t);return(n===Fn||n===qn||n===Dn?jy:Gn)(e)}function jy(t){return[0,t.length?zt(t,({value:e})=>e===void 0?e:zt(e,$r)):1]}function Fy(t,e){const n=t.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=An(t,.5,({value:a})=>a===void 0?NaN:An(a,.25,Jt)),o=e.map(a=>3*Math.sqrt(a/r)),i=30/zt(o);return i<1?o.map(a=>a*i):o}function Dy(t,e){const n=Sn(t,({value:i})=>i===void 0?NaN:Sn(i,Math.abs)),r=e.map(i=>12*i/n),o=60/zt(r);return o<1?r.map(i=>i*o):r}function qy(t){for(const{value:e}of t)if(e!==void 0)for(let n of e){if(n>0)return Gn(t,Jt);if(n<0)return Gn(t,vr)}return[1,10]}function Yy(t){const e=[];for(const{value:n}of t)if(n!==void 0)for(const r of n)e.push(r);return e}function wi(t){return(e,n)=>r=>t(e+r*(n-e))}let bi=0,ki;function Py(){const t=bi;return bi=0,ki=void 0,t}function ce(t){t!==ki&&(ki=t,console.warn(t),++bi)}function Ir(t,e,n,r,{type:o,nice:i,clamp:a,domain:l=Gn(r),unknown:s,pivot:c=0,scheme:u,range:f,symmetric:h=!0,interpolate:d=st.get(t)===ie?u==null&&f!==void 0?No:$i(u!==void 0?u:"rdbu"):En,reverse:p}){c=+c,l=ee(l);let[m,$]=l;if(l.length>2&&ce(`Warning: the diverging ${t} scale domain contains extra elements.`),_e(m,$)<0&&([m,$]=[$,m],p=!p),m=Math.min(m,c),$=Math.max($,c),typeof d!="function"&&(d=Zs(d)),f!==void 0&&(d=d.length===1?wi(d)(...f):Co(d,f)),p&&(d=Hs(d)),h){const y=n.apply(c),g=y-n.apply(m),x=n.apply($)-y;g<x?m=n.invert(y-x):g>x&&($=n.invert(y+g))}return e.domain([m,c,$]).unknown(s).interpolator(d),a&&e.clamp(a),i&&e.nice(i),{type:o,domain:[m,$],pivot:c,interpolate:d,scale:e}}function Xy(t,e,n){return Ir(t,xp(),Hy,e,n)}function _y(t,e,n){return Js(t,e,{...n,exponent:.5})}function Js(t,e,{exponent:n=1,...r}){return Ir(t,wp().exponent(n=+n),Ky(n),e,{...r,type:"diverging-pow"})}function Gy(t,e,{base:n=10,pivot:r=1,domain:o=Gn(e,r<0?vr:Jt),...i}){return Ir(t,bp().base(n=+n),Uy,e,{domain:o,pivot:r,...i})}function Vy(t,e,{constant:n=1,...r}){return Ir(t,kp().constant(n=+n),Qy(n),e,r)}const Hy={apply(t){return t},invert(t){return t}},Uy={apply:Math.log,invert:Math.exp},Zy={apply(t){return Math.sign(t)*Math.sqrt(Math.abs(t))},invert(t){return Math.sign(t)*(t*t)}};function Ky(t){return t===.5?Zy:{apply(e){return Math.sign(e)*Math.pow(Math.abs(e),t)},invert(e){return Math.sign(e)*Math.pow(Math.abs(e),1/t)}}}function Qy(t){return{apply(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))},invert(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}}function tc(t,e,n,r){return _n(t,e,n,r)}function Jy(t,e,n){return tc(t,Mp(),e,n)}function tg(t,e,n){return tc(t,Ap(),e,n)}const Vn=Symbol("ordinal");function ec(t,e,n,{type:r,interval:o,domain:i,range:a,reverse:l,hint:s}){return o=Qe(o,r),i===void 0&&(i=rc(n,o,t)),(r==="categorical"||r===Vn)&&(r="ordinal"),l&&(i=pr(i)),i=e.domain(i).domain(),a!==void 0&&(typeof a=="function"&&(a=a(i)),e.range(a)),{type:r,domain:i,range:a,scale:e,hint:s,interval:o}}function eg(t,e,{type:n,interval:r,domain:o,range:i,scheme:a,unknown:l,...s}){r=Qe(r,n),o===void 0&&(o=rc(e,r,t));let c;if(st.get(t)===Er)c=og(e),i=i===void 0?ig(c):J(i,ni);else if(st.get(t)===ie&&(i===void 0&&(n==="ordinal"||n===Vn)&&(i=Ly(o,a),i!==void 0&&(a=void 0)),a===void 0&&i===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(i!==void 0){const u=$i(a),f=i[0],h=i[1]-i[0];i=({length:d})=>Bt(p=>u(f+h*p),d)}else i=Gs(a);if(l===Lp)throw new Error(`implicit unknown on ${t} scale is not supported`);return ec(t,zp().unknown(l),e,{...s,type:n,domain:o,range:i,hint:c})}function ng(t,e,{align:n=.5,padding:r=.5,...o}){return nc(Sp().align(n).padding(r),e,o,t)}function rg(t,e,{align:n=.5,padding:r=.1,paddingInner:o=r,paddingOuter:i=t==="fx"||t==="fy"?0:r,...a}){return nc(Vl().align(n).paddingInner(o).paddingOuter(i),e,a,t)}function nc(t,e,n,r){let{round:o}=n;return o!==void 0&&t.round(o=!!o),t=ec(r,t,e,n),t.round=o,t}function rc(t,e,n){const r=new zn;for(const{value:o,domain:i}of t){if(i!==void 0)return i();if(o!==void 0)for(const a of o)r.add(a)}if(e!==void 0){const[o,i]=yt(r).map(e.floor,e);return e.range(o,e.offset(i))}if(r.size>1e4&&st.get(n)===Gt)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return il(r,Rt)}function oc(t,e){let n;for(const{hint:r}of t){const o=r?.[e];if(o!==void 0){if(n===void 0)n=o;else if(n!==o)return}}return n}function og(t){return{fill:oc(t,"fill"),stroke:oc(t,"stroke")}}function ig(t){return lt(t.fill)?Ep:Op}function Mi(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const $={};for(const[y,g]of t){const x=m[y],v=hc(y,g,{round:st.get(y)===Gt?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...x});if(v){let{label:b=y==="fx"||y==="fy"?p:e,percent:w,transform:k,inset:M,insetTop:A=M!==void 0?M:y==="y"?r:0,insetRight:z=M!==void 0?M:y==="x"?o:0,insetBottom:S=M!==void 0?M:y==="y"?i:0,insetLeft:L=M!==void 0?M:y==="x"?a:0}=x||{};if(k==null)k=void 0;else if(typeof k!="function")throw new Error("invalid scale transform; not a function");v.percent=!!w,v.label=b===void 0?lg(g,v):b,v.transform=k,y==="x"||y==="fx"?(v.insetLeft=+L,v.insetRight=+z):(y==="y"||y==="fy")&&(v.insetTop=+A,v.insetBottom=+S),$[y]=v}}return $}function ic(t){const e={},n={scales:e};for(const[r,o]of Object.entries(t)){const{scale:i,type:a,interval:l,label:s}=o;e[r]=yc(o),n[r]=i,i.type=a,l!=null&&(i.interval=l),s!=null&&(i.label=s)}return n}function ag(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?Ai(e):e;o&&sc(o,a),i&&cc(i,a);const l=o||i?lc(t,e):e;n&&sc(n,l),r&&cc(r,l)}function lg(t=[],e){let n;for(const{label:r}of t)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!We(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function ac(t){return Math.sign(Ve(t.domain()))*Math.sign(Ve(t.range()))}function Ai(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function lc({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Ai(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function sc(t,e){if(t.range===void 0){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],We(t)||(t.range=fc(t)),t.scale.range(t.range)}uc(t)}function cc(t,e){if(t.range===void 0){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],We(t)?t.range.reverse():t.range=fc(t),t.scale.range(t.range)}uc(t)}function uc(t){t.round===void 0&&ug(t)&&sg(t)<=30&&t.scale.round(!0)}function sg({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+i*2);return(l-Math.floor(l))*a}function fc(t){const e=t.scale.domain().length+mc(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},(o,i)=>n+i/(e-1)*(r-n))}function Li(t,e,n){return hc(t,n===void 0?void 0:[{hint:n}],{...e})}function hc(t,e=[],n={}){const r=cg(t,e,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&t!=="fx"&&t!=="fy"&&We({type:r})){const o=e.map(({value:i})=>i).filter(i=>i!==void 0);o.some(At)?ce(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${rn(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`):o.some(Gm)?ce(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${rn(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`):o.some(Vm)&&ce(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${rn(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=Br(e,n,St);break;case"identity":switch(st.get(t)){case Gt:n=Br(e,n,St);break;case Er:n=Br(e,n,fg);break}break;case"utc":case"time":n=Br(e,n,us);break}switch(r){case"diverging":return Xy(t,e,n);case"diverging-sqrt":return _y(t,e,n);case"diverging-pow":return Js(t,e,n);case"diverging-log":return Gy(t,e,n);case"diverging-symlog":return Vy(t,e,n);case"categorical":case"ordinal":case Vn:return eg(t,e,n);case"cyclical":case"sequential":case"linear":return Oy(t,e,n);case"sqrt":return Cy(t,e,n);case"threshold":return xi(t,e,n);case"quantile":return Ty(t,e,n);case"quantize":return Iy(t,e,n);case"pow":return Ks(t,e,n);case"log":return Ny(t,e,n);case"symlog":return Ry(t,e,n);case"utc":return tg(t,e,n);case"time":return Jy(t,e,n);case"point":return ng(t,e,n);case"band":return rg(t,e,n);case"identity":return Wy(t);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function rn(t){return typeof t=="symbol"?t.description:t}function dc(t){return typeof t=="string"?`${t}`.toLowerCase():t}const pc={toString:()=>"projection"};function cg(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if(n=dc(n),t==="fx"||t==="fy")return"band";(t==="x"||t==="y")&&l!=null&&(n=pc);for(const c of e){const u=dc(c.type);if(u!==void 0){if(n===void 0)n=u;else if(n!==u)throw new Error(`scale incompatible with channel: ${n} !== ${u}`)}}if(n===pc)return;if(n!==void 0)return n;if(r===void 0&&!e.some(({value:c})=>c!==void 0))return;const s=st.get(t);if(s===Fn)return"sqrt";if(s===qn||s===Dn)return"linear";if(s===Er)return"ordinal";if((r||o||[]).length>2)return zi(s);if(r!==void 0){if(ct(r))return zi(s);if(At(r))return"utc"}else{const c=e.map(({value:u})=>u).filter(u=>u!==void 0);if(c.some(ct))return zi(s);if(c.some(At))return"utc"}if(s===ie){if(a!=null||Sy(i))return"diverging";if(Ay(i))return"categorical"}return"linear"}function zi(t){switch(t){case Gt:return"point";case ie:return Vn;default:return"ordinal"}}function We({type:t}){return t==="ordinal"||t==="point"||t==="band"||t===Vn}function mc({type:t}){return t==="threshold"}function ug({type:t}){return t==="point"||t==="band"}function Vt(t){if(t===void 0)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function Br(t,{domain:e,...n},r){for(const o of t)o.value!==void 0&&(e===void 0&&(e=o.value?.domain),o.value=r(o.value));return{domain:e===void 0?e:r(e),...n}}function fg(t){return J(t,ni)}function hg(t={}){let e;for(const n in t)if(st.has(n)&&Te(t[n])){if(e!==void 0)throw new Error("ambiguous scale definition; multiple scales found");e=yc(Li(n,t[n]))}if(e===void 0)throw new Error("invalid scale definition; no scale found");return e}function dg(t){return e=>{if(!st.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}function yc({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if(e==="identity")return{type:"identity",apply:u=>u,invert:u=>u};const c=t.unknown?t.unknown():void 0;return{type:e,domain:In(n),...r!==void 0&&{range:In(r)},...a!==void 0&&{transform:a},...l&&{percent:l},...c!==void 0&&{unknown:c},...i!==void 0&&{interval:i},...o!==void 0&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...s!==void 0&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:u=>t(u),...t.invert&&{invert:u=>t.invert(u)}}}function pg(t,e){const{fx:n,fy:r}=Mi(t,e),o=n?.scale.domain(),i=r?.scale.domain();return o&&i?Cp(o,i).map(([a,l],s)=>({x:a,y:l,i:s})):o?o.map((a,l)=>({x:a,i:l})):i?i.map((a,l)=>({y:a,i:l})):void 0}function mg(t,{x:e,y:n}){return e&&=Ei(e),n&&=Ei(n),t.filter(e&&n?r=>e.has(r.x)&&n.has(r.y):e?r=>e.has(r.x):r=>n.has(r.y)).sort(e&&n?(r,o)=>e.get(r.x)-e.get(o.x)||n.get(r.y)-n.get(o.y):e?(r,o)=>e.get(r.x)-e.get(o.x):(r,o)=>n.get(r.y)-n.get(o.y))}function Si(t,{fx:e,fy:n}){const r=ne(t),o=e?.value,i=n?.value;return e&&n?Ln(r,a=>(a.fx=o[a[0]],a.fy=i[a[0]],a),a=>o[a],a=>i[a]):e?Ln(r,a=>(a.fx=o[a[0]],a),a=>o[a]):Ln(r,a=>(a.fy=i[a[0]],a),a=>i[a])}function yg(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:o})=>`translate(${t(o)-r},0)`:({y:o})=>`translate(0,${e(o)-n})`}function gg(t){const e=[],n=new Uint32Array(qt(t,r=>r.length));for(const r of t){let o=0;for(const i of t)r!==i&&(n.set(i,o),o+=i.length);e.push(n.slice(0,o))}return e}const $g=new Map([["top",Oi],["right",Ri],["bottom",Ci],["left",Ni],["top-left",jr(Oi,Ni)],["top-right",jr(Oi,Ri)],["bottom-left",jr(Ci,Ni)],["bottom-right",jr(Ci,Ri)],["top-empty",wg],["right-empty",Mg],["bottom-empty",bg],["left-empty",kg],["empty",Ag]]);function vg(t){if(t==null)return null;const e=$g.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}const gc=new WeakMap;function Ei(t){let e=gc.get(t);return e||gc.set(t,e=new Ro(J(t,(n,r)=>[n,r]))),e}function xe(t,e){return Ei(t).get(e)}function xg(t,e,n){return e=re(e),n=re(n),t.find(r=>Object.is(re(r.x),e)&&Object.is(re(r.y),n))}function Wr(t,e,n){return xg(t,e,n)?.empty}function Oi(t,{y:e},{y:n}){return e?xe(e,n)===0:!0}function Ci(t,{y:e},{y:n}){return e?xe(e,n)===e.length-1:!0}function Ni(t,{x:e},{x:n}){return e?xe(e,n)===0:!0}function Ri(t,{x:e},{x:n}){return e?xe(e,n)===e.length-1:!0}function wg(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=xe(e,r);if(i>0)return Wr(t,n,e[i-1])}function bg(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=xe(e,r);if(i<e.length-1)return Wr(t,n,e[i+1])}function kg(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=xe(e,n);if(i>0)return Wr(t,e[i-1],r)}function Mg(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=xe(e,n);if(i<e.length-1)return Wr(t,e[i+1],r)}function Ag(t,e,{empty:n}){return n}function jr(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function Ti(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map(({x:o,y:i})=>r.get(o)?.get(i)??[]):e?t.map(({x:o})=>r.get(o)??[]):t.map(({y:o})=>r.get(o)??[])}const $c=Math.PI,ue=2*$c,Ii=.618;function Lg({projection:t,inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:o=e,insetLeft:i=e}={},a){if(t==null)return;if(typeof t.stream=="function")return t;let l,s,c="frame";if(Tt(t)){let b;if({type:t,domain:s,inset:b,insetTop:n=b!==void 0?b:n,insetRight:r=b!==void 0?b:r,insetBottom:o=b!==void 0?b:o,insetLeft:i=b!==void 0?b:i,clip:c=c,...l}=t,t==null)return}typeof t!="function"&&({type:t}=Bi(t));const{width:u,height:f,marginLeft:h,marginRight:d,marginTop:p,marginBottom:m}=a,$=u-h-d-i-r,y=f-p-m-n-o;if(t=t?.({width:$,height:y,clip:c,...l}),t==null)return;c=zg(c,h,p,u-d,f-m);let g=h+i,x=p+n,v;if(s!=null){const[[b,w],[k,M]]=Kt(t).bounds(s),A=Math.min($/(k-b),y/(M-w));A>0?(g-=(A*(b+k)-$)/2,x-=(A*(w+M)-y)/2,v=mr({point(z,S){this.stream.point(z*A+g,S*A+x)}})):ce("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??=g===0&&x===0?vc():mr({point(b,w){this.stream.point(b+g,w+x)}}),{stream:b=>t.stream(v.stream(c(b)))}}function Bi(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Ft(Pp,.7463,.4673);case"albers":return Fr(Vp,.7463,.4673);case"azimuthal-equal-area":return Ft(Yp,4,4);case"azimuthal-equidistant":return Ft(qp,ue,ue);case"conic-conformal":return Fr(Gp,ue,ue);case"conic-equal-area":return Fr(_p,6.1702,2.9781);case"conic-equidistant":return Fr(Xp,7.312,3.6282);case"equal-earth":return Ft(Dp,5.4133,2.6347);case"equirectangular":return Ft(Fp,ue,$c);case"gnomonic":return Ft(jp,3.4641,3.4641);case"identity":return{type:vc};case"reflect-y":return{type:Sg};case"mercator":return Ft(Wp,ue,ue);case"orthographic":return Ft(Bp,2,2);case"stereographic":return Ft(Ip,2,2);case"transverse-mercator":return Ft(Tp,ue,ue);default:throw new Error(`unknown projection type: ${t}`)}}function zg(t,e,n,r,o){if(t===!1||t==null||typeof t=="number")return i=>i;switch(t===!0&&(t="frame"),`${t}`.toLowerCase()){case"frame":return Np(e,n,r,o);default:throw new Error(`unknown projection clip type: ${t}`)}}function Ft(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return a!=null&&s.precision?.(a),i!=null&&s.rotate?.(i),typeof l=="number"&&s.clipAngle?.(l),r!=null&&(s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2])),s},aspectRatio:n/e}}function Fr(t,e,n){const{type:r,aspectRatio:o}=Ft(t,e,n);return{type:i=>{const{parallels:a,domain:l,width:s,height:c}=i,u=r(i);return a!=null&&(u.parallels(a),l===void 0&&s!=null&&u.fitSize([s,c],{type:"Sphere"})),u},aspectRatio:o}}const vc=xt({stream:t=>t}),Sg=xt(mr({point(t,e){this.stream.point(t,-e)}}));function xc(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(f,h){l[c]=f,s[c]=h}});for(c=0;c<a;++c)u.point(o[c],i[c])}function Eg({projection:t}={}){return t==null?!1:typeof t.stream=="function"?!0:(Tt(t)&&(t=t.type),t!=null)}function Og(t){if(typeof t?.stream=="function")return Ii;if(Tt(t)){let e,n;if({domain:e,type:t,...n}=t,e!=null&&t!=null){const r=typeof t=="string"?Bi(t).type:t,[[o,i],[a,l]]=Kt(r({...n,width:100,height:100})).bounds(e),s=(l-i)/(a-o);return s&&isFinite(s)?s<.2?.2:s>5?5:s:Ii}}if(t!=null){if(typeof t!="function"){const{aspectRatio:e}=Bi(t);if(e)return e}return Ii}}function Hn(t,e,{projection:n}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=mi(i,e),n&&r?.scale==="x"&&o?.scale==="y"&&xc("x","y",i,n),r&&(i.x=St(i.x)),o&&(i.y=St(i.y)),i}function Cg(t){const e=[],n=[],r={scale:"x",value:e},o={scale:"y",value:n},i={point(a,l){e.push(a),n.push(l)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of t.value)Rp(a,i);return[r,o]}function Dr(t={}){const{document:e=typeof window<"u"?window.document:void 0,clip:n}=t;return{document:e,clip:xs(n)}}function U(t,{document:e}){return de(Hl(t).call(e.documentElement))}const Wi=Symbol("unset");function on(t){return(t.length===1?Ng:Rg)(t)}function Ng(t){let e,n=Wi;return r=>(Object.is(n,r)||(n=r,e=t(r)),e)}function Rg(t){let e,n;return(...r)=>((n?.length!==r.length||n.some((o,i)=>!Object.is(o,r[i])))&&(n=r,e=t(...r)),e)}const Tg=on(t=>new Intl.NumberFormat(t)),Ig=on((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}})),Bg=on((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}}));function wc(t="en-US"){const e=Tg(t);return n=>n!=null&&!isNaN(n)?e.format(n):void 0}function Wg(t="en-US",e="short"){const n=Ig(t,e);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2e3,+r)))?n.format(r):void 0}function jg(t="en-US",e="short"){const n=Bg(t,e);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2001,0,+r)))?n.format(r):void 0}function bc(t){return Om(t,"Invalid Date")}function Fg(t="en-US"){const e=wc(t);return n=>(n instanceof Date?bc:typeof n=="number"?e:kt)(n)}const an=Fg(),wt=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let Dg=0,qg=0;function kc(){return`plot-clip-${++Dg}`}function Yg(){return`plot-pattern-${++qg}`}function Mc(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:$,opacity:y,mixBlendMode:g,imageFilter:x,paintOrder:v,pointerEvents:b,shapeRendering:w,channels:k},{ariaLabel:M,fill:A="currentColor",fillOpacity:z,stroke:S="none",strokeOpacity:L,strokeWidth:C,strokeLinecap:E,strokeLinejoin:O,strokeMiterlimit:R,paintOrder:N}){A===null&&(l=null,s=null),S===null&&(c=null,f=null),lt(A)?!lt(S)&&(!lt(l)||k?.fill)&&(S="none"):lt(S)&&(!lt(c)||k?.stroke)&&(A="none");const[F,T]=Mt(l,A),[B,j]=ht(s,z),[I,Y]=Mt(c,S),[H,G]=ht(f,L),[X,W]=ht(y);nn(Y)||(u===void 0&&(u=C),d===void 0&&(d=E),h===void 0&&(h=O),p===void 0&&!Zm(h)&&(p=R),!nn(T)&&v===void 0&&(v=N));const[P,_]=ht(u);return A!==null&&(t.fill=pt(T,"currentColor"),t.fillOpacity=Un(j,1)),S!==null&&(t.stroke=pt(Y,"none"),t.strokeWidth=Un(_,1),t.strokeOpacity=Un(G,1),t.strokeLinejoin=pt(h,"miter"),t.strokeLinecap=pt(d,"butt"),t.strokeMiterlimit=Un(p,4),t.strokeDasharray=pt(m,"none"),t.strokeDashoffset=pt($,"0")),t.target=kt(a),t.ariaLabel=kt(M),t.ariaDescription=kt(o),t.ariaHidden=kt(i),t.opacity=Un(W,1),t.mixBlendMode=pt(g,"normal"),t.imageFilter=pt(x,"none"),t.paintOrder=pt(v,"normal"),t.pointerEvents=pt(b,"auto"),t.shapeRendering=pt(w,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:F,scale:"auto",optional:!0},fillOpacity:{value:B,scale:"auto",optional:!0},stroke:{value:I,scale:"auto",optional:!0},strokeOpacity:{value:H,scale:"auto",optional:!0},strokeWidth:{value:P,optional:!0},opacity:{value:X,scale:"auto",optional:!0}}}function Pg(t,e){e&&t.filter(n=>Fo(e[n])).append("title").call(_g,e)}function Xg(t,e){e&&t.filter(([n])=>Fo(e[n])).append("title").call(Gg,e)}function _g(t,e){e&&t.text(n=>an(e[n]))}function Gg(t,e){e&&t.text(([n])=>an(e[n]))}function ut(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:i,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){r&&q(t,"aria-label",h=>r[h]),i&&q(t,"fill",h=>i[h]),a&&q(t,"fill-opacity",h=>a[h]),l&&q(t,"stroke",h=>l[h]),s&&q(t,"stroke-opacity",h=>s[h]),c&&q(t,"stroke-width",h=>c[h]),u&&q(t,"opacity",h=>u[h]),f&&zc(t,h=>f[h],e),n||Pg(t,o)}function qr(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:i,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){r&&q(t,"aria-label",([h])=>r[h]),i&&q(t,"fill",([h])=>i[h]),a&&q(t,"fill-opacity",([h])=>a[h]),l&&q(t,"stroke",([h])=>l[h]),s&&q(t,"stroke-opacity",([h])=>s[h]),c&&q(t,"stroke-width",([h])=>c[h]),u&&q(t,"opacity",([h])=>u[h]),f&&zc(t,([h])=>f[h],e),n||Xg(t,o)}function Vg({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:e,n,r,o,i,a,l,s].filter(u=>u!==void 0)}function ji(t,e,n){const r=Ce(t,o=>e[o]);return n===void 0&&r.size>1+t.length>>1&&ce("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*Ac(t,e,n,r){const{z:o}=n,{z:i}=r,a=Vg(r,n),l=[...e,...a];for(const s of i?ji(t,i,o):[t]){let c,u;t:for(const f of s){for(const h of l)if(!vt(h[f])){u&&u.push(-1);continue t}if(c===void 0){u&&(yield u),c=a.map(h=>re(h[f])),u=[f];continue}u.push(f);for(let h=0;h<a.length;++h)if(re(a[h][f])!==c[h]){yield u,c=a.map(d=>re(d[f])),u=[f];continue t}}u&&(yield u)}}function Hg(t,e,n,r){let o;const{clip:i=r.clip}=e;switch(i){case"frame":{t=U("svg:g",r).each(function(){this.appendChild(t.node()),t.node=()=>this}),o=Ug(r,n);break}case"sphere":{o=Zg(r);break}}q(t,"aria-label",e.ariaLabel),q(t,"aria-description",e.ariaDescription),q(t,"aria-hidden",e.ariaHidden),q(t,"clip-path",o)}function Lc(t){const e=new WeakMap;return(n,r)=>{let o=e.get(n);if(!o){const i=kc();de(n.ownerSVGElement).append("clipPath").attr("id",i).call(t,n,r),e.set(n,o=`url(#${i})`)}return o}}const Ug=Lc((t,e,n)=>{const{width:r,height:o,marginLeft:i,marginRight:a,marginTop:l,marginBottom:s}=n;t.append("rect").attr("x",i).attr("y",l).attr("width",r-a-i).attr("height",o-l-s)}),Zg=Lc((t,e)=>{const{projection:n}=e;if(!n)throw new Error('the "sphere" clip option requires a projection');t.append("path").attr("d",Kt(n)({type:"Sphere"}))});function ot(t,e,n,r){Hg(t,e,n,r),q(t,"class",e.className),q(t,"fill",e.fill),q(t,"fill-opacity",e.fillOpacity),q(t,"stroke",e.stroke),q(t,"stroke-width",e.strokeWidth),q(t,"stroke-opacity",e.strokeOpacity),q(t,"stroke-linejoin",e.strokeLinejoin),q(t,"stroke-linecap",e.strokeLinecap),q(t,"stroke-miterlimit",e.strokeMiterlimit),q(t,"stroke-dasharray",e.strokeDasharray),q(t,"stroke-dashoffset",e.strokeDashoffset),q(t,"shape-rendering",e.shapeRendering),q(t,"filter",e.imageFilter),q(t,"paint-order",e.paintOrder);const{pointerEvents:o=r.pointerSticky===!1?"none":void 0}=e;q(t,"pointer-events",o)}function Q(t,e){Kg(t,"mix-blend-mode",e.mixBlendMode),q(t,"opacity",e.opacity)}function zc(t,e,n){t.each(function(r){const o=e(r);if(o!=null){const i=this.ownerDocument.createElementNS(Ne.svg,"a");i.setAttribute("fill","inherit"),i.setAttributeNS(Ne.xlink,"href",o),n!=null&&i.setAttribute("target",n),this.parentNode.insertBefore(i,this).appendChild(this)}})}function q(t,e,n){n!=null&&t.attr(e,n)}function Kg(t,e,n){n!=null&&t.style(e,n)}function tt(t,e,{x:n,y:r},o=wt,i=wt){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function pt(t,e){if((t=kt(t))!==e)return t}function Un(t,e){if((t=rt(t))!==e)return t}const Qg=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Yr(t){if(t===void 0)return"plot-d6a7b5";if(t=`${t}`,!Qg.test(t))throw new Error(`invalid class name: ${t}`);return t}function Fi(t,e){if(typeof e=="string")t.property("style",e);else if(e!=null)for(const n of t)Object.assign(n.style,e)}function Ht({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}let et=class{constructor(e,n={},r={},o){const{facet:i="auto",facetAnchor:a,fx:l,fy:s,sort:c,dx:u=0,dy:f=0,margin:h=0,marginTop:d=h,marginRight:p=h,marginBottom:m=h,marginLeft:$=h,className:y,clip:g=o?.clip,channels:x,tip:v,render:b}=r;if(this.data=e,this.sort=ge(c)?c:null,this.initializer=Lt(r).initializer,this.transform=this.initializer?r.transform:jt(r).transform,i===null||i===!1?this.facet=null:(this.facet=Ot(i===!0?"include":i,"facet",["auto","include","exclude","super"]),this.fx=e===Rn&&typeof l=="string"?[l]:l,this.fy=e===Rn&&typeof s=="string"?[s]:s),this.facetAnchor=vg(a),n=Jo(n),x!==void 0&&(n={...Jg(x),...n}),o!==void 0&&(n={...Mc(this,r,o),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([w,k])=>{if(Xt(k.value)){const{value:M,label:A=k.label,scale:z=k.scale}=k.value;k={...k,label:A,scale:z,value:M}}if(e===Rn&&typeof k.value=="string"){const{value:M}=k;k={...k,value:[M]}}return[w,k]}).filter(([w,{value:k,optional:M}])=>{if(k!=null)return!0;if(M)return!1;throw new Error(`missing channel value: ${w}`)})),this.dx=+u,this.dy=+f,this.marginTop=+d,this.marginRight=+p,this.marginBottom=+m,this.marginLeft=+$,this.clip=xs(g),this.tip=t0(v),this.className=y?Yr(y):null,this.facet==="super"){if(l||s)throw new Error("super-faceting cannot use fx or fy");for(const w in this.channels){const{scale:k}=n[w];if(!(k!=="x"&&k!=="y"))throw new Error("super-faceting cannot use x or y")}}b!=null&&(this.render=ln(b,this.render))}initialize(e,n,r){let o=Ze(this.data);e===void 0&&o!=null&&(e=[ne(o)]);const i=e;this.transform!=null&&({facets:e,data:o}=this.transform(o,e,r),o=Ze(o)),e!==void 0&&(e.original=i);const a=Ws(this.channels,o);return this.sort!=null&&wy(o,e,a,n,this.sort),{data:o,facets:e,channels:a}}filter(e,n,r){for(const o in n){const{filter:i=vt}=n[o];if(i!==null){const a=r[o];e=e.filter(l=>i(a[l]))}}return e}project(e,n,r){for(const o in e)if(e[o].scale==="x"&&/^x|x$/.test(o)){const i=o.replace(/^x|x$/,"y");i in e&&e[i].scale==="y"&&xc(o,i,n,r.projection)}}scale(e,n,r){const o=mi(e,n);return r.projection&&this.project(e,o,r),o}};function It(...t){return t.plot=et.prototype.plot,t}function ln(t,e){if(t==null)return e===null?void 0:e;if(e==null)return t===null?void 0:t;if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);return function(n,r,o,i,a,l){return t.call(this,n,r,o,i,a,(s,c,u,f,h)=>e.call(this,s,c,u,f,h,l))}}function Jg(t){return Object.fromEntries(Object.entries(Jo(t)).map(([e,n])=>(n=typeof n=="string"?{value:n,label:e}:tn(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[e,n])))}function t0(t){return t===!0?"xy":t===!1||t==null?null:typeof t=="string"?Ot(t,"tip",["x","y","xy"]):t}function je(t,e){return t?.tip===!0?{...t,tip:e}:Tt(t?.tip)&&t.tip.pointer===void 0?{...t,tip:{...t.tip,pointer:e}}:t}function e0(t,e,n={}){let r=.5-wt,o=.5+wt,i=.5+wt,a=.5-wt;for(const{marginTop:m,marginRight:$,marginBottom:y,marginLeft:g}of e)m>r&&(r=m),$>o&&(o=$),y>i&&(i=y),g>a&&(a=g);let{margin:l,marginTop:s=l!==void 0?l:r,marginRight:c=l!==void 0?l:o,marginBottom:u=l!==void 0?l:i,marginLeft:f=l!==void 0?l:a}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=n0(t,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:m,marginTop:$=m!==void 0?m:s,marginRight:y=m!==void 0?m:c,marginBottom:g=m!==void 0?m:u,marginLeft:x=m!==void 0?m:f}=n.facet??{};$=+$,y=+y,g=+g,x=+x,p.facet={marginTop:$,marginRight:y,marginBottom:g,marginLeft:x}}return p}function n0({x:t,y:e,fy:n,fx:r},{projection:o,aspectRatio:i},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:c,marginLeftDefault:u}){const f=n&&n.scale.domain().length||1,h=Og(o);if(h){const p=r?r.scale.domain().length:1,m=(1.1*f-.1)/(1.1*p-.1)*h,$=Math.max(.1,Math.min(10,m));return Math.round((a-u-s)*$+l+c)}const d=e?We(e)?e.scale.domain().length||1:Math.max(7,17/f):1;if(i!=null){if(i=+i,!(isFinite(i)&&i>0))throw new Error(`invalid aspectRatio: ${i}`);const p=Sc("y",e)/(Sc("x",t)*i),m=r?r.scale.bandwidth():1,$=n?n.scale.bandwidth():1,y=m*(a-u-s)-t.insetLeft-t.insetRight;return(p*y+e.insetTop+e.insetBottom)/$+l+c}return!!(e||n)*Math.max(1,Math.min(60,d*f))*20+!!r*30+60}function Sc(t,e){if(!e)throw new Error(`aspectRatio requires ${t} scale`);const{type:n,domain:r}=e;let o;switch(n){case"linear":case"utc":case"time":o=Number;break;case"pow":{const l=e.scale.exponent();o=s=>Math.pow(s,l);break}case"log":o=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${n}`)}const[i,a]=yt(r);return Math.abs(o(a)-o(i))}const Ec=new WeakMap;function Di(t,e,{x:n,y:r,px:o,py:i,maxRadius:a=40,channels:l,render:s,...c}={}){return a=+a,o!=null&&(n??=null,l={...l,px:{value:o,scale:"x"}}),i!=null&&(r??=null,l={...l,py:{value:i,scale:"y"}}),{x:n,y:r,channels:l,...c,render:ln(function(u,f,h,d,p,m){p={...p,pointerSticky:!1};const $=p.ownerSVGElement,{data:y}=p.getMarkState(this);let g=Ec.get($);g||Ec.set($,g={sticky:!1,roots:[],renders:[]});let x=g.renders.push(Y)-1;const{x:v,y:b,fx:w,fy:k}=f;let M=w?w(u.fx)-d.marginLeft:0,A=k?k(u.fy)-d.marginTop:0;v?.bandwidth&&(M+=v.bandwidth()/2),b?.bandwidth&&(A+=b.bandwidth()/2);const z=u.fi!=null;let S;if(z){let W=g.facetStates;W||(g.facetStates=W=new Map),S=W.get(this),S||W.set(this,S=new Map)}const[L,C]=Ht(this,d),{px:E,py:O}=h,R=E?W=>E[W]:Oc(h,L),N=O?W=>O[W]:Cc(h,C);let F,T,B,j;function I(W,P){if(z)if(j&&(j=cancelAnimationFrame(j)),W==null)S.delete(u.fi);else{S.set(u.fi,P),j=requestAnimationFrame(()=>{j=null;for(const[_,Z]of S)if(Z<P||Z===P&&_<u.fi){W=null;break}Y(W)});return}Y(W)}function Y(W){if(F===W&&B===g.sticky)return;F=W,B=p.pointerSticky=g.sticky;const P=F==null?[]:[F];z&&(P.fx=u.fx,P.fy=u.fy,P.fi=u.fi);const _=m(P,f,h,d,p);if(T){if(z){const Z=T.parentNode,K=T.getAttribute("transform"),nt=_.getAttribute("transform");K?_.setAttribute("transform",K):_.removeAttribute("transform"),nt?Z.setAttribute("transform",nt):Z.removeAttribute("transform"),_.removeAttribute("aria-label"),_.removeAttribute("aria-description"),_.removeAttribute("aria-hidden")}T.replaceWith(_)}if(g.roots[x]=T=_,!(F==null&&S?.size>1)){const Z=F==null?null:te(y)?y[F]:y.get(F);p.dispatchValue(Z)}return _}function H(W){if(g.sticky||W.pointerType==="mouse"&&W.buttons===1)return;let[P,_]=Hp(W);P-=M,_-=A;const Z=P<d.marginLeft||P>d.width-d.marginRight?1:t,K=_<d.marginTop||_>d.height-d.marginBottom?1:e;let nt=null,ft=a*a;for(const at of u){const dt=Z*(R(at)-P),mt=K*(N(at)-_),bt=dt*dt+mt*mt;bt<=ft&&(nt=at,ft=bt)}if(nt!=null&&(t!==1||e!==1)){const at=R(nt)-P,dt=N(nt)-_;ft=at*at+dt*dt}I(nt,ft)}function G(W){W.pointerType==="mouse"&&F!=null&&(g.sticky&&g.roots.some(P=>P?.contains(W.target))||(g.sticky?(g.sticky=!1,g.renders.forEach(P=>P(null))):(g.sticky=!0,Y(F)),W.stopImmediatePropagation()))}function X(W){W.pointerType==="mouse"&&(g.sticky||I(null))}return $.addEventListener("pointerenter",H),$.addEventListener("pointermove",H),$.addEventListener("pointerdown",G),$.addEventListener("pointerleave",X),Y(null)},s)}}function qi(t){return Di(1,1,t)}function Yi(t){return Di(1,.01,t)}function Pr(t){return Di(.01,1,t)}function Oc({x1:t,x2:e,x:n=t},r){return t&&e?o=>(t[o]+e[o])/2:n?o=>n[o]:()=>r}function Cc({y1:t,y2:e,y:n=t},r){return t&&e?o=>(t[o]+e[o])/2:n?o=>n[o]:()=>r}function Nc(t){return We(t)&&t.interval===void 0?void 0:"tabular-nums"}function r0(t,e){let{label:n=t.label,tickSize:r=6,width:o=240,height:i=44+r,marginTop:a=18,marginRight:l=0,marginBottom:s=16+r,marginLeft:c=0,style:u,ticks:f=(o-c-l)/64,tickFormat:h,fontVariant:d=Nc(t),round:p=!0,opacity:m,className:$}=e;const y=Dr(e);$=Yr($),m=ht(m)[1],h===null&&(h=()=>null);const g=U("svg",y).attr("class",`${$}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",i).attr("viewBox",`0 0 ${o} ${i}`).call(L=>L.append("style").text(`:where(.${$}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${$}-ramp text) {
  white-space: pre;
}`)).call(Fi,u);let x=L=>L.selectAll(".tick line").attr("y1",a+s-i),v;const b=p?(L,C)=>L.rangeRound(C):(L,C)=>L.range(C),{type:w,domain:k,range:M,interpolate:A,scale:z,pivot:S}=t;if(A){const L=M===void 0?A:Co(A.length===1?wi(A):A,M);v=b(z.copy(),Bt(En(c,o-l),Math.min(k.length+(S!==void 0),M===void 0?1/0:M.length)));const C=256,E=y.document.createElement("canvas");E.width=C,E.height=1;const O=E.getContext("2d");for(let R=0,N=C-1;R<C;++R)O.fillStyle=L(R/N),O.fillRect(R,0,1,1);g.append("image").attr("opacity",m).attr("x",c).attr("y",a).attr("width",o-c-l).attr("height",i-a-s).attr("preserveAspectRatio","none").attr("xlink:href",E.toDataURL())}else if(w==="threshold"){const L=k,C=h===void 0?E=>E:typeof h=="string"?To(h):h;v=b(Gl().domain([-1,M.length-1]),[c,o-l]),g.append("g").attr("fill-opacity",m).selectAll().data(M).enter().append("rect").attr("x",(E,O)=>v(O-1)).attr("y",a).attr("width",(E,O)=>v(O)-v(O-1)).attr("height",i-a-s).attr("fill",E=>E),f=J(L,(E,O)=>O),h=E=>C(L[E],E)}else v=b(Vl().domain(k),[c,o-l]),g.append("g").attr("fill-opacity",m).selectAll().data(k).enter().append("rect").attr("x",v).attr("y",a).attr("width",Math.max(0,v.bandwidth()-1)).attr("height",i-a-s).attr("fill",z),x=()=>{};return g.append("g").attr("transform",`translate(0,${i-s})`).call(Up(v).ticks(Array.isArray(f)?null:f,typeof h=="string"?h:void 0).tickFormat(typeof h=="function"?h:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",pt(d,"normal")).call(x).call(L=>L.select(".domain").remove()),n!==void 0&&g.append("text").attr("x",c).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),g.node()}const Xr=Math.PI/180;function sn(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=Pi(n),t.markerMid=Pi(r),t.markerEnd=Pi(o)}function Pi(t){if(t==null||t===!1)return null;if(t===!0)return Tc;if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Rc("auto");case"arrow-reverse":return Rc("auto-start-reverse");case"dot":return o0;case"circle":case"circle-fill":return Tc;case"circle-stroke":return i0;case"tick":return Xi("auto");case"tick-x":return Xi(90);case"tick-y":return Xi(0)}throw new Error(`invalid marker: ${t}`)}function Rc(t){return(e,n)=>U("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function o0(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function Tc(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function i0(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Xi(t){return(e,n)=>U("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let a0=0;function Zn(t,e,{stroke:n},r){return Bc(t,e,n&&(o=>n[o]),null,r)}function l0(t,e,{stroke:n,z:r},o){return Bc(t,e,n&&(([i])=>n[i]),r,o)}const _i=1,Ic=2;function s0(t,e){const n=new Uint8Array(e.length),r=t.data().filter(i=>i.length>1),o=r.length;for(let i=0,a=Wi;i<o;++i){const l=r[i];if(l.length>1){const s=l[0];a!==(a=re(e[s]))&&(n[s]|=_i)}}for(let i=o-1,a=Wi;i>=0;--i){const l=r[i];if(l.length>1){const s=l[0];a!==(a=re(e[s]))&&(n[s]|=Ic)}}return([i])=>n[i]}function Bc(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=()=>o,a,l){if(!e&&!n&&!r)return;const s=new Map,c=a&&s0(t,a);function u(f,h,d){return function(p){if(d&&!d(p))return;const m=i(p);let $=s.get(h);$||s.set(h,$=new Map);let y=$.get(m);if(!y){const g=this.parentNode.insertBefore(h(m,l),this),x=`plot-marker-${++a0}`;g.setAttribute("id",x),$.set(m,y=`url(#${x})`)}this.setAttribute(f,y)}}e&&t.each(u("marker-start",e,c&&(f=>c(f)&_i))),n&&c&&t.each(u("marker-start",n,f=>!(c(f)&_i))),n&&t.each(u("marker-mid",n)),r&&t.each(u("marker-end",r,c&&(f=>c(f)&Ic)))}function Kn({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Wc(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Qn({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Wc(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Wc(t,e,n){return t===void 0&&e===void 0&&n===void 0?wt?[1,0]:[.5,.5]:[e,n]}function jc(t,{interval:e}){return t={...tn(t)},t.interval=Sr(t.interval===void 0?e:t.interval),t}function _r(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=jc(o,n);if(l==null||s==null&&!r)return n;const c=_t(o);if(s==null){let d;const p={transform:m=>d||(d=V(m,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:i===void 0?p:i,[`${t}2`]:a===void 0&&!(i===a&&r)?p:a}}let u,f;function h(d){return f!==void 0&&d===u?f:f=J(V(u=d,l),p=>s.floor(p))}return e({...n,[t]:void 0,[`${t}1`]:i===void 0?{transform:h,label:c}:i,[`${t}2`]:a===void 0?{transform:d=>h(d).map(p=>s.offset(p)),label:c}:a})}function Fc(t,e,n){const{[t]:r}=n,{value:o,interval:i}=jc(r,n);return o==null||i==null?n:e({...n,[t]:{label:_t(r),transform:a=>{const l=J(V(a,o),c=>i.floor(c)),s=l.map(c=>i.offset(c));return l.map(At(l)?(c,u)=>c==null||isNaN(c=+c)||(u=s[u],u==null)||isNaN(u=+u)?void 0:new Date((c+u)/2):(c,u)=>c==null||(u=s[u],u==null)?NaN:(+c+ +u)/2)}}})}function Dc(t={}){return _r("x",Kn,t,!0)}function qc(t={}){return _r("y",Qn,t,!0)}function Gi(t={}){return _r("x",Kn,t)}function Vi(t={}){return _r("y",Qn,t)}function Yc(t={}){return Fc("x",Kn,t)}function Pc(t={}){return Fc("y",Qn,t)}const Xc={ariaLabel:"rule",fill:null,stroke:"currentColor"};let _c=class extends et{constructor(e,n={}){const{x:r,y1:o,y2:i,inset:a=0,insetTop:l=a,insetBottom:s=a}=n;super(e,{x:{value:r,scale:"x",optional:!0},y1:{value:o,scale:"y",optional:!0},y2:{value:i,scale:"y",optional:!0}},je(n,"x"),Xc),this.insetTop=rt(l),this.insetBottom=rt(s),sn(this,n)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y1:c,y2:u}=r,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:m,marginBottom:$}=o,{insetTop:y,insetBottom:g}=this;return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a},wt,0).call(x=>x.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",s?v=>s[v]:(m+f-p)/2).attr("x2",s?v=>s[v]:(m+f-p)/2).attr("y1",c&&!Vt(l)?v=>c[v]+y:d+y).attr("y2",u&&!Vt(l)?l.bandwidth?v=>u[v]+l.bandwidth()-g:v=>u[v]-g:h-$-g).call(ut,this,r).call(Zn,this,r,i)).node()}},Gc=class extends et{constructor(e,n={}){const{x1:r,x2:o,y:i,inset:a=0,insetRight:l=a,insetLeft:s=a}=n;super(e,{y:{value:i,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:o,scale:"x",optional:!0}},je(n,"y"),Xc),this.insetRight=rt(l),this.insetLeft=rt(s),sn(this,n)}render(e,n,r,o,i){const{x:a,y:l}=n,{y:s,x1:c,x2:u}=r,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:m,marginBottom:$}=o,{insetLeft:y,insetRight:g}=this;return U("svg:g",i).call(ot,this,o,i).call(tt,this,{y:s&&l},0,wt).call(x=>x.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",c&&!Vt(a)?v=>c[v]+y:m+y).attr("x2",u&&!Vt(a)?a.bandwidth?v=>u[v]+a.bandwidth()-g:v=>u[v]-g:f-p-g).attr("y1",s?v=>s[v]:(d+h-$)/2).attr("y2",s?v=>s[v]:(d+h-$)/2).call(ut,this,r).call(Zn,this,r,i)).node()}};function we(t,e){let{x:n=D,y:r,y1:o,y2:i,...a}=Vi(e);return[o,i]=Vc(r,o,i),new _c(t,{...a,x:n,y1:o,y2:i})}function be(t,e){let{y:n=D,x:r,x1:o,x2:i,...a}=Gi(e);return[o,i]=Vc(r,o,i),new Gc(t,{...a,y:n,x1:o,x2:i})}function Vc(t,e,n){if(t==null){if(e===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,e]}else{if(e===void 0)return n===void 0?[0,t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}function cn(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)typeof e[r]!="function"&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const c0={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Hc="\xAD";let Gr=class extends et{constructor(e,n={}){const{x:r,y:o,text:i=oe(e)&&vs(e)?D:gt,frameAnchor:a,textAnchor:l=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:s=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=h?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:m,fontVariant:$,fontWeight:y,rotate:g}=n,[x,v]=ht(g,0),[b,w]=d0(p);if(super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},fontSize:{value:b,optional:!0},rotate:{value:Xm(x),optional:!0},text:{value:i,filter:Fo,optional:!0}},n,c0),this.rotate=v,this.textAnchor=pt(l,"middle"),this.lineAnchor=Ot(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=Uc(f),this.monospace=!!h,this.fontFamily=kt(d),this.fontSize=w,this.fontStyle=kt(m),this.fontVariant=kt($),this.fontWeight=kt(y),this.frameAnchor=jn(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=tu(this),this.clipLine=eu(this)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,rotate:u,text:f,title:h,fontSize:d}=r,{rotate:p}=this,[m,$]=Ht(this,o);return U("svg:g",i).call(ot,this,o,i).call(Qc,this,f,o).call(tt,this,{x:s&&a,y:c&&l}).call(y=>y.selectAll().data(e).enter().append("text").call(Q,this).call(u0,this,f,h).attr("transform",cn`translate(${s?g=>s[g]:m},${c?g=>c[g]:$})${u?g=>` rotate(${u[g]})`:p?` rotate(${p})`:""}`).call(q,"font-size",d&&(g=>d[g])).call(ut,this,r)).node()}};function Uc(t){return t==null?null:Ot(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function u0(t,e,n,r){if(!n)return;const{lineAnchor:o,lineHeight:i,textOverflow:a,splitLines:l,clipLine:s}=e;t.each(function(c){const u=l(an(n[c])??"").map(s),f=u.length,h=o==="top"?.71:o==="bottom"?1-f:(164-f*100)/200;if(f>1){let d=0;for(let p=0;p<f;++p){if(++d,!u[p])continue;const m=this.ownerDocument.createElementNS(Ne.svg,"tspan");m.setAttribute("x",0),p===d-1?m.setAttribute("y",`${(h+p)*i}em`):m.setAttribute("dy",`${d*i}em`),m.textContent=u[p],this.appendChild(m),d=0}}else h&&this.setAttribute("y",`${h*i}em`),this.textContent=u[0];if(a&&!r&&u[0]!==n[c]){const d=this.ownerDocument.createElementNS(Ne.svg,"title");d.textContent=n[c],this.appendChild(d)}})}function un(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new Gr(t,{...r,x:e,y:n})}function Zc(t,{x:e=D,...n}={}){return new Gr(t,Pc({...n,x:e}))}function Kc(t,{y:e=D,...n}={}){return new Gr(t,Yc({...n,y:e}))}function Qc(t,e,n){q(t,"text-anchor",e.textAnchor),q(t,"font-family",e.fontFamily),q(t,"font-size",e.fontSize),q(t,"font-style",e.fontStyle),q(t,"font-variant",e.fontVariant===void 0?f0(n):e.fontVariant),q(t,"font-weight",e.fontWeight)}function f0(t){return t&&(en(t)||At(t))?"tabular-nums":void 0}const h0=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function d0(t){return t==null||typeof t=="number"?[void 0,t]:typeof t!="string"?[t,void 0]:(t=t.trim().toLowerCase(),h0.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}function p0(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of m0(t)){if(o===void 0&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===Hc?"-":"")),o=a),s){r.push(t.slice(o,l)),o=void 0;continue}i=l}return r}function*m0(t){let e=0,n=0;const r=t.length;for(;n<r;){let o=1;switch(t[n]){case Hc:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];t[++n]===" ";);e=n;break;case"\r":t[n+1]===`
`&&++o;case`
`:yield[e,n,!0],n+=o,e=n;break;default:++n;break}}yield[e,n,!0]}const Jc={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"\u2018":31,"\u2019":31,"\u201C":47,"\u201D":47,"\u2026":82};function Hi(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=dn(t,o))r+=Jc[t[o]]??(au(t,o)?120:Jc.e);return r}function Ui(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=dn(t,o))r+=au(t,o)?126:63;return r}function tu({monospace:t,lineWidth:e,textOverflow:n}){if(n!=null||e==1/0)return i=>i.split(/\r\n?|\n/g);const r=t?Ui:Hi,o=e*100;return i=>p0(i,o,r)}function eu({monospace:t,lineWidth:e,textOverflow:n}){if(n==null||e==1/0)return i=>i;const r=t?Ui:Hi,o=e*100;switch(n){case"clip-start":return i=>ru(i,o,r,"");case"clip-end":return i=>nu(i,o,r,"");case"ellipsis-start":return i=>ru(i,o,r,fn);case"ellipsis-middle":return i=>y0(i,o,r,fn);case"ellipsis-end":return i=>nu(i,o,r,fn)}}const fn="\u2026";function hn(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=dn(t,a);const c=n(t,a,l);if(i+c>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=c,o.push(a)}return[-1,0]}function nu(t,e,n,r){t=t.trim();const o=n(r),[i]=hn(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function y0(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=hn(t,e/2,n,i),[s]=hn(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(dn(t,s)).trimStart()}function ru(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r),[a]=hn(t,o-e+i,n,-i);return a<0?r:r+t.slice(dn(t,a)).trimStart()}const Zi=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,ou=new RegExp("\\p{Extended_Pictographic}","uy");function dn(t,e){return e+=g0(t,e)?2:1,v0(t,e)&&(e=Zi.lastIndex),$0(t,e)?dn(t,e+1):e}function iu(t,e){return t.charCodeAt(e)<128}function g0(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const r=t.charCodeAt(e+1);return r>=56320&&r<57344}return!1}function $0(t,e){return t.charCodeAt(e)===8205}function v0(t,e){return iu(t,e)?!1:(Zi.lastIndex=e,Zi.test(t))}function au(t,e){return iu(t,e)?!1:(ou.lastIndex=e,ou.test(t))}const lu={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},su=3.5,x0=su*5,cu={draw(t,e,n){const r=e*n/x0;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},uu={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},w0=new Map([["arrow",cu],["spike",uu]]);function b0(t){return t&&typeof t.draw=="function"}function k0(t){if(b0(t))return t;const e=w0.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}let Vr=class extends et{constructor(e,n={}){const{x:r,y:o,r:i=su,length:a,rotate:l,shape:s=cu,anchor:c="middle",frameAnchor:u}=n,[f,h]=ht(a,12),[d,p]=ht(l,0);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},length:{value:f,scale:"length",optional:!0},rotate:{value:d,optional:!0}},n,lu),this.r=+i,this.length=h,this.rotate=p,this.shape=k0(s),this.anchor=Ot(c,"anchor",["start","middle","end"]),this.frameAnchor=jn(u)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:$}=this,[y,g]=Ht(this,o);return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(x=>x.selectAll().data(e).enter().append("path").call(Q,this).attr("transform",cn`translate(${s?v=>s[v]:y},${c?v=>c[v]:g})${f?v=>` rotate(${f[v]})`:d?` rotate(${d})`:""}${p==="start"?"":p==="end"?u?v=>` translate(0,${u[v]})`:` translate(0,${h})`:u?v=>` translate(0,${u[v]/2})`:` translate(0,${h/2})`}`).attr("d",u?v=>{const b=Qt();return m.draw(b,u[v],$),b}:(()=>{const v=Qt();return m.draw(v,h,$),v})()).call(ut,this,r)).node()}};function fu(t,e={}){let{x:n,y:r,...o}=e;return e.frameAnchor===void 0&&([n,r]=Wt(n,r)),new Vr(t,{...o,x:n,y:r})}function hu(t,e={}){const{x:n=D,...r}=e;return new Vr(t,{...r,x:n})}function du(t,e={}){const{y:n=D,...r}=e;return new Vr(t,{...r,y:n})}function M0(t,e={}){const{shape:n=uu,stroke:r=lu.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return fu(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})}function ke(t,e){return arguments.length<2&&!oe(t)&&(e=t,t=null),e===void 0&&(e={}),[t,e]}function Hr({anchor:t}={},e){return t===void 0?e[0]:Ot(t,"anchor",e)}function pu(t){return Hr(t,["left","right"])}function mu(t){return Hr(t,["right","left"])}function yu(t){return Hr(t,["bottom","top"])}function gu(t){return Hr(t,["top","bottom"])}function Ki(){const[t,e]=ke(...arguments);return xu("y",pu(e),t,e)}function $u(){const[t,e]=ke(...arguments);return xu("fy",mu(e),t,e)}function Qi(){const[t,e]=ke(...arguments);return wu("x",yu(e),t,e)}function vu(){const[t,e]=ke(...arguments);return wu("fx",gu(e),t,e)}function xu(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=t==="y"?6:0,tickPadding:m,tickRotate:$,x:y,margin:g,marginTop:x=g===void 0?20:g,marginRight:v=g===void 0?e==="right"?40:0:g,marginBottom:b=g===void 0?20:g,marginLeft:w=g===void 0?e==="left"?40:0:g,label:k,labelAnchor:M,labelArrow:A,labelOffset:z,...S}){return p=rt(p),m=rt(m),$=rt($),M!==void 0&&(M=Ot(M,"labelAnchor",["center","top","bottom"])),A=Ru(A),It(p&&!lt(i)?A0(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:$,x:y,...S}):null,lt(s)?null:z0(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:$,x:y,marginTop:x,marginRight:v,marginBottom:b,marginLeft:w,...S}),!lt(s)&&k!==null?un([],Eu({fill:s,fillOpacity:c,...S},function(L,C,E,O,R){const N=O[t],{marginTop:F,marginRight:T,marginBottom:B,marginLeft:j}=t==="y"&&R.inset||R,I=M??(N.bandwidth?"center":"top"),Y=z??(e==="right"?T:j)-3;return I==="center"?(this.textAnchor=void 0,this.lineAnchor=e==="right"?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor=e==="right"?"end":"start",this.lineAnchor=I,this.frameAnchor=`${I}-${e}`,this.rotate=0),this.dy=I==="top"?3-F:I==="bottom"?B-3:0,this.dx=e==="right"?Y:-Y,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Nu(t,N,{anchor:e,label:k,labelAnchor:I,labelArrow:A})]}}}})):null)}function wu(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=t==="x"?6:0,tickPadding:m,tickRotate:$,y,margin:g,marginTop:x=g===void 0?e==="top"?30:0:g,marginRight:v=g===void 0?20:g,marginBottom:b=g===void 0?e==="bottom"?30:0:g,marginLeft:w=g===void 0?20:g,label:k,labelAnchor:M,labelArrow:A,labelOffset:z,...S}){return p=rt(p),m=rt(m),$=rt($),M!==void 0&&(M=Ot(M,"labelAnchor",["center","left","right"])),A=Ru(A),It(p&&!lt(i)?L0(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:$,y,...S}):null,lt(s)?null:S0(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:$,y,marginTop:x,marginRight:v,marginBottom:b,marginLeft:w,...S}),!lt(s)&&k!==null?un([],Eu({fill:s,fillOpacity:c,...S},function(L,C,E,O,R){const N=O[t],{marginTop:F,marginRight:T,marginBottom:B,marginLeft:j}=t==="x"&&R.inset||R,I=M??(N.bandwidth?"center":"right"),Y=z??(e==="top"?F:B)-3;return I==="center"?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${I}`,this.textAnchor=I==="right"?"end":"start"),this.lineAnchor=e,this.dy=e==="top"?-Y:Y,this.dx=I==="right"?T-3:I==="left"?3-j:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Nu(t,N,{anchor:e,label:k,labelAnchor:I,labelArrow:A})]}}}})):null)}function A0(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+(t==="y"?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=t==="y"?void 0:null,...p}){return pn(du,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:e==="left"?+h-wt+ +u:+h+wt-f,anchor:"start",length:s,shape:e==="left"?N0:R0})}function L0(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+(t==="x"?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=t==="x"?void 0:null,...p}){return pn(hu,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:e==="bottom"?+h-wt-f:+h+wt+ +u,anchor:"start",length:s,shape:e==="bottom"?O0:C0})}function z0(t,e,n,{facetAnchor:r=e+(t==="y"?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*Xr):0),text:s,textAnchor:c=Math.abs(a)>60?"middle":e==="left"?"end":"start",lineAnchor:u=a>60?"top":a<-60?"bottom":"middle",fontVariant:f,inset:h=0,insetLeft:d=h,insetRight:p=h,dx:m=0,y:$=t==="y"?void 0:null,...y}){return pn(Kc,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,y:$,...y,dx:e==="left"?+m-i-l+ +d:+m+ +i+ +l-p},function(g,x,v,b,w){f===void 0&&(this.fontVariant=Cu(g)),s===void 0&&(w.text=Ou(g,x,v,b,e))})}function S0(t,e,n,{facetAnchor:r=e+(t==="x"?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*Xr):0),text:s,textAnchor:c=Math.abs(a)>=10?a<0^e==="bottom"?"start":"end":"middle",lineAnchor:u=Math.abs(a)>=10?"middle":e==="bottom"?"top":"bottom",fontVariant:f,inset:h=0,insetTop:d=h,insetBottom:p=h,dy:m=0,x:$=t==="x"?void 0:null,...y}){return pn(Zc,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:s===void 0?null:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,x:$,...y,dy:e==="bottom"?+m+ +i+ +l-p:+m-i-l+ +d},function(g,x,v,b,w){f===void 0&&(this.fontVariant=Cu(g)),s===void 0&&(w.text=Ou(g,x,v,b,e))})}function bu(){const[t,e]=ke(...arguments);return Lu("y",pu(e),t,e)}function ku(){const[t,e]=ke(...arguments);return Lu("fy",mu(e),t,e)}function Mu(){const[t,e]=ke(...arguments);return zu("x",yu(e),t,e)}function Au(){const[t,e]=ke(...arguments);return zu("fx",gu(e),t,e)}function Lu(t,e,n,{y:r=t==="y"?void 0:null,x:o=null,x1:i=e==="left"?o:null,x2:a=e==="right"?o:null,...l}){return pn(be,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{y:r,x1:i,x2:a,...Su(l)})}function zu(t,e,n,{x:r=t==="x"?void 0:null,y:o=null,y1:i=e==="top"?o:null,y2:a=e==="bottom"?o:null,...l}){return pn(we,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{x:r,y1:i,y2:a,...Su(l)})}function Su({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function Eu({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u=!1},f){return[,t]=Mt(t),[,e]=ht(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u,initializer:f}}function pn(t,e,n,r,o,i){let a;function l(u,f,h,d,p,m){const $=u==null&&(e==="fx"||e==="fy"),{[e]:y}=d;if(!y)throw new Error(`missing scale: ${e}`);const g=y.domain();let{interval:x,ticks:v,tickFormat:b,tickSpacing:w=e==="x"?80:35}=o;if(typeof v=="string"&&Tu(y)&&(x=v,v=void 0),v===void 0&&(v=Qe(x,y.type)??E0(y,w)),u==null){if(oe(v))u=ee(v);else if(Je(v))u=ta(v,...yt(g));else if(y.interval){let M=y.interval;if(y.ticks){const[A,z]=yt(g),S=(z-A)/M[Cn];M=rs(M,S/v)??M,u=ta(M,A,z)}else{u=g;const A=u.length;M=rs(M,A/v)??M,M!==y.interval&&(u=ta(M,...yt(u)))}if(M===y.interval){const A=Math.round(u.length/v);A>1&&(u=u.filter((z,S)=>S%A===0))}}else y.ticks?u=y.ticks(v):u=g;if(!y.ticks&&u.length&&u!==g){const M=new zn(g);u=u.filter(A=>M.has(A)),u.length||ce(`Warning: the ${e}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}e==="y"||e==="x"?f=[ne(u)]:a[e]={scale:e,value:D}}i?.call(this,y,u,v,b,a);const k=Object.fromEntries(Object.entries(a).map(([M,A])=>[M,{...A,value:V(u,A.value)}]));return $&&(f=m.filterFacets(u,k)),{data:u,facets:f,channels:k}}const s=Lt(o).initializer,c=t(n,Lt({...o,initializer:l},s));return n==null?(a=c.channels,c.channels={}):a={},r!==void 0&&Object.assign(c,r),c.clip===void 0&&(c.clip=!1),c}function E0(t,e){const[n,r]=yt(t.range());return(r-n)/e}function Ou(t,e,n,r,o){return{value:Ji(t,e,n,r,o)}}function Ji(t,e,n,r,o){return typeof r=="function"&&!(t.type==="log"&&t.tickFormat)?r:r===void 0&&e&&At(e)?Im(t.type,e,o)??an:t.tickFormat?t.tickFormat(typeof n=="number"?n:null,r):r===void 0?an:typeof r=="string"?(At(t.domain())?zo:To)(r):xt(r)}function ta(t,e,n){return t.range(e,t.offset(t.floor(n)))}const O0={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},C0={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},N0={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},R0={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function Cu(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function Nu(t,e,{anchor:n,label:r=e.label,labelAnchor:o,labelArrow:i}={}){if(!(r==null||r.inferred&&Tu(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),i==="auto"&&(i=(!e.bandwidth||e.interval)&&!/[]/.test(r)),!i)return r;if(i===!0){const a=ac(e);a&&(i=/x$/.test(t)||o==="center"?/x$/.test(t)===a<0?"left":"right":a<0?"up":"down")}switch(i){case"left":return`\u2190 ${r}`;case"right":return`${r} \u2192`;case"up":return n==="right"?`${r} \u2191`:`\u2191 ${r}`;case"down":return n==="right"?`${r} \u2193`:`\u2193 ${r}`}return r}}function Ru(t="auto"){return lt(t)?!1:typeof t=="boolean"?t:Ot(t,"labelArrow",["auto","up","right","down","left"])}function Tu(t){return At(t.domain())}function Iu(t,e){if(e==null)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function T0(t,{opacity:e,...n}={}){if(!We(t)&&!mc(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Bu(t,n,(r,o,i,a)=>r.append("svg").attr("width",i).attr("height",a).attr("fill",o.scale).attr("fill-opacity",ht(e)[1]).append("rect").attr("width","100%").attr("height","100%"))}function I0(t,{fill:e=t.hint?.fill!==void 0?t.hint.fill:"none",fillOpacity:n=1,stroke:r=t.hint?.stroke!==void 0?t.hint.stroke:lt(e)?"currentColor":"none",strokeOpacity:o=1,strokeWidth:i=1.5,r:a=4.5,...l}={},s){const[c,u]=Mt(e),[f,h]=Mt(r),d=Iu(s,c),p=Iu(s,f),m=a*a*Math.PI;return n=ht(n)[1],o=ht(o)[1],i=ht(i)[1],Bu(t,l,($,y,g,x)=>$.append("svg").attr("viewBox","-8 -8 16 16").attr("width",g).attr("height",x).attr("fill",c==="color"?v=>d.scale(v):u).attr("fill-opacity",n).attr("stroke",f==="color"?v=>p.scale(v):h).attr("stroke-opacity",o).attr("stroke-width",i).append("path").attr("d",v=>{const b=Qt();return t.scale(v).draw(b,m),b}))}function Bu(t,e={},n){let{columns:r,tickFormat:o,fontVariant:i=Nc(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=e;const d=Dr(e);u=Yr(u),o=Ji(t.scale,t.domain,void 0,o);const p=U("div",d).attr("class",`${u}-swatches ${u}-swatches-${r!=null?"columns":"wrap"}`);let m;return r!=null?(m=`:where(.${u}-swatches-columns .${u}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${u}-swatches-columns .${u}-swatch::before) {
  flex-shrink: 0;
}
:where(.${u}-swatches-columns .${u}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,t,l,s).call($=>$.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o))):(m=`:where(.${u}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${u}-swatches-wrap .${u}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,t,l,s).append(function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))})),p.call($=>$.insert("style","*").text(`:where(.${u}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${u}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${m}`)).style("margin-left",c?`${+c}px`:null).style("width",h===void 0?null:`${+h}px`).style("font-variant",pt(i,"normal")).call(Fi,f).node()}const Ur=new Map([["symbol",I0],["color",Wu],["opacity",j0]]);function B0(t={}){for(const[e,n]of Ur){const r=t[e];if(Te(r)){const o=Dr(t);let i;if(e==="symbol"){const{fill:a,stroke:l=a===void 0&&Te(t.color)?"color":void 0}=t;i={fill:a,stroke:l}}return n(Li(e,r,i),ea(o,r,t),a=>Te(t[a])?Li(a,t[a]):null)}}throw new Error("unknown legend type; no scale found")}function W0(t,e,n={}){return(r,o)=>{if(!Ur.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Ur.get(r)(t[r],ea(e,n[r],o),i=>t[i])}}function ea({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return Km(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function Wu(t,{legend:e=!0,...n}){if(e===!0&&(e=t.type==="ordinal"?"swatches":"ramp"),t.domain!==void 0)switch(`${e}`.toLowerCase()){case"swatches":return T0(t,n);case"ramp":return r0(t,n);default:throw new Error(`unknown legend type: ${e}`)}}function j0({type:t,interpolate:e,...n},{legend:r=!0,color:o=On(0,0,0),...i}){if(!e)throw new Error(`${t} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return Wu({type:t,...n,interpolate:F0(o)},{legend:r,...i})}function F0(t){const{r:e,g:n,b:r}=On(t)||On(0,0,0);return o=>`rgba(${e},${n},${r},${o})`}function D0(t,e,n){const r=[];for(const[o,i]of Ur){const a=n[o];if(a?.legend&&o in t){const l=i(t[o],ea(e,t[o],a),s=>t[s]);l!=null&&r.push(l)}}return r}function Zr(t={}){return ds(t)?t:{...t,x:D}}function Kr(t={}){return ps(t)?t:{...t,y:D}}function ju(t,e){if(e.length===1)return{data:t,facets:e};const n=Bn(t),r=new Uint8Array(n);let o=0;for(const l of e)for(const s of l)r[s]&&++o,r[s]=1;if(o===0)return{data:t,facets:e};t=In(t);const i=t[ls]=new Uint32Array(n+o);e=e.map(l=>In(l,Uint32Array));let a=n;r.fill(0);for(const l of e)for(let s=0,c=l.length;s<c;++s){const u=l[s];r[u]?(l[s]=a,t[a]=t[u],i[a]=u,++a):i[u]=u,r[u]=1}return{data:t,facets:e}}function Fu(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=yn(r,o,"y","x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:Lr(s,c)}}function q0(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=yn(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}}function Y0(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=yn(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}}function Du(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=yn(r,o,"x","y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:Lr(s,c)}}function P0(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=yn(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}}function X0(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=yn(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}}function Qr({x:t,x1:e,x2:n,...r}={}){return r=je(r,"y"),e===void 0&&n===void 0?Fu({x:t,...r}):([e,n]=ms(t,e,n),{...r,x1:e,x2:n})}function Jr({y:t,y1:e,y2:n,...r}={}){return r=je(r,"x"),e===void 0&&n===void 0?Du({y:t,...r}):([e,n]=ms(t,e,n),{...r,y1:e,y2:n})}function mn(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const _0={length:!0};function yn(t,e=Vo,n,r,{offset:o,order:i,reverse:a},l){if(e===null)throw new Error(`stack requires ${r}`);const s=$e(l),[c,u]=Et(t),[f,h]=Ct(e),[d,p]=Ct(e);return f.hint=d.hint=_0,o=G0(o),i=U0(i,o,r),[jt(l,(m,$,y)=>{({data:m,facets:$}=ju(m,$));const g=t==null?void 0:u(zr(V(m,t),y?.[n])),x=V(m,e,Float64Array),v=V(m,s),b=i&&i(m,g,x,v),w=Bn(m),k=h(new Float64Array(w)),M=p(new Float64Array(w)),A=[];for(const z of $){const S=g?Array.from(Ce(z,L=>g[L]).values()):[z];if(b)for(const L of S)L.sort(b);for(const L of S){let C=0,E=0;a&&L.reverse();for(const O of L){const R=x[O];R<0?C=M[O]=(k[O]=C)+R:R>0?E=M[O]=(k[O]=E)+R:M[O]=k[O]=E}}A.push(S)}return o&&o(A,k,M,v),{data:m,facets:$}}),c,f,d]}function G0(t){if(t!=null){if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return V0;case"center":case"silhouette":return H0;case"wiggle":return Yu}throw new Error(`unknown offset: ${t}`)}}function qu(t,e){let n=0,r=0;for(const o of t){const i=e[o];i<n&&(n=i),i>r&&(r=i)}return[n,r]}function V0(t,e,n){for(const r of t)for(const o of r){const[i,a]=qu(o,n);for(const l of o){const s=1/(a-i||1);e[l]=s*(e[l]-i),n[l]=s*(n[l]-i)}}}function H0(t,e,n){for(const r of t){for(const o of r){const[i,a]=qu(o,n);for(const l of o){const s=(a+i)/2;e[l]-=s,n[l]-=s}}Pu(r,e,n)}Xu(t,e,n)}function Yu(t,e,n,r){for(const o of t){const i=new Ro;let a=0;for(const l of o){let s=-1;const c=l.map(d=>Math.abs(n[d]-e[d])),u=l.map(d=>{s=r?r[d]:++s;const p=n[d]-e[d],m=i.has(s)?p-i.get(s):0;return i.set(s,p),m}),f=[0,...Zp(u)];for(const d of l)e[d]+=a,n[d]+=a;const h=qt(c);h&&(a-=qt(c,(d,p)=>(u[p]/2+f[p])*d)/h)}Pu(o,e,n)}Xu(t,e,n)}function Pu(t,e,n){const r=Nt(t,o=>Nt(o,i=>e[i]));for(const o of t)for(const i of o)e[i]-=r,n[i]-=r}function Xu(t,e,n){const r=t.length;if(r===1)return;const o=t.map(l=>l.flat()),i=o.map(l=>(Nt(l,s=>e[s])+zt(l,s=>n[s]))/2),a=Nt(i);for(let l=0;l<r;l++){const s=a-i[l];for(const c of o[l])e[c]+=s,n[c]+=s}}function U0(t,e,n){if(t===void 0&&e===Yu)return _u(Rt);if(t!=null){if(typeof t=="string"){const r=t.startsWith("-"),o=r?gr:Rt;switch((r?t.slice(1):t).toLowerCase()){case"value":case n:return Z0(o);case"z":return K0(o);case"sum":return Q0(o);case"appearance":return J0(o);case"inside-out":return _u(o)}return Gu(cs(t))}if(typeof t=="function")return(t.length===1?Gu:t$)(t);if(te(t))return e$(t);throw new Error(`invalid order: ${t}`)}}function Z0(t){return(e,n,r)=>(o,i)=>t(r[o],r[i])}function K0(t){return(e,n,r,o)=>(i,a)=>t(o[i],o[a])}function Q0(t){return to(t,(e,n,r,o)=>Io(ne(e),i=>qt(i,a=>r[a]),i=>o[i]))}function J0(t){return to(t,(e,n,r,o)=>Io(ne(e),i=>n[Bo(i,a=>r[a])],i=>o[i]))}function _u(t){return to(t,(e,n,r,o)=>{const i=ne(e),a=Io(i,f=>n[Bo(f,h=>r[h])],f=>o[f]),l=Ln(i,f=>qt(f,h=>r[h]),f=>o[f]),s=[],c=[];let u=0;for(const f of a)u<0?(u+=l.get(f),s.push(f)):(u-=l.get(f),c.push(f));return c.reverse().concat(s)})}function Gu(t){return e=>{const n=V(e,t);return(r,o)=>Rt(n[r],n[o])}}function t$(t){return e=>te(e)?(n,r)=>t(e[n],e[r]):(n,r)=>t(e.get(n),e.get(r))}function e$(t){return to(Rt,()=>t)}function to(t,e){return(n,r,o,i)=>{if(!i)throw new Error("missing channel: z");const a=new Ro(e(n,r,o,i).map((l,s)=>[l,s]));return(l,s)=>t(a.get(i[l]),a.get(i[s]))}}const n$={ariaLabel:"rect"};let eo=class extends et{constructor(e,n={}){const{x1:r,y1:o,x2:i,y2:a}=n;super(e,{x1:{value:r,scale:"x",type:r!=null&&i==null?"band":void 0,optional:!0},y1:{value:o,scale:"y",type:o!=null&&a==null?"band":void 0,optional:!0},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,n$),na(this,n),ra(this,n)}render(e,n,r,o,i){const{x:a,y:l}=n;let{x1:s,y1:c,x2:u,y2:f}=r;const{marginTop:h,marginRight:d,marginBottom:p,marginLeft:m,width:$,height:y}=o,{projection:g}=i,{insetTop:x,insetRight:v,insetBottom:b,insetLeft:w}=this,{rx:k,ry:M,rx1y1:A,rx1y2:z,rx2y1:S,rx2y2:L}=this;(s||u)&&!g&&Vt(a)&&(s=u=null),(c||f)&&!g&&Vt(l)&&(c=f=null);const C=a?.bandwidth?a.bandwidth():0,E=l?.bandwidth?l.bandwidth():0;return U("svg:g",i).call(ot,this,o,i).call(tt,this,{},0,0).call(O=>O.selectAll().data(e).enter().call(A||z||S||L?R=>R.append("path").call(Q,this).call(oa,s&&u?N=>s[N]+(u[N]<s[N]?-v:w):s?N=>s[N]+w:m+w,c&&f?N=>c[N]+(f[N]<c[N]?-b:x):c?N=>c[N]+x:h+x,s&&u?N=>u[N]-(u[N]<s[N]?-w:v):s?N=>s[N]+C-v:$-d-v,c&&f?N=>f[N]-(f[N]<c[N]?-x:b):c?N=>c[N]+E-b:y-p-b,this).call(ut,this,r):R=>R.append("rect").call(Q,this).attr("x",s?u?N=>Math.min(s[N],u[N])+w:N=>s[N]+w:m+w).attr("y",c?f?N=>Math.min(c[N],f[N])+x:N=>c[N]+x:h+x).attr("width",s?u?N=>Math.max(0,Math.abs(u[N]-s[N])+C-w-v):C-w-v:$-d-m-v-w).attr("height",c?f?N=>Math.max(0,Math.abs(c[N]-f[N])+E-x-b):E-x-b:y-h-p-x-b).call(q,"rx",k).call(q,"ry",M).call(ut,this,r))).node()}};function na(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:o=e,insetLeft:i=e}={}){t.insetTop=rt(n),t.insetRight=rt(r),t.insetBottom=rt(o),t.insetLeft=rt(i)}function ra(t,{r:e,rx:n,ry:r,rx1:o=e,ry1:i=e,rx2:a=e,ry2:l=e,rx1y1:s=o!==void 0?+o:i!==void 0?+i:0,rx1y2:c=o!==void 0?+o:l!==void 0?+l:0,rx2y1:u=a!==void 0?+a:i!==void 0?+i:0,rx2y2:f=a!==void 0?+a:l!==void 0?+l:0}={}){s||c||u||f?(t.rx1y1=s,t.rx1y2=c,t.rx2y1=u,t.rx2y2=f):(t.rx=pt(n,"auto"),t.ry=pt(r,"auto"))}function oa(t,e,n,r,o,i){const{rx1y1:a,rx1y2:l,rx2y1:s,rx2y2:c}=i;typeof e!="function"&&(e=xt(e)),typeof n!="function"&&(n=xt(n)),typeof r!="function"&&(r=xt(r)),typeof o!="function"&&(o=xt(o));const u=Math.max(Math.abs(a+s),Math.abs(l+c)),f=Math.max(Math.abs(a+l),Math.abs(s+c));t.attr("d",h=>{const d=e(h),p=n(h),m=r(h),$=o(h),y=d>m,g=p>$,x=y?m:d,v=y?d:m,b=g?$:p,w=g?p:$,k=Math.min(1,(v-x)/u,(w-b)/f),M=k*(y?g?c:s:g?l:a),A=k*(y?g?l:a:g?c:s),z=k*(y?g?a:l:g?s:c),S=k*(y?g?s:c:g?a:l);return`M${x},${b+ro(M,S)}A${M},${M} 0 0 ${M<0?0:1} ${x+no(M,S)},${b}H${v-no(A,z)}A${A},${A} 0 0 ${A<0?0:1} ${v},${b+ro(A,z)}V${w-ro(z,A)}A${z},${z} 0 0 ${z<0?0:1} ${v-no(z,A)},${w}H${x+no(S,M)}A${S},${S} 0 0 ${S<0?0:1} ${x},${w-ro(S,M)}Z`})}function no(t,e){return e<0?t:Math.abs(t)}function ro(t,e){return e<0?Math.abs(t):t}function ia(t,e){return new eo(t,Dc(qc(e)))}function oo(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D,interval:1}),new eo(t,Qr(qc(Zr(e))))}function io(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D,interval:1}),new eo(t,Jr(Dc(Kr(e))))}const r$={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},o$={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};let Vu=class extends et{constructor(e={}){const{anchor:n=null}=e;super(Rn,void 0,e,n==null?r$:o$),this.anchor=hs(n,"anchor",["top","right","bottom","left"]),na(this,e),n||ra(this,e)}render(e,n,r,o,i){const{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=o,{anchor:h,insetTop:d,insetRight:p,insetBottom:m,insetLeft:$}=this,{rx:y,ry:g,rx1y1:x,rx1y2:v,rx2y1:b,rx2y2:w}=this,k=c+$,M=u-l-p,A=a+d,z=f-s-m;return U(h?"svg:line":x||v||b||w?"svg:path":"svg:rect",i).datum(0).call(ot,this,o,i).call(Q,this).call(ut,this,r).call(tt,this,{}).call(h==="left"?S=>S.attr("x1",k).attr("x2",k).attr("y1",A).attr("y2",z):h==="right"?S=>S.attr("x1",M).attr("x2",M).attr("y1",A).attr("y2",z):h==="top"?S=>S.attr("x1",k).attr("x2",M).attr("y1",A).attr("y2",A):h==="bottom"?S=>S.attr("x1",k).attr("x2",M).attr("y1",z).attr("y2",z):x||v||b||w?S=>S.call(oa,k,A,M,z,this):S=>S.attr("x",k).attr("y",A).attr("width",M-k).attr("height",z-A).attr("rx",y).attr("ry",g)).node()}};function aa(t){return new Vu(t)}const la={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},i$=new Set(["geometry","href","src","ariaLabel","scales"]);let Hu=class extends et{constructor(e,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&oe(e)&&vs(e)&&(n={...n,title:D});const{x:r,y:o,x1:i,x2:a,y1:l,y2:s,anchor:c,preferredAnchor:u="bottom",monospace:f,fontFamily:h=f?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:p,fontVariant:m,fontWeight:$,lineHeight:y=1,lineWidth:g=20,frameAnchor:x,format:v,textAnchor:b="start",textOverflow:w,textPadding:k=8,title:M,pointerSize:A=12,pathFilter:z="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(e,{x:{value:i!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:l!=null&&s!=null?null:o,scale:"y",optional:!0},x1:{value:i,scale:"x",optional:a==null},y1:{value:l,scale:"y",optional:s==null},x2:{value:a,scale:"x",optional:i==null},y2:{value:s,scale:"y",optional:l==null},title:{value:M,optional:!0}},n,la),this.anchor=Qo(c,"anchor"),this.preferredAnchor=Qo(u,"preferredAnchor"),this.frameAnchor=jn(x),this.textAnchor=pt(b,"middle"),this.textPadding=+k,this.pointerSize=+A,this.pathFilter=kt(z),this.lineHeight=+y,this.lineWidth=+g,this.textOverflow=Uc(w),this.monospace=!!f,this.fontFamily=kt(h),this.fontSize=rt(d),this.fontStyle=kt(p),this.fontVariant=kt(m),this.fontWeight=kt($);for(const S in la)S in this.channels&&(this[S]=la[S]);this.splitLines=tu(this),this.clipLine=eu(this),this.format=typeof v=="string"||typeof v=="function"?{title:v}:{...v}}render(e,n,r,o,i){const a=this,{x:l,y:s,fx:c,fy:u}=n,{ownerSVGElement:f,document:h}=i,{anchor:d,monospace:p,lineHeight:m,lineWidth:$}=this,{textPadding:y,pointerSize:g,pathFilter:x}=this,{marginTop:v,marginLeft:b}=o,{x1:w,y1:k,x2:M,y2:A,x:z=w??M,y:S=k??A}=r,L=c?c(e.fx)-b:0,C=u?u(e.fy)-v:0,[E,O]=Ht(this,o),R=Oc(r,E),N=Cc(r,O),F=p?Ui:Hi,T=F(fn);let B,j;"title"in r?(B=Zu.call(this,{title:r.channels.title},n),j=c$):(B=Zu.call(this,r.channels,n),j=u$);const I=U("svg:g",i).call(ot,this,o,i).call(Qc,this).call(tt,this,{x:z&&l,y:S&&s}).call(G=>G.selectAll().data(e).enter().append("g").attr("transform",X=>`translate(${Math.round(R(X))},${Math.round(N(X))})`).call(Q,this).call(X=>X.append("path").attr("filter",x)).call(X=>X.append("text").each(function(W){const P=de(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const _=j.call(a,W,e,B,n,r);if(typeof _=="string")for(const Z of a.splitLines(_))Y(P,{value:a.clipLine(Z)});else{const Z=new Set;for(const K of _){const{label:nt=""}=K;nt&&Z.has(nt)||(Z.add(nt),Y(P,K))}}})));function Y(G,{label:X,value:W,color:P,opacity:_}){X??="",W??="";const Z=P!=null||_!=null;let K,nt=$*100;const[ft]=hn(X,nt,F,T);if(ft>=0)X=X.slice(0,ft).trimEnd()+fn,K=W.trim(),W="";else{(X||!W&&!Z)&&(W=" "+W);const[dt]=hn(W,nt-F(X),F,T);dt>=0&&(K=W.trim(),W=W.slice(0,dt).trimEnd()+fn)}const at=G.append("tspan").attr("x",0).attr("dy",`${m}em`).text("\u200B");X&&at.append("tspan").attr("font-weight","bold").text(X),W&&at.append(()=>h.createTextNode(W)),Z&&at.append("tspan").text(" \u25A0").attr("fill",P).attr("fill-opacity",_).style("user-select","none"),K&&at.append("title").text(K)}function H(){const{width:G,height:X}=o.facet??o;I.selectChildren().each(function(W){let{x:P,width:_,height:Z}=this.getBBox();_=Math.round(_),Z=Math.round(Z);let K=d;if(K===void 0){const at=R(W)+L,dt=N(W)+C,mt=at+_+g+y*2<G,bt=at-_-g-y*2>0,Ee=dt+Z+g+y*2<X,Oe=dt-Z-g-y*2>0;K=mt&&bt?Ee&&Oe?a.preferredAnchor:Oe?"bottom":"top":Ee&&Oe?mt?"left":"right":(mt||bt)&&(Ee||Oe)?`${Oe?"bottom":"top"}-${mt?"left":"right"}`:a.preferredAnchor}const nt=this.firstChild,ft=this.lastChild;if(nt.setAttribute("d",s$(K,g,y,_,Z)),P)for(const at of ft.childNodes)at.setAttribute("x",-P);ft.setAttribute("y",`${+a$(K,ft.childNodes.length,m).toFixed(6)}em`),ft.setAttribute("transform",`translate(${l$(K,g,y,_,Z)})`)}),I.attr("visibility",null)}return e.length&&(I.attr("visibility","hidden"),f.isConnected?Promise.resolve().then(H):typeof requestAnimationFrame<"u"&&requestAnimationFrame(H)),I.node()}};function Uu(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new Hu(t,{...r,x:e,y:n})}function a$(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}function l$(t,e,n,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,o/2]}}function s$(t,e,n,r,o){const i=r+n*2,a=o+n*2;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${e},${e}h${i-e}v${a}h${-i}z`;case"top":return`M0,0l${e/2},${e/2}h${(i-e)/2}v${a}h${-i}v${-a}h${(i-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-i}v${a}h${i}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-i}v${a}h${i}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${i-e}v${-a}h${-i}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(i-e)/2}v${-a}h${-i}v${a}h${(i-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-i}v${-a}h${i}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${i}v${a}h${-i}v${e/2-a/2}z`}}function Zu(t,e){const n={};let r=this.format;r=Ku(r,t,"x"),r=Ku(r,t,"y"),this.format=r;for(const o in r){const i=r[o];if(!(i===null||i===!1))if(o==="fx"||o==="fy")n[o]=!0;else{const a=gi(t,o);a&&(n[o]=a)}}for(const o in t){if(o in n||o in r||i$.has(o)||(o==="x"||o==="y")&&t.geometry)continue;const i=gi(t,o);if(i){if(i.scale==null&&i.defaultScale==="color")continue;n[o]=i}}this.facet&&(e.fx&&!("fx"in r)&&(n.fx=!0),e.fy&&!("fy"in r)&&(n.fy=!0));for(const o in n){const i=this.format[o];if(typeof i=="string"){const a=n[o]?.value??e[o]?.domain()??[];this.format[o]=(At(a)?zo:To)(i)}else if(i===void 0||i===!0){const a=e[o];this.format[o]=a?.bandwidth?Ji(a,a.domain()):an}}return n}function Ku(t,e,n){if(!(n in t))return t;const r=`${n}1`,o=`${n}2`;if((r in t||!(r in e))&&(o in t||!(o in e)))return t;const i=Object.entries(t),a=t[n];return i.splice(i.findIndex(([l])=>l===n)+1,0,[r,a],[o,a]),Object.fromEntries(i)}function c$(t,e,{title:n}){return this.format.title(n.value[t],t)}function*u$(t,e,n,r,o){for(const i in n){if(i==="fx"||i==="fy"){yield{label:ao(r,n,i),value:this.format[i](e[i],t)};continue}if(i==="x1"&&"x2"in n||i==="y1"&&"y2"in n)continue;const a=n[i];if(i==="x2"&&"x1"in n)yield{label:Ju(r,n,"x"),value:Qu(this.format.x2,n.x1,a,t)};else if(i==="y2"&&"y1"in n)yield{label:Ju(r,n,"y"),value:Qu(this.format.y2,n.y1,a,t)};else{const l=a.value[t],s=a.scale;if(!vt(l)&&s==null)continue;yield{label:ao(r,n,i),value:this.format[i](l,t),color:s==="color"?o[i][t]:null,opacity:s==="opacity"?o[i][t]:null}}}}function Qu(t,e,n,r){return n.hint?.length?`${t(n.value[r]-e.value[r],r)}`:`${t(e.value[r],r)}\u2013${t(n.value[r],r)}`}function Ju(t,e,n){const r=ao(t,e,`${n}1`,n),o=ao(t,e,`${n}2`,n);return r===o?r:`${r}\u2013${o}`}function ao(t,e,n,r=n){const o=e[n],i=t[o?.scale??n];return String(i?.label??o?.label??r)}function tf(t={}){const{facet:e,style:n,title:r,subtitle:o,caption:i,ariaLabel:a,ariaDescription:l}=t,s=Yr(t.className),c=t.marks===void 0?[]:nf(t.marks);c.push(...g$(c));const u=m$(e,t),f=new Map;for(const T of c){const B=of(T,u,t);B&&f.set(T,B)}const h=new Map;u&&Jn(h,[u],t),Jn(h,f,t);const d=nf($$(c,h,t));for(const T of d){const B=of(T,u,t);B&&f.set(T,B)}c.unshift(...d);let p=pg(h,t);if(p!==void 0){const T=u?Ti(p,u):void 0;for(const j of c){if(j.facet===null||j.facet==="super")continue;const I=f.get(j);I!==void 0&&(I.facetsIndex=j.fx!=null||j.fy!=null?Ti(p,I):T)}const B=new Set;for(const{facetsIndex:j}of f.values())j?.forEach((I,Y)=>{I?.length>0&&B.add(Y)});p.forEach(0<B.size&&B.size<p.length?(j,I)=>j.empty=!B.has(I):j=>j.empty=!1);for(const j of c)if(j.facet==="exclude"){const I=f.get(j);I!==void 0&&(I.facetsIndex=gg(I.facetsIndex))}}for(const T of st.keys())Te(t[T])&&T!=="fx"&&T!=="fy"&&h.set(T,[]);const m=new Map;for(const T of c){if(m.has(T))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:B,channels:j}=f.get(T)??{},{data:I,facets:Y,channels:H}=T.initialize(B,j,t);sa(H,t),m.set(T,{data:I,facets:Y,channels:H})}const $=Mi(Jn(h,m,t),t),y=e0($,c,t);ag($,y);const g=ic($),{fx:x,fy:v}=g,b=x||v?lc($,y):y,w=x||v?A$(g,y):y,k=Dr(t),M=k.document,A=Hl("svg").call(M.documentElement);let z=A;k.ownerSVGElement=A,k.className=s,k.projection=Lg(t,b),k.filterFacets=(T,B)=>Ti(p,{channels:B,groups:Si(T,B)}),k.getMarkState=T=>{const B=m.get(T),j=f.get(T);return{...B,channels:{...B.channels,...j?.channels}}},k.dispatchValue=T=>{z.value!==T&&(z.value=T,z.dispatchEvent(new Event("input",{bubbles:!0})))};const S=new Set;for(const[T,B]of m)if(T.initializer!=null){const j=T.facet==="super"?w:b,I=T.initializer(B.data,B.facets,B.channels,g,j,k);if(I.data!==void 0&&(B.data=I.data),I.facets!==void 0&&(B.facets=I.facets),I.channels!==void 0){const{fx:Y,fy:H,...G}=I.channels;p$(G),Object.assign(B.channels,G);for(const X of Object.values(G)){const{scale:W}=X;W!=null&&!ty(st.get(W))&&(rf(X,t),S.add(W))}(Y!=null||H!=null)&&f.set(T,!0)}}if(S.size){const T=new Map;Jn(T,m,t,Y=>S.has(Y)),Jn(h,m,t,Y=>S.has(Y));const B=M$(Mi(T,t),$),{scales:j,...I}=ic(B);Object.assign($,B),Object.assign(g,I),Object.assign(g.scales,j)}let L,C;p!==void 0&&(L={x:x?.domain(),y:v?.domain()},p=mg(p,L),C=yg(x,v,y));for(const[T,B]of m)B.values=T.scale(B.channels,g,k);const{width:E,height:O}=y;de(A).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",E).attr("height",O).attr("viewBox",`0 0 ${E} ${O}`).attr("aria-label",a).attr("aria-description",l).call(T=>T.append("style").text(`:where(.${s}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${s} text),
:where(.${s} tspan) {
  white-space: pre;
}`)).call(Fi,n);for(const T of c){const{channels:B,values:j,facets:I}=m.get(T);if(p===void 0||T.facet==="super"){let Y=null;if(I&&(Y=I[0],Y=T.filter(Y,B,j),Y.length===0))continue;const H=T.render(Y,g,j,w,k);if(H==null)continue;A.appendChild(H)}else{let Y;for(const H of p){if(!(T.facetAnchor?.(p,L,H)??!H.empty))continue;let G=null;if(I){const W=f.has(T);if(G=I[W?H.i:0],G=T.filter(G,B,j),G.length===0)continue;!W&&G===I[0]&&(G=Ie(G)),G.fx=H.x,G.fy=H.y,G.fi=H.i}const X=T.render(G,g,j,b,k);if(X!=null){(Y??=de(A).append("g")).append(()=>X).datum(H);for(const W of["aria-label","aria-description","aria-hidden","transform"])X.hasAttribute(W)&&(Y.attr(W,X.getAttribute(W)),X.removeAttribute(W))}}Y?.selectChildren().attr("transform",C)}}const R=D0($,k,t),{figure:N=r!=null||o!=null||i!=null||R.length>0}=t;N&&(z=M.createElement("figure"),z.className=`${s}-figure`,z.style.maxWidth="initial",r!=null&&z.append(ef(M,r,"h2")),o!=null&&z.append(ef(M,o,"h3")),z.append(...R,A),i!=null&&z.append(f$(M,i)),"value"in A&&(z.value=A.value,delete A.value)),z.scale=dg(g.scales),z.legend=W0($,k,t);const F=Py();return F>0&&de(A).append("text").attr("x",E).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("\u26A0\uFE0F").append("title").text(`${F.toLocaleString("en-US")} warning${F===1?"":"s"}. Please check the console.`),z}function ef(t,e,n){if(e.ownerDocument)return e;const r=t.createElement(n);return r.append(e),r}function f$(t,e){const n=t.createElement("figcaption");return n.append(e),n}function nf(t){return t.flat(1/0).filter(e=>e!=null).map(h$)}function h$(t){return typeof t.render=="function"?t:new d$(t)}let d$=class extends et{constructor(e){if(typeof e!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=e}render(){}};function sa(t,e){for(const n in t)rf(t[n],e);return t}function rf(t,e){const{scale:n,transform:r=!0}=t;if(n==null||!r)return;const{type:o,percent:i,interval:a,transform:l=i?s=>s==null?NaN:s*100:gs(a,o)}=e[n]??{};l!=null&&(t.value=J(t.value,l),t.transform=!1)}function p$(t){for(const e in t)js(e,t[e])}function Jn(t,e,n,r=Dm){for(const{channels:o}of e.values())for(const i in o){const a=o[i],{scale:l}=a;if(l!=null&&r(l))if(l==="projection"){if(!Eg(n)){const s=n.x?.domain===void 0,c=n.y?.domain===void 0;if(s||c){const[u,f]=Cg(a);s&&ca(t,"x",u),c&&ca(t,"y",f)}}}else ca(t,l,a)}return t}function ca(t,e,n){const r=t.get(e);r!==void 0?r.push(n):t.set(e,[n])}function m$(t,e){if(t==null)return;const{x:n,y:r}=t;if(n==null&&r==null)return;const o=Ze(t.data);if(o==null)throw new Error("missing facet data");const i={};n!=null&&(i.fx=Xn(o,{value:n,scale:"fx"})),r!=null&&(i.fy=Xn(o,{value:r,scale:"fy"})),sa(i,e);const a=Si(o,i);return{channels:i,groups:a,data:t.data}}function of(t,e,n){if(t.facet===null||t.facet==="super")return;const{fx:r,fy:o}=t;if(r!=null||o!=null){const s=Ze(t.data??r??o);if(s===void 0)throw new Error(`missing facet data in ${t.ariaLabel}`);if(s===null)return;const c={};return r!=null&&(c.fx=Xn(s,{value:r,scale:"fx"})),o!=null&&(c.fy=Xn(s,{value:o,scale:"fy"})),sa(c,n),{channels:c,groups:Si(s,c)}}if(e===void 0)return;const{channels:i,groups:a,data:l}=e;if(t.facet!=="auto"||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||a.size===1&&i.fx&&i.fy&&[...a][0][1].size>1)&&Bn(Ze(t.data))===Bn(l)&&ce(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn\u2019t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function y$(t,e={}){return Lt({...e,x:null,y:null},(n,r,o,i,a,l)=>l.getMarkState(t))}function g$(t){const e=[];for(const n of t){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:o,preferredAnchor:i}=r;o=/^x$/i.test(o)?Yi:/^y$/i.test(o)?Pr:qi,r=o(y$(n,r)),r.title=null,i===void 0&&(r.preferredAnchor=o===Pr?"left":"bottom");const a=Uu(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,e.push(a)}}return e}function $$(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=d===null?null:c}=o,y:{axis:m=s,grid:$=m===null?null:c}=i,fx:{axis:y=f,grid:g=y===null?null:h}=a,fy:{axis:x=f,grid:v=x===null?null:h}=l}=n;(r||!Te(o)&&!af("x",t))&&(d=p=null),(r||!Te(i)&&!af("y",t))&&(m=$=null),e.has("fx")||(y=g=null),e.has("fy")||(x=v=null),d===void 0&&(d=!co(t,"x")),m===void 0&&(m=!co(t,"y")),y===void 0&&(y=!co(t,"fx")),x===void 0&&(x=!co(t,"fy")),d===!0&&(d="bottom"),m===!0&&(m="left"),y===!0&&(y=d==="top"||d===null?"bottom":"top"),x===!0&&(x=m==="right"||m===null?"left":"right");const b=[];return so(b,v,ku,l),lo(b,x,$u,"right","left",u,l),so(b,g,Au,a),lo(b,y,vu,"top","bottom",u,a),so(b,$,bu,i),lo(b,m,Ki,"left","right",n,i),so(b,p,Mu,o),lo(b,d,Qi,"bottom","top",n,o),b}function lo(t,e,n,r,o,i,a){if(!e)return;const l=v$(e);a=x$(l?r:e,i,a);const{line:s}=a;(n===Ki||n===Qi)&&s&&!nn(s)&&t.push(aa(w$(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function so(t,e,n,r){!e||nn(e)||t.push(n(b$(e,r)))}function v$(t){return/^\s*both\s*$/i.test(t)}function x$(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}function w$(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:n===!0?void 0:n}}function b$(t,{stroke:e=Wn(t)?t:void 0,ticks:n=k$(t)?t:void 0,tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}function k$(t){switch(typeof t){case"number":return!0;case"string":return!Wn(t)}return oe(t)||typeof t?.range=="function"}function co(t,e){const n=`${e}-axis `;return t.some(r=>r.ariaLabel?.startsWith(n))}function af(t,e){for(const n of e)for(const r in n.channels){const{scale:o}=n.channels[r];if(o===t||o==="projection")return!0}return!1}function M$(t,e){for(const n in t){const r=t[n],o=e[n];r.label===void 0&&o&&(r.label=o.label)}return t}function A$({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Ai(n),c=t&&lf(t),u=e&&lf(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}function lf(t){const e=t.domain();if(e.length===0)return[0,t.bandwidth()];let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const L$=new Map([["basis",Kp],["basis-closed",Qp],["basis-open",Jp],["bundle",tm],["bump-x",em],["bump-y",nm],["cardinal",rm],["cardinal-closed",om],["cardinal-open",im],["catmull-rom",am],["catmull-rom-closed",lm],["catmull-rom-open",sm],["linear",Wo],["linear-closed",cm],["monotone-x",um],["monotone-y",fm],["natural",hm],["step",dm],["step-after",pm],["step-before",mm]]);function ua(t=Wo,e){if(typeof t=="function")return t;const n=L$.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${t}`);if(e!==void 0){if("beta"in n)return n.beta(e);if("tension"in n)return n.tension(e);if("alpha"in n)return n.alpha(e)}return n}function sf(t=gn,e){return typeof t!="function"&&`${t}`.toLowerCase()==="auto"?gn:ua(t,e)}function gn(t){return Wo(t)}function Me(t={y:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=e;return da(uo(n,e,D),null,null,r,t,Kn(e))}function Ae(t={x:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=e;return da(null,uo(r,e,D),n,null,t,Qn(e))}function Fe(t={fill:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=z$(e);return da(n,r,null,null,t,Kn(Qn(e)))}function cf(t,e,n={}){if(n?.interval==null)return n;const{reduce:r=pi}=n,o={filter:null};return n[e]!=null&&(o[e]=r),n[`${e}1`]!=null&&(o[`${e}1`]=r),n[`${e}2`]!=null&&(o[`${e}2`]=r),t(o,n)}function fa(t={}){return cf(Me,"y",je(t,"x"))}function ha(t={}){return cf(Ae,"x",je(t,"y"))}function da(t,e,n,r,{data:o=di,filter:i=Rr,sort:a,reverse:l,...s}={},c={}){t=uf(t),e=uf(e),s=S$(s,c),o=pf(o,D),a=a==null?void 0:hf("sort",a,c),i=i==null?void 0:df("filter",i,c),n!=null&&ve(s,"x","x1","x2")&&(n=null),r!=null&&ve(s,"y","y1","y2")&&(r=null);const[u,f]=Et(t),[h,d]=Et(t),[p,m]=Et(e),[$,y]=Et(e),[g,x]=n!=null?[n,"x"]:r!=null?[r,"y"]:[],[v,b]=Et(g),{x:w,y:k,z:M,fill:A,stroke:z,x1:S,x2:L,y1:C,y2:E,domain:O,cumulative:R,thresholds:N,interval:F,...T}=c,[B,j]=Et(M),[I]=Mt(A),[Y]=Mt(z),[H,G]=Et(I),[X,W]=Et(Y);return{..."z"in c&&{z:B||M},..."fill"in c&&{fill:H||A},..."stroke"in c&&{stroke:X||z},...jt(T,(P,_,Z)=>{const K=zr(V(P,g),Z?.[x]),nt=V(P,M),ft=V(P,I),at=V(P,Y),dt=hi(s,{z:nt,fill:ft,stroke:at}),mt=[],bt=[],Ee=K&&b([]),Oe=nt&&j([]),Fh=ft&&G([]),Dh=at&&W([]),Xa=t&&f([]),qh=t&&d([]),_a=e&&m([]),Yh=e&&y([]),Ph=C$(t,e,P);let Xh=0;for(const Pe of s)Pe.initialize(P);a&&a.initialize(P),i&&i.initialize(P);for(const Pe of _){const Ga=[];for(const Xe of s)Xe.scope("facet",Pe);a&&a.scope("facet",Pe),i&&i.scope("facet",Pe);for(const[Xe,_h]of Be(Pe,dt))for(const[Gh,sr]of Be(_h,K))for(const[Dt,Zt]of Ph(sr))if(dt&&(Zt.z=Xe),!(i&&!i.reduce(Dt,Zt))){Ga.push(Xh++),bt.push(o.reduceIndex(Dt,P,Zt)),K&&Ee.push(Gh),nt&&Oe.push(dt===nt?Xe:nt[(Dt.length>0?Dt:sr)[0]]),ft&&Fh.push(dt===ft?Xe:ft[(Dt.length>0?Dt:sr)[0]]),at&&Dh.push(dt===at?Xe:at[(Dt.length>0?Dt:sr)[0]]),Xa&&(Xa.push(Zt.x1),qh.push(Zt.x2)),_a&&(_a.push(Zt.y1),Yh.push(Zt.y2));for(const Vh of s)Vh.reduce(Dt,Zt);a&&a.reduce(Dt,Zt)}mt.push(Ga)}return Rs(mt,a,l),{data:bt,facets:mt}}),...!ve(s,"x")&&(u?{x1:u,x2:h,x:Lr(u,h)}:{x:w,x1:S,x2:L}),...!ve(s,"y")&&(p?{y1:p,y2:$,y:Lr(p,$)}:{y:k,y1:C,y2:E}),...v&&{[x]:v},...Object.fromEntries(s.map(({name:P,output:_})=>[P,_]))}}function pa({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function uo(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return t={...tn(t)},t.domain===void 0&&(t.domain=n),t.cumulative===void 0&&(t.cumulative=e),t.thresholds===void 0&&(t.thresholds=r),t.interval===void 0&&(t.interval=o),t.value===void 0&&(t.value=i),t.thresholds=ff(t.thresholds,t.interval),t}function z$(t){let{x:e,y:n}=t;return e=uo(e,t),n=uo(n,t),[e.value,n.value]=Wt(e.value,n.value),{x:e,y:n}}function uf(t){if(t==null)return;const{value:e,cumulative:n,domain:r=yt,thresholds:o}=t,i=a=>{let l=V(a,e),s;if(At(l)||O$(o)){l=J(l,fs,Float64Array);let[u,f]=typeof r=="function"?r(l):r,h=typeof o=="function"&&!Je(o)?o(l,u,f):o;typeof h=="number"&&(h=gm(u,f,h)),Je(h)&&(r===yt&&(u=h.floor(u),f=h.offset(h.floor(f))),h=h.range(u,h.offset(f))),s=h}else{l=St(l);let[u,f]=typeof r=="function"?r(l):r,h=typeof o=="function"&&!Je(o)?o(l,u,f):o;if(typeof h=="number")if(r===yt){let d=$m(u,f,h);if(isFinite(d))if(d>0){let p=Math.round(u/d),m=Math.round(f/d);p*d<=u||--p,m*d>f||++m;let $=m-p+1;h=new Float64Array($);for(let y=0;y<$;++y)h[y]=(p+y)*d}else if(d<0){d=-d;let p=Math.round(u*d),m=Math.round(f*d);p/d<=u||--p,m/d>f||++m;let $=m-p+1;h=new Float64Array($);for(let y=0;y<$;++y)h[y]=(p+y)/d}else h=[u];else h=[u]}else h=Oo(u,f,h);else Je(h)&&(r===yt&&(u=h.floor(u),f=h.offset(h.floor(f))),h=h.range(u,h.offset(f)));s=h}const c=[];if(s.length===1)c.push([s[0],s[0]]);else for(let u=1;u<s.length;++u)c.push([s[u-1],s[u]]);return c.bin=(n<0?R$:n>0?N$:ma)(c,s,l),c};return i.label=_t(e),i}function ff(t,e,n=mf){if(t===void 0)return e===void 0?n:Qe(e);if(typeof t=="string"){switch(t.toLowerCase()){case"freedman-diaconis":return ym;case"scott":return Zl;case"sturges":return Ul;case"auto":return mf}return br(t)}return t}function S$(t,e){return Ss(t,e,hf)}function hf(t,e,n){return ui(t,e,n,df)}function df(t,e,n){return fi(t,e,n,pf)}function pf(t,e){return Nr(t,e,E$)}function E$(t){switch(`${t}`.toLowerCase()){case"x":return T$;case"x1":return B$;case"x2":return W$;case"y":return I$;case"y1":return j$;case"y2":return F$;case"z":return Bs}throw new Error(`invalid bin reduce: ${t}`)}function mf(t,e,n){return Math.min(200,Zl(t,e,n))}function O$(t){return Pm(t)||oe(t)&&At(t)}function C$(t,e,n){const r=t?.(n),o=e?.(n);return r&&o?function*(i){const a=r.bin(i);for(const[l,[s,c]]of r.entries()){const u=o.bin(a[l]);for(const[f,[h,d]]of o.entries())yield[u[f],{data:n,x1:s,y1:h,x2:c,y2:d}]}}:r?function*(i){const a=r.bin(i);for(const[l,[s,c]]of r.entries())yield[a[l],{data:n,x1:s,x2:c}]}:function*(i){const a=o.bin(i);for(const[l,[s,c]]of o.entries())yield[a[l],{data:n,y1:s,y2:c}]}}function ma(t,e,n){return e=St(e),r=>{const o=t.map(()=>[]);for(const i of r)o[vm(e,n[i])-1]?.push(i);return o}}function N$(t,e,n){const r=ma(t,e,n);return o=>{const i=r(o);for(let a=1,l=i.length;a<l;++a){const s=i[a-1],c=i[a];for(const u of s)c.push(u)}return i}}function R$(t,e,n){const r=ma(t,e,n);return o=>{const i=r(o);for(let a=i.length-2;a>=0;--a){const l=i[a+1],s=i[a];for(const c of l)s.push(c)}return i}}function yf(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const T$={reduceIndex(t,e,{x1:n,x2:r}){return yf(n,r)}},I$={reduceIndex(t,e,{y1:n,y2:r}){return yf(n,r)}},B$={reduceIndex(t,e,{x1:n}){return n}},W$={reduceIndex(t,e,{x2:n}){return n}},j$={reduceIndex(t,e,{y1:n}){return n}},F$={reduceIndex(t,e,{y2:n}){return n}},D$={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let fo=class extends et{constructor(e,n={}){const{x1:r,y1:o,x2:i,y2:a,z:l,curve:s,tension:c}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0},z:{value:$e(n),optional:!0}},n,D$),this.z=l,this.curve=ua(s,c)}filter(e){return e}render(e,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return U("svg:g",i).call(ot,this,o,i).call(tt,this,n,0,0).call(u=>u.selectAll().data(Ac(e,[a,l,s,c],this,r)).enter().append("path").call(Q,this).call(qr,this,r).attr("d",jo().curve(this.curve).defined(f=>f>=0).x0(f=>a[f]).y0(f=>l[f]).x1(f=>s[f]).y1(f=>c[f]))).node()}};function ya(t,e){return e===void 0?$n(t,{x:Mr,y:Tn}):new fo(t,e)}function tr(t,e){const{y:n=gt,...r}=ha(e);return new fo(t,Qr(Zr({...r,y1:n,y2:void 0})))}function $n(t,e){const{x:n=gt,...r}=fa(e);return new fo(t,Jr(Kr({...r,x1:n,x2:void 0})))}const q$={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};let gf=class extends et{constructor(e,n={}){const{x1:r,y1:o,x2:i,y2:a,curve:l,tension:s}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,q$),this.curve=sf(l,s),sn(this,n)}project(e,n,r){this.curve!==gn&&super.project(e,n,r)}render(e,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(f=>f.selectAll().data(e).enter().append("path").call(Q,this).attr("d",u===gn&&i.projection?Y$(i.projection,a,l,s,c):h=>{const d=Qt(),p=u(d);return p.lineStart(),p.point(a[h],l[h]),p.point(s[h],c[h]),p.lineEnd(),d}).call(ut,this,r).call(Zn,this,r,i)).node()}};function Y$(t,e,n,r,o){const i=Kt(t);return e=St(e),n=St(n),r=St(r),o=St(o),a=>i({type:"LineString",coordinates:[[e[a],n[a]],[r[a],o[a]]]})}function $f(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=ho(e,n,r),[i,a]=ho(o,i,a),new gf(t,{...l,x1:n,x2:r,y1:i,y2:a})}function ho(t,e,n){if(t===void 0){if(e===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[e]}else{if(e===void 0)return n===void 0?[t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}const P$={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};let vf=class extends et{constructor(e,n={}){const{x1:r,y1:o,x2:i,y2:a,bend:l=0,headAngle:s=60,headLength:c=8,inset:u=0,insetStart:f=u,insetEnd:h=u,sweep:d}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,P$),this.bend=l===!0?22.5:Math.max(-90,Math.min(90,l)),this.headAngle=+s,this.headLength=+c,this.insetStart=+f,this.insetEnd=+h,this.sweep=X$(d)}render(e,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l,SW:u}=r,{strokeWidth:f,bend:h,headAngle:d,headLength:p,insetStart:m,insetEnd:$}=this,y=u?v=>u[v]:xt(f===void 0?1:f),g=d*Xr/2,x=p/1.5;return U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(v=>v.selectAll().data(e).enter().append("path").call(Q,this).attr("d",b=>{let w=a[b],k=l[b],M=s[b],A=c[b];const z=Math.hypot(M-w,A-k);if(z<=m+$)return null;let S=Math.atan2(A-k,M-w);const L=Math.min(x*y(b),z/3),C=this.sweep(w,k,M,A)*h*Xr,E=Math.hypot(z/Math.tan(C),z)/2;if(m||$)if(E<1e5){const H=Math.sign(C),[G,X]=_$([w,k],[M,A],E,H);if(m&&([w,k]=xf([G,X,E],[w,k,m],-H*Math.sign(m))),$){const[W,P]=xf([G,X,E],[M,A,$],H*Math.sign($));S+=Math.atan2(P-X,W-G)-Math.atan2(A-X,M-G),M=W,A=P}}else{const H=M-w,G=A-k,X=Math.hypot(H,G);m&&(w+=H/X*m,k+=G/X*m),$&&(M-=H/X*$,A-=G/X*$)}const O=S+C,R=O+g,N=O-g,F=M-L*Math.cos(R),T=A-L*Math.sin(R),B=M-L*Math.cos(N),j=A-L*Math.sin(N),I=E<1e5?`A${E},${E} 0,0,${C>0?1:0} `:"L",Y=L?`M${F},${T}L${M},${A}L${B},${j}`:"";return`M${w},${k}${I}${M},${A}${Y}`}).call(ut,this,r)).node()}};function X$(t=1){if(typeof t=="number")return xt(Math.sign(t));if(typeof t=="function")return(e,n,r,o)=>Math.sign(t(e,n,r,o));switch(Ot(t,"sweep",["+x","-x","+y","-y"])){case"+x":return(e,n,r)=>cr(e,r);case"-x":return(e,n,r)=>_e(e,r);case"+y":return(e,n,r,o)=>cr(n,o);case"-y":return(e,n,r,o)=>_e(n,o)}}function _$([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}function xf([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}function G$(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=ho(e,n,r),[i,a]=ho(o,i,a),new vf(t,{...l,x1:n,x2:r,y1:i,y2:a})}const V$={ariaLabel:"bar"};let ga=class extends et{constructor(e,n,r={},o=V$){super(e,n,r,o),na(this,r),ra(this,r)}render(e,n,r,o,i){const{rx:a,ry:l,rx1y1:s,rx1y2:c,rx2y1:u,rx2y2:f}=this,h=this._x(n,r,o),d=this._y(n,r,o),p=this._width(n,r,o),m=this._height(n,r,o);return U("svg:g",i).call(ot,this,o,i).call(this._transform,this,n).call($=>$.selectAll().data(e).enter().call(s||c||u||f?y=>y.append("path").call(Q,this).call(oa,h,d,wf(h,p),wf(d,m),this).call(ut,this,r):y=>y.append("rect").call(Q,this).attr("x",h).attr("width",p).attr("y",d).attr("height",m).call(q,"rx",a).call(q,"ry",l).call(ut,this,r))).node()}_x(e,{x:n},{marginLeft:r}){const{insetLeft:o}=this;return n?i=>n[i]+o:r+o}_y(e,{y:n},{marginTop:r}){const{insetTop:o}=this;return n?i=>n[i]+o:r+o}_width({x:e},{x:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this,s=n&&e?e.bandwidth():i-r-o;return Math.max(0,s-a-l)}_height({y:e},{y:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this,s=n&&e?e.bandwidth():i-r-o;return Math.max(0,s-a-l)}};function wf(t,e){return typeof t=="function"&&typeof e=="function"?n=>t(n)+e(n):typeof t=="function"?n=>t(n)+e:typeof e=="function"?n=>t+e(n):t+e}let $a=class extends ga{constructor(e,n={},r){const{x1:o,x2:i,y:a}=n;super(e,{x1:{value:o,scale:"x"},x2:{value:i,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},n,r)}_transform(e,n,{x:r}){e.call(tt,n,{x:r},0,0)}_x({x:e},{x1:n,x2:r},{marginLeft:o}){const{insetLeft:i}=this;return Vt(e)?o+i:a=>Math.min(n[a],r[a])+i}_width({x:e},{x1:n,x2:r},{marginRight:o,marginLeft:i,width:a}){const{insetLeft:l,insetRight:s}=this;return Vt(e)?a-o-i-l-s:c=>Math.max(0,Math.abs(r[c]-n[c])-l-s)}},va=class extends ga{constructor(e,n={},r){const{x:o,y1:i,y2:a}=n;super(e,{y1:{value:i,scale:"y"},y2:{value:a,scale:"y"},x:{value:o,scale:"x",type:"band",optional:!0}},n,r)}_transform(e,n,{y:r}){e.call(tt,n,{y:r},0,0)}_y({y:e},{y1:n,y2:r},{marginTop:o}){const{insetTop:i}=this;return Vt(e)?o+i:a=>Math.min(n[a],r[a])+i}_height({y:e},{y1:n,y2:r},{marginTop:o,marginBottom:i,height:a}){const{insetTop:l,insetBottom:s}=this;return Vt(e)?a-o-i-l-s:c=>Math.max(0,Math.abs(r[c]-n[c])-l-s)}};function De(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D}),new $a(t,Qr(Gi(Zr(e))))}function qe(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D}),new va(t,Jr(Vi(Kr(e))))}const H$={ariaLabel:"cell"};let po=class extends ga{constructor(e,{x:n,y:r,...o}={}){super(e,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},o,H$)}_transform(e,n){e.call(tt,n,{},0,0)}};function vn(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new po(t,{...r,x:e,y:n})}function U$(t,{x:e=gt,fill:n,stroke:r,...o}={}){return n===void 0&&Mt(r)[0]===void 0&&(n=D),new po(t,{...o,x:e,fill:n,stroke:r})}function Z$(t,{y:e=gt,fill:n,stroke:r,...o}={}){return n===void 0&&Mt(r)[0]===void 0&&(n=D),new po(t,{...o,y:e,fill:n,stroke:r})}const K$={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function xa(t){return t.sort===void 0&&t.reverse===void 0?Ls({channel:"-r"},t):t}let mo=class extends et{constructor(e,n={}){const{x:r,y:o,r:i,rotate:a,symbol:l=So,frameAnchor:s}=n,[c,u]=ht(a,0),[f,h]=oy(l),[d,p]=ht(i,f==null?3:4.5);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:d,scale:"r",filter:Jt,optional:!0},rotate:{value:c,optional:!0},symbol:{value:f,scale:"auto",optional:!0}},xa(n),K$),this.r=p,this.rotate=u,this.symbol=h,this.frameAnchor=jn(s);const{channels:m}=this,{symbol:$}=m;if($){const{fill:y,stroke:g}=m;$.hint={fill:y?y.value===$.value?"color":"currentColor":this.fill??"currentColor",stroke:g?g.value===$.value?"color":"currentColor":this.stroke??"none"}}}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,r:u,rotate:f,symbol:h}=r,{r:d,rotate:p,symbol:m}=this,[$,y]=Ht(this,o),g=m===So,x=u?void 0:d*d*Math.PI;return vr(d)&&(e=[]),U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(v=>v.selectAll().data(e).enter().append(g?"circle":"path").call(Q,this).call(g?b=>{b.attr("cx",s?w=>s[w]:$).attr("cy",c?w=>c[w]:y).attr("r",u?w=>u[w]:d)}:b=>{b.attr("transform",cn`translate(${s?w=>s[w]:$},${c?w=>c[w]:y})${f?w=>` rotate(${f[w]})`:p?` rotate(${p})`:""}`).attr("d",u&&h?w=>{const k=Qt();return h[w].draw(k,u[w]*u[w]*Math.PI),k}:u?w=>{const k=Qt();return m.draw(k,u[w]*u[w]*Math.PI),k}:h?w=>{const k=Qt();return h[w].draw(k,x),k}:(()=>{const w=Qt();return m.draw(w,x),w})())}).call(ut,this,r)).node()}};function Le(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new mo(t,{...r,x:e,y:n})}function Q$(t,{x:e=D,...n}={}){return new mo(t,Pc({...n,x:e}))}function J$(t,{y:e=D,...n}={}){return new mo(t,Yc({...n,y:e}))}function tv(t,e){return Le(t,{...e,symbol:"circle"})}function ev(t,e){return Le(t,{...e,symbol:"hexagon"})}const nv={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let yo=class extends et{constructor(e,n={}){const{x:r,y:o,z:i,curve:a,tension:l}=n;super(e,{x:{value:r,scale:"x"},y:{value:o,scale:"y"},z:{value:$e(n),optional:!0}},n,nv),this.z=i,this.curve=sf(a,l),sn(this,n)}filter(e){return e}project(e,n,r){this.curve!==gn&&super.project(e,n,r)}render(e,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(c=>c.selectAll().data(Ac(e,[a,l],this,r)).enter().append("path").call(Q,this).call(qr,this,r).call(l0,this,r,i).attr("d",s===gn&&i.projection?rv(i.projection,a,l):xm().curve(s).defined(u=>u>=0).x(u=>a[u]).y(u=>l[u]))).node()}};function rv(t,e,n){const r=Kt(t);return e=St(e),n=St(n),o=>{let i=[];const a=[i];for(const l of o)l===-1?(i=[],a.push(i)):i.push([e[l],n[l]]);return r({type:"MultiLineString",coordinates:a})}}function go(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new yo(t,{...r,x:e,y:n})}function er(t,{x:e=D,y:n=gt,...r}={}){return new yo(t,ha({...r,x:e,y:n}))}function nr(t,{x:e=gt,y:n=D,...r}={}){return new yo(t,fa({...r,x:e,y:n}))}function bf(t,e){e=iv(e);const{x:n,y:r,color:o,size:i}=e,a=$o(t,n),l=$o(t,r),s=$o(t,o),c=$o(t,i);let{fx:u,fy:f,x:{value:h,reduce:d,zero:p,...m},y:{value:$,reduce:y,zero:g,...x},color:{value:v,color:b,reduce:w},size:{value:k,reduce:M},mark:A}=e;if(d===void 0&&(d=y==null&&h==null&&k==null&&$!=null?"count":null),y===void 0&&(y=d==null&&$==null&&k==null&&h!=null?"count":null),M===void 0&&k==null&&w==null&&d==null&&y==null&&(h==null||ct(a))&&($==null||ct(l))&&(M="count"),p===void 0&&(p=vo(d)?!0:void 0),g===void 0&&(g=vo(y)?!0:void 0),h==null&&$==null)throw new Error("must specify x or y");if(d!=null&&$==null)throw new Error("reducing x requires y");if(y!=null&&h==null)throw new Error("reducing y requires x");A===void 0&&(A=k!=null||M!=null?"dot":vo(d)||vo(y)||w!=null?"bar":h!=null&&$!=null?ct(a)||ct(l)||d==null&&y==null&&!rr(a)&&!rr(l)?"dot":"line":h!=null||$!=null?"rule":null);let z,S,L;switch(A){case"dot":L=Le,S="stroke";break;case"line":L=a&&l||d!=null||y!=null?g||y!=null||a&&rr(a)?nr:p||d!=null||l&&rr(l)?er:go:a?er:nr,S="stroke",Mf(s)&&(z=null);break;case"area":L=!(g||y!=null)&&(p||d!=null||l&&rr(l))?tr:$n,S="fill",Mf(s)&&(z=null);break;case"rule":L=a?we:be,S="stroke";break;case"bar":L=d!=null?ct(l)?kf(d)&&a&&ct(a)?vn:De:oo:y!=null?ct(a)?kf(y)&&l&&ct(l)?vn:qe:io:w!=null||M!=null?a&&ct(a)&&l&&ct(l)?vn:a&&ct(a)?qe:l&&ct(l)?De:ia:a&&en(a)&&!(l&&en(l))?De:l&&en(l)&&!(a&&en(a))?qe:vn,S="fill";break;default:throw new Error(`invalid mark: ${A}`)}let C={fx:u,fy:f,x:a??void 0,y:l??void 0,[S]:s??b,z,r:c??void 0,tip:!0},E,O={[S]:w??void 0,r:M??void 0};if(d!=null&&y!=null)throw new Error("cannot reduce both x and y");return y!=null?(O.y=y,E=ct(a)?Yn:Me):d!=null?(O.x=d,E=ct(l)?Pn:Ae):(w!=null||M!=null)&&(a&&l?E=ct(a)&&ct(l)?ci:ct(a)?Ae:ct(l)?Me:Fe:a?E=ct(a)?Yn:Me:l&&(E=ct(l)?Pn:Ae)),(E===Fe||E===Me)&&(C.x={value:a,...m}),(E===Fe||E===Ae)&&(C.y={value:l,...x}),p===void 0&&(p=a&&!(E===Fe||E===Me)&&(L===De||L===tr||L===oo||L===be)),g===void 0&&(g=l&&!(E===Fe||E===Ae)&&(L===qe||L===$n||L===io||L===we)),{fx:u??null,fy:f??null,x:{value:h??null,reduce:d??null,zero:!!p,...m},y:{value:$??null,reduce:y??null,zero:!!g,...x},color:{value:v??null,reduce:w??null,...b!==void 0&&{color:b}},size:{value:k??null,reduce:M??null},mark:A,markImpl:Af[L],markOptions:C,transformImpl:Af[E],transformOptions:O,colorMode:S}}function ov(t,e){const n=bf(t,e),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=n,u=wa[n.markImpl],f=wa[n.transformImpl],h=r!=null||o!=null?aa({strokeOpacity:.1}):null,d=[i?we([0]):null,a?be([0]):null],p=u(t,f?f(s,l):l);return c==="stroke"?It(h,d,p):It(h,p,d)}function rr(t){let e,n;for(const r of t){if(r==null)continue;if(e===void 0){e=r;continue}const o=Math.sign(cr(e,r));if(o){if(n!==void 0&&o!==n)return!1;e=r,n=o}}return!0}function iv({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){return Xt(t)||(t=xn(t)),Xt(e)||(e=xn(e)),Xt(n)||(n=Wn(n)?{color:n}:xn(n)),Xt(r)||(r=xn(r)),Xt(o)&&({value:o}=xn(o)),Xt(i)&&({value:i}=xn(i)),a!=null&&(a=`${a}`.toLowerCase()),{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}function $o(t,e){const n=V(t,e.value);return n&&(n.label=_t(e.value)),n}function xn(t){return av(t)?{reduce:t}:{value:t}}function vo(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function kf(t){return/^(?:first|last|mode)$/i.test(t)}function av(t){if(t==null)return!1;if(typeof t.reduceIndex=="function"||typeof t.reduce=="function"&&Tt(t)||/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}function Mf(t){return t?new zn(t).size>t.length>>1:!1}const wa={dot:Le,line:go,lineX:er,lineY:nr,areaX:tr,areaY:$n,ruleX:we,ruleY:be,barX:De,barY:qe,rect:ia,rectX:oo,rectY:io,cell:vn,bin:Fe,binX:Me,binY:Ae,group:ci,groupX:Yn,groupY:Pn},Af=Object.fromEntries(Object.entries(wa).map(([t,e])=>[e,t]));function ba(t,e={}){let{x:n,x1:r,x2:o}=e;n===void 0&&r===void 0&&o===void 0&&(e={...e,x:n=D});const i={};return n!=null&&(i.x=t),r!=null&&(i.x1=t),o!=null&&(i.x2=t),Ut(i,e)}function ka(t,e={}){let{y:n,y1:r,y2:o}=e;n===void 0&&r===void 0&&o===void 0&&(e={...e,y:n=D});const i={};return n!=null&&(i.y=t),r!=null&&(i.y1=t),o!=null&&(i.y2=t),Ut(i,e)}function Ut(t={},e={}){const n=$e(e),r=Object.entries(t).map(([o,i])=>{const a=ys(o,e);if(a==null)throw new Error(`missing channel: ${o}`);const[l,s]=Ct(a);return{key:o,input:a,output:l,setOutput:s,map:lv(i)}});return{...jt(e,(o,i)=>{const a=V(o,n),l=r.map(({input:c})=>V(o,c)),s=r.map(({setOutput:c})=>c(new Array(o.length)));for(const c of i)for(const u of a?Ce(c,f=>a[f]).values():[c])r.forEach(({map:f},h)=>f.mapIndex(u,l[h],s[h]));return{data:o,facets:i}}),...Object.fromEntries(r.map(({key:o,output:i})=>[o,i]))}}function lv(t){if(t==null)throw new Error("missing map");if(typeof t.mapIndex=="function")return t;if(typeof t.map=="function"&&Tt(t))return sv(t);if(typeof t=="function")return Ma(Zo(t));switch(`${t}`.toLowerCase()){case"cumsum":return uv;case"rank":return Ma((e,n)=>Kl(e,r=>n[r]));case"quantile":return Ma((e,n)=>cv(e,r=>n[r]))}throw new Error(`invalid map: ${t}`)}function sv(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}function cv(t,e){const n=wm(t,e)-1;return Kl(t,e).map(r=>r/n)}function Ma(t){return{mapIndex(e,n,r){const o=t(e,n);if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let i=0,a=e.length;i<a;++i)r[e[i]]=o[i]}}}const uv={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}};function fv(t={},e){return arguments.length===1&&(e=t),ba(xo(t),e)}function hv(t={},e){return arguments.length===1&&(e=t),ka(xo(t),e)}function xo(t={}){typeof t=="number"&&(t={k:t});let{k:e,reduce:n,shift:r,anchor:o,strict:i}=t;if(o===void 0&&r!==void 0&&(o=pv(r),ce(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((e=Math.floor(e))>0))throw new Error(`invalid k: ${e}`);return mv(n)(e,dv(o,e),i)}function dv(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}function pv(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}function mv(t="mean"){if(typeof t=="string"){if(/^p\d{2}$/i.test(t))return wo(Ho(t));switch(t.toLowerCase()){case"deviation":return wo(fr);case"max":return bo((e,n)=>zt(e,r=>n[r]));case"mean":return yv;case"median":return wo(Sn);case"min":return bo((e,n)=>Nt(e,r=>n[r]));case"mode":return bo((e,n)=>al(e,r=>n[r]));case"sum":return Lf;case"variance":return wo(ll);case"difference":return vv;case"ratio":return xv;case"first":return wv;case"last":return bv}}if(typeof t!="function")throw new Error(`invalid reduce: ${t}`);return bo(Zo(t))}function wo(t){return(e,n,r)=>r?{mapIndex(o,i,a){const l=c=>i[c]==null?NaN:+i[c];let s=0;for(let c=0;c<e-1;++c)isNaN(l(c))&&++s;for(let c=0,u=o.length-e+1;c<u;++c)isNaN(l(c+e-1))&&++s,a[o[c+n]]=s===0?t(Ie(o,c,c+e),l):NaN,isNaN(l(c))&&--s}}:{mapIndex(o,i,a){const l=s=>i[s]==null?NaN:+i[s];for(let s=-n;s<0;++s)a[o[s+n]]=t(Ie(o,0,s+e),l);for(let s=0,c=o.length-n;s<c;++s)a[o[s+n]]=t(Ie(o,s,s+e),l)}}}function bo(t){return(e,n,r)=>r?{mapIndex(o,i,a){let l=0;for(let s=0;s<e-1;++s)l+=vt(i[o[s]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=vt(i[o[s+e-1]]),l===e&&(a[o[s+n]]=t(Ie(o,s,s+e),i)),l-=vt(i[o[s]])}}:{mapIndex(o,i,a){for(let l=-n;l<0;++l)a[o[l+n]]=t(Ie(o,0,l+e),i);for(let l=0,s=o.length-n;l<s;++l)a[o[l+n]]=t(Ie(o,l,l+e),i)}}}function Lf(t,e,n){return n?{mapIndex(r,o,i){let a=0,l=0;for(let s=0;s<t-1;++s){const c=o[r[s]];c===null||isNaN(c)?++a:l+=+c}for(let s=0,c=r.length-t+1;s<c;++s){const u=o[r[s]],f=o[r[s+t-1]];f===null||isNaN(f)?++a:l+=+f,i[r[s+e]]=a===0?l:NaN,u===null||isNaN(u)?--a:l-=+u}}}:{mapIndex(r,o,i){let a=0;const l=r.length;for(let s=0,c=Math.min(l,t-e-1);s<c;++s)a+=+o[r[s]]||0;for(let s=-e,c=l-e;s<c;++s)a+=+o[r[s+t-1]]||0,i[r[s+e]]=a,a-=+o[r[s]]||0}}}function yv(t,e,n){if(n){const r=Lf(t,e,n);return{mapIndex(o,i,a){r.mapIndex(o,i,a);for(let l=0,s=o.length-t+1;l<s;++l)a[o[l+e]]/=t}}}else return{mapIndex(r,o,i){let a=0,l=0;const s=r.length;for(let c=0,u=Math.min(s,t-e-1);c<u;++c){let f=o[r[c]];f!==null&&!isNaN(f=+f)&&(a+=f,++l)}for(let c=-e,u=s-e;c<u;++c){let f=o[r[c+t-1]],h=o[r[c]];f!==null&&!isNaN(f=+f)&&(a+=f,++l),i[r[c+e]]=a/l,h!==null&&!isNaN(h=+h)&&(a-=h,--l)}}}}function gv(t,e,n,r){for(let o=n+r;n<o;++n){const i=t[e[n]];if(vt(i))return i}}function $v(t,e,n,r){for(let o=n+r-1;o>=n;--o){const i=t[e[o]];if(vt(i))return i}}function zf(t,e,n,r){for(let o=n+r;n<o;++n){let i=t[e[n]];if(i!==null&&!isNaN(i=+i))return i}}function Sf(t,e,n,r){for(let o=n+r-1;o>=n;--o){let i=t[e[o]];if(i!==null&&!isNaN(i=+i))return i}}function vv(t,e,n){return n?{mapIndex(r,o,i){for(let a=0,l=r.length-t;a<l;++a){const s=o[r[a]],c=o[r[a+t-1]];i[r[a+e]]=s===null||c===null?NaN:c-s}}}:{mapIndex(r,o,i){for(let a=-e,l=r.length-t+e+1;a<l;++a)i[r[a+e]]=Sf(o,r,a,t)-zf(o,r,a,t)}}}function xv(t,e,n){return n?{mapIndex(r,o,i){for(let a=0,l=r.length-t;a<l;++a){const s=o[r[a]],c=o[r[a+t-1]];i[r[a+e]]=s===null||c===null?NaN:c/s}}}:{mapIndex(r,o,i){for(let a=-e,l=r.length-t+e+1;a<l;++a)i[r[a+e]]=Sf(o,r,a,t)/zf(o,r,a,t)}}}function wv(t,e,n){return n?{mapIndex(r,o,i){for(let a=0,l=r.length-t;a<l;++a)i[r[a+e]]=o[r[a]]}}:{mapIndex(r,o,i){for(let a=-e,l=r.length-t+e+1;a<l;++a)i[r[a+e]]=gv(o,r,a,t)}}}function bv(t,e,n){return n?{mapIndex(r,o,i){for(let a=0,l=r.length-t;a<l;++a)i[r[a+e]]=o[r[a+t-1]]}}:{mapIndex(r,o,i){for(let a=-e,l=r.length-t+e+1;a<l;++a)i[r[a+e]]=$v(o,r,a,t)}}}const fe={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function kv(t,{x:e=D,y:n,k:r=fe.k,color:o=fe.color,opacity:i=fe.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return It(lt(a)?null:tr(t,Ut({x1:Ye({k:-r,...f}),x2:Ye({k:r,...f})},{x1:e,x2:e,y:n,fill:a,fillOpacity:l,...f})),lt(s)?null:er(t,Ut({x:Ye(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))}function Mv(t,{x:e,y:n=D,k:r=fe.k,color:o=fe.color,opacity:i=fe.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return It(lt(a)?null:$n(t,Ut({y1:Ye({k:-r,...f}),y2:Ye({k:r,...f})},{x:e,y1:n,y2:n,fill:a,fillOpacity:l,...f})),lt(s)?null:nr(t,Ut({y:Ye(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))}function Ye({n:t=fe.n,k:e=0,strict:n=fe.strict,anchor:r=fe.anchor}={}){return xo({k:t,reduce:o=>ur(o)+e*(fr(o)||0),strict:n,anchor:r})}const Av={ariaLabel:"tick",fill:null,stroke:"currentColor"};let Ef=class extends et{constructor(e,n,r){super(e,n,r,Av),sn(this,r)}render(e,n,r,o,i){return U("svg:g",i).call(ot,this,o,i).call(this._transform,this,n).call(a=>a.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",this._x1(n,r,o)).attr("x2",this._x2(n,r,o)).attr("y1",this._y1(n,r,o)).attr("y2",this._y2(n,r,o)).call(ut,this,r).call(Zn,this,r,i)).node()}},Of=class extends Ef{constructor(e,n={}){const{x:r,y:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=n;super(e,{x:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n),this.insetTop=rt(a),this.insetBottom=rt(l)}_transform(e,n,{x:r}){e.call(tt,n,{x:r},wt,0)}_x1(e,{x:n}){return r=>n[r]}_x2(e,{x:n}){return r=>n[r]}_y1({y:e},{y:n},{marginTop:r}){const{insetTop:o}=this;return n&&e?i=>n[i]+o:r+o}_y2({y:e},{y:n},{height:r,marginBottom:o}){const{insetBottom:i}=this;return n&&e?a=>n[a]+e.bandwidth()-i:r-o-i}},Cf=class extends Ef{constructor(e,n={}){const{x:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=n;super(e,{y:{value:o,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n),this.insetRight=rt(a),this.insetLeft=rt(l)}_transform(e,n,{y:r}){e.call(tt,n,{y:r},0,wt)}_x1({x:e},{x:n},{marginLeft:r}){const{insetLeft:o}=this;return n&&e?i=>n[i]+o:r+o}_x2({x:e},{x:n},{width:r,marginRight:o}){const{insetRight:i}=this;return n&&e?a=>n[a]+e.bandwidth()-i:r-o-i}_y1(e,{y:n}){return r=>n[r]}_y2(e,{y:n}){return r=>n[r]}};function Nf(t,{x:e=D,...n}={}){return new Of(t,{...n,x:e})}function Rf(t,{y:e=D,...n}={}){return new Cf(t,{...n,y:e})}function Lv(t,{x:e=D,y:n=null,r,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}={}){const f=n!=null?Pn:si;return It(be(t,f({x1:Aa,x2:La},{x:e,y:n,stroke:a,strokeOpacity:l,...u})),De(t,f({x1:"p25",x2:"p75"},{x:e,y:n,fill:o,fillOpacity:i,...u})),Nf(t,f({x:"p50"},{x:e,y:n,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Le(t,Ut({x:Tf},{x:e,y:n,z:n,r,stroke:a,strokeOpacity:l,...u})))}function zv(t,{y:e=D,x:n=null,r,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}={}){const f=n!=null?Yn:si;return It(we(t,f({y1:Aa,y2:La},{x:n,y:e,stroke:a,strokeOpacity:l,...u})),qe(t,f({y1:"p25",y2:"p75"},{x:n,y:e,fill:o,fillOpacity:i,...u})),Rf(t,f({y:"p50"},{x:n,y:e,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Le(t,Ut({y:Tf},{x:n,y:e,z:n,r,stroke:a,strokeOpacity:l,...u})))}function Tf(t){const e=Aa(t),n=La(t);return t.map(r=>r<e||r>n?r:NaN)}function Aa(t){const e=If(t)*2.5-Bf(t)*1.5;return Nt(t,n=>n>=e?n:NaN)}function La(t){const e=Bf(t)*2.5-If(t)*1.5;return zt(t,n=>n<=e?n:NaN)}function If(t){return An(t,.25)}function Bf(t){return An(t,.75)}const Sv={ariaLabel:"raster",stroke:null,pixelSize:1};function wn(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Wf(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}let jf=class extends et{constructor(e,n,r={},o){let{width:i,height:a,x:l,y:s,x1:c=l==null?0:void 0,y1:u=s==null?0:void 0,x2:f=l==null?i:void 0,y2:h=s==null?a:void 0,pixelSize:d=o.pixelSize,blur:p=0,interpolate:m}=r;if(i!=null&&(i=Wf(i,"width")),a!=null&&(a=Wf(a,"height")),c!=null&&(c=wn(c,"x1")),u!=null&&(u=wn(u,"y1")),f!=null&&(f=wn(f,"x2")),h!=null&&(h=wn(h,"y2")),l==null&&(c==null||f==null))throw new Error("missing x");if(s==null&&(u==null||h==null))throw new Error("missing y");e!=null&&i!=null&&a!=null&&(l===void 0&&c!=null&&f!=null&&(l=Wv(c,f,i)),s===void 0&&u!=null&&h!=null&&(s=jv(u,h,i,a))),super(e,{x:{value:l,scale:"x",optional:!0},y:{value:s,scale:"y",optional:!0},x1:{value:c==null?null:[c],scale:"x",optional:!0,filter:null},y1:{value:u==null?null:[u],scale:"y",optional:!0,filter:null},x2:{value:f==null?null:[f],scale:"x",optional:!0,filter:null},y2:{value:h==null?null:[h],scale:"y",optional:!0,filter:null},...n},r,o),this.width=i,this.height=a,this.pixelSize=wn(d,"pixelSize"),this.blur=wn(p,"blur"),this.interpolate=l==null||s==null?null:Ov(m)}};class Ff extends jf{constructor(e,n={}){const{imageRendering:r}=n;if(e==null){const{fill:o,fillOpacity:i}=n;ht(i)[0]!==void 0&&(n=za("fillOpacity",n)),Mt(o)[0]!==void 0&&(n=za("fill",n))}super(e,void 0,n,Sv),this.imageRendering=pt(r,"auto")}scale(e,{color:n,...r},o){return super.scale(e,r,o)}render(e,n,r,o,i){const a=n[r.channels.fill?.scale]??(O=>O),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=qf(r,o,i),p=h-u,m=d-f,{pixelSize:$,width:y=Math.round(Math.abs(p)/$),height:g=Math.round(Math.abs(m)/$)}=this,x=y*g;let{fill:v,fillOpacity:b}=r,w=0;if(this.interpolate){const O=y/p,R=g/m,N=J(l,T=>(T-u)*O,Float64Array),F=J(s,T=>(T-f)*R,Float64Array);v&&(v=this.interpolate(e,y,g,N,F,v)),b&&(b=this.interpolate(e,y,g,N,F,b))}else this.data==null&&e&&(w=e.fi*x);const k=c.createElement("canvas");k.width=y,k.height=g;const M=k.getContext("2d"),A=M.createImageData(y,g),z=A.data;let{r:S,g:L,b:C}=On(this.fill)??{r:0,g:0,b:0},E=(this.fillOpacity??1)*255;for(let O=0;O<x;++O){const R=O<<2;if(v){const N=a(v[O+w]);if(N==null){z[R+3]=0;continue}({r:S,g:L,b:C}=On(N))}b&&(E=b[O+w]*255),z[R+0]=S,z[R+1]=L,z[R+2]=C,z[R+3]=E}return this.blur>0&&bm(A,this.blur),M.putImageData(A,0,0),U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(O=>O.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(q,"image-rendering",this.imageRendering).call(Q,this).attr("xlink:href",k.toDataURL())).node()}}function Df(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return r===void 0&&o===void 0&&_m(e)&&(r=Mr,o=Tn,i===void 0&&(i=qm)),[e,{...a,x:r,y:o,[t]:i}]}function Ev(){const[t,e]=Df("fill",...arguments);return new Ff(t,t==null||e.fill!==void 0||e.fillOpacity!==void 0?e:{...e,fill:D})}function qf({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&i==null?t[0]:f,e&&i==null?e[0]:s,n&&i==null?n[0]:a-c,r&&i==null?r[0]:l-u]}function Yf({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),qf(mi(l,o),i,a)}function za(t,e={}){const{[t]:n}=e;if(typeof n!="function")throw new Error(`invalid ${t}: not a function`);return Lt({...e,[t]:void 0},function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Yf(i,a,l,s),m=d-f,$=p-h,{pixelSize:y}=this,{width:g=Math.round(Math.abs(m)/y),height:x=Math.round(Math.abs($)/y)}=e,v=new Array(g*x*(o?o.length:1)),b=m/g,w=$/x;let k=0;for(const M of o??[void 0])for(let A=.5;A<x;++A)for(let z=.5;z<g;++z,++k)v[k]=n(c.invert(f+z*b),u.invert(h+A*w),M);return{data:v,facets:o,channels:{[t]:{value:v,scale:"auto"}}}})}function Ov(t){if(typeof t=="function")return t;if(t==null)return Sa;switch(`${t}`.toLowerCase()){case"none":return Sa;case"nearest":return Xf;case"barycentric":return Pf();case"random-walk":return _f()}throw new Error(`invalid interpolate: ${t}`)}function Sa(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function Pf({random:t=Eo(42)}={}){return(e,n,r,o,i,a)=>{const{points:l,triangles:s,hull:c}=Ge.from(e,d=>o[d],d=>i[d]),u=new a.constructor(n*r).fill(NaN),f=new Uint8Array(n*r),h=Bv(a,t);for(let d=0;d<s.length;d+=3){const p=s[d],m=s[d+1],$=s[d+2],y=l[2*p],g=l[2*m],x=l[2*$],v=l[2*p+1],b=l[2*m+1],w=l[2*$+1],k=Math.min(y,g,x),M=Math.max(y,g,x),A=Math.min(v,b,w),z=Math.max(v,b,w),S=(b-w)*(y-x)+(v-w)*(x-g);if(!S)continue;const L=a[e[p]],C=a[e[m]],E=a[e[$]];for(let O=Math.floor(k);O<M;++O)for(let R=Math.floor(A);R<z;++R){if(O<0||O>=n||R<0||R>=r)continue;const N=O+.5,F=R+.5,T=Math.sign(S),B=(b-w)*(N-x)+(F-w)*(x-g);if(B*T<0)continue;const j=(w-v)*(N-x)+(F-w)*(y-x);if(j*T<0)continue;const I=S-(B+j);if(I*T<0)continue;const Y=O+n*R;u[Y]=h(L,B/S,C,j/S,E,I/S,O,R),f[Y]=1}}return Cv(u,f,o,i,a,n,r,c,e,h),u}}function Cv(t,e,n,r,o,i,a,l,s,c){n=Float64Array.from(l,d=>n[s[d]]),r=Float64Array.from(l,d=>r[s[d]]),o=Array.from(l,d=>o[s[d]]);const u=n.length,f=Array.from({length:u},(d,p)=>Rv(p,n,r));let h=0;for(let d=0;d<a;++d){const p=d+.5;for(let m=0;m<i;++m){const $=m+i*d;if(!e[$]){const y=m+.5;for(let g=0;g<u;++g){const x=(u+h+(g%2?(g+1)/2:-g/2))%u;if(f[x](y,p)){const v=Nv(n.at(x-1),r.at(x-1),n[x],r[x],y,p);t[$]=c(o.at(x-1),v,o[x],1-v,o[x],0,m,d),h=x;break}}}}}}function Nv(t,e,n,r,o,i){const a=n-t,l=r-e,s=a*(n-o)+l*(r-i),c=a*(o-t)+l*(i-e);return s>0&&c>0?s/(s+c):+(s>c)}function or(t,e,n,r){return t*r-n*e}function Rv(t,e,n){const r=e.length,o=e.at(t-2),i=n.at(t-2),a=e.at(t-1),l=n.at(t-1),s=e[t],c=n[t],u=e.at(t+1-r),f=n.at(t+1-r),h=a-s,d=l-c,p=o-a,m=i-l,$=s-u,y=c-f,g=Math.hypot(h,d),x=Math.hypot(p,m),v=Math.hypot($,y);return(b,w)=>{const k=b-a,M=w-l,A=b-s,z=w-c;return or(k,M,A,z)>-1e-6&&or(k,M,h,d)*x-or(k,M,p,m)*g>-1e-6&&or(A,z,$,y)*g-or(A,z,h,d)*v<=0}}function Xf(t,e,n,r,o,i){const a=new i.constructor(e*n),l=Ge.from(t,u=>r[u],u=>o[u]);let s,c;for(let u=.5,f=0;u<n;++u){c=s;for(let h=.5;h<e;++h,++f)c=l.find(h,u,c),h===.5&&(s=c),a[f]=i[t[c]]}return a}function _f({random:t=Eo(42),minDistance:e=.5,maxSteps:n=2}={}){return(r,o,i,a,l,s)=>{const c=new s.constructor(o*i),u=Ge.from(r,p=>a[p],p=>l[p]);let f,h,d;for(let p=.5,m=0;p<i;++p){h=f;for(let $=.5;$<o;++$,++m){let y=$,g=p;d=h=u.find(y,g,h),$===.5&&(f=h);let x,v=0;for(;(x=Math.hypot(a[r[d]]-y,l[r[d]]-g))>e&&v<n;){const b=t($,p,v)*2*Math.PI;y+=Math.cos(b)*x,g+=Math.sin(b)*x,d=u.find(y,g,d),++v}c[m]=s[r[d]]}}return c}}function Tv(t,e,n,r,o,i){return e*t+r*n+i*o}function Iv(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}function Bv(t,e){return en(t)||At(t)?Tv:Iv(e)}function Wv(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let s=0;s<o;++s)i[s]=s%n*a+l;return i}}}function jv(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let c=0;c<i;++c)a[c]=Math.floor(c/n)%r*l+s;return a}}}const Gf={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};let Vf=class extends jf{constructor(e,{smooth:n=!0,value:r,...o}={}){const i=Mc({},o,Gf);if(r===void 0){for(const l in i)if(i[l].value!=null){if(r!==void 0)throw new Error("ambiguous contour value");r=o[l],o[l]="value"}}if(r!=null){const l={transform:s=>s.map(c=>c.value),label:_t(r)};for(const s in i)o[s]==="value"&&(o[s]=l)}if(e==null){if(r==null)throw new Error("missing contour value");o=za("value",{value:r,...o}),r=null}else{let{interpolate:l}=o;r===void 0&&(r=D),l===void 0&&(o.interpolate="nearest")}super(e,{value:{value:r,optional:!0}},Fv(o),Gf);const a={geometry:{value:D}};for(const l in this.channels){const s=this.channels[l],{scale:c}=s;c==="x"||c==="y"||l==="value"||(a[l]=s,delete this.channels[l])}this.contourChannels=a,this.smooth=!!n}filter(e,{x:n,y:r,value:o,...i},a){return super.filter(e,i,a)}render(e,n,r,o,i){const{geometry:a}=r,l=Kt();return U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(s=>{s.selectAll().data(e).enter().append("path").call(Q,this).attr("d",c=>l(a[c])).call(ut,this,r)}).node()}};function Fv({thresholds:t,interval:e,...n}){return t=ff(t,e,Ul),Lt(n,function(r,o,i,a,l,s){const[c,u,f,h]=Yf(i,a,l,s),d=f-c,p=h-u,{pixelSize:m,width:$=Math.round(Math.abs(d)/m),height:y=Math.round(Math.abs(p)/m)}=this,g=$/d,x=y/p,v=i.value.value,b=[];if(this.interpolate){const{x:z,y:S}=Hn(i,a,s),L=J(z,R=>(R-c)*g,Float64Array),C=J(S,R=>(R-u)*x,Float64Array),E=[i.x,i.y,i.value],O=[L,C,v];for(const R of o){const N=this.filter(R,E,O);b.push(this.interpolate(N,$,y,L,C,v))}}else if(o){const z=$*y,S=o.length;for(let L=0;L<S;++L)b.push(v.slice(L*z,L*z+z))}else b.push(v);if(this.blur>0)for(const z of b)km({data:z,width:$,height:y},this.blur);const w=Dv(t,v,...Yv(b));if(w===null)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=Mm().size([$,y]).smooth(this.smooth),M=[],A=[];for(const z of b)A.push(Mn(M.length,M.push(...J(w,S=>k(z,S)))));for(const{coordinates:z}of M)for(const S of z)for(const L of S)for(const C of L)C[0]=C[0]/g+c,C[1]=C[1]/x+u;return{data:M,facets:A,channels:Ws(this.contourChannels,M)}})}function Dv(t,e,n,r){if(typeof t?.range=="function")return t.range(t.floor(n),r);if(typeof t=="function"&&(t=t(e,n,r)),typeof t!="number")return ee(t);const o=Oo(...Am(n,r,t),t);for(;o[o.length-1]>=r;)o.pop();for(;o[1]<n;)o.shift();return o}function qv(){return new Vf(...Df("value",...arguments))}function Yv(t){return[Nt(t,e=>Nt(e,Hf)),zt(t,e=>zt(e,Hf))]}function Hf(t){return isFinite(t)?t:NaN}function Pv(t,e){return Ea(qi,t,e)}function Xv(t,e={}){return Ea(Yi,t,e)}function _v(t,e={}){return Ea(Pr,t,e)}function Ea(t,e,n={}){const{x:r,y:o,maxRadius:i}=n,a=t({px:r,py:o,maxRadius:i}),l=[];r!=null&&l.push(we(e,Zf("x",{...a,inset:-6},n))),o!=null&&l.push(be(e,Zf("y",{...a,inset:-6},n))),r!=null&&l.push(un(e,Kf("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),o!=null&&l.push(un(e,Kf("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const s of l)s.ariaLabel=`crosshair ${s.ariaLabel}`;return It(...l)}function Uf(t,{channels:e,...n},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...n,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...e,...s},transform:c,initializer:Gv(t,u)}}function Gv(t,e){return e==null?e:function(n,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=e.call(this,n,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,...t==="x"&&{x:u}},...f&&{py:f,...t==="y"&&{y:f}}},...d}}}function Zf(t,e,n){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=n;return{...Uf(t,e,n),stroke:i,strokeOpacity:a,strokeWidth:l}}function Kf(t,e,n){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="var(--plot-background)",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...Uf(t,e,Vv(t,n)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function Vv(t,e){return Lt(e,(n,r,o)=>({channels:{text:{value:gi(o,t)?.value}}}))}const Hv={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Uv={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Zv={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},Kv={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Qv={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};let Jv=class extends et{constructor(e,n={}){const{x:r,y:o,z:i,curve:a,tension:l}=n;super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:i,optional:!0}},n,Hv),this.curve=ua(a,l),sn(this,n)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=Ht(this,o),p=s?g=>s[g]:xt(h),m=c?g=>c[g]:xt(d),$=this;function y(g){let x=-1;const v=[],b={};for(const E in r)b[E]=[];const w=[],k=[],M=[],A=[];function z(E,O){E=g[E],O=g[O],v.push(++x),w[x]=p(E),M[x]=m(E),k[x]=p(O),A[x]=m(O);for(const R in r)b[R].push(r[R][O])}const{halfedges:S,hull:L,triangles:C}=Ge.from(g,p,m);for(let E=0;E<S.length;++E){const O=S[E];O>E&&z(C[E],C[O])}for(let E=0;E<L.length;++E)z(L[E],L[(E+1)%L.length]);de(this).selectAll().data(v).enter().append("path").call(Q,$).attr("d",E=>{const O=Qt(),R=f(O);return R.lineStart(),R.point(w[E],M[E]),R.point(k[E],A[E]),R.lineEnd(),O}).call(ut,$,b).call(Zn,$,b,i)}return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(u?g=>g.selectAll().data(Ce(e,x=>u[x]).values()).enter().append("g").each(y):g=>g.datum(e).each(y)).node()}},Oa=class extends et{constructor(e,n={},r,o=({z:i})=>i){const{x:i,y:a}=n;super(e,{x:{value:i,scale:"x",optional:!0},y:{value:a,scale:"y",optional:!0},z:{value:o(n),optional:!0}},n,r)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Ht(this,o),d=s?y=>s[y]:xt(f),p=c?y=>c[y]:xt(h),m=this;function $(y){const g=Ge.from(y,d,p);de(this).append("path").datum(y[0]).call(Q,m).attr("d",m._render(g,o)).call(ut,m,r)}return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(u?y=>y.selectAll().data(Ce(e,g=>u[g]).values()).enter().append("g").each($):y=>y.datum(e).each($)).node()}};class tx extends Oa{constructor(e,n={}){super(e,n,Uv),this.fill="none"}_render(e){return e.render()}}class ex extends Oa{constructor(e,n={}){super(e,n,Zv,$e)}_render(e){return e.renderHull()}}class nx extends et{constructor(e,n={}){const{x:r,y:o,z:i}=n;super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:i,optional:!0}},Lt(n,function(a,l,s,c,u,f){let{x:h,y:d,z:p}=s;({x:h,y:d}=Hn(s,c,f)),p=p?.value;const m=new Array((h??d).length).fill(null),[$,y]=Ht(this,u),g=h?v=>h[v]:xt($),x=d?v=>d[v]:xt(y);for(let v of l){h&&(v=v.filter(b=>vt(g(b)))),d&&(v=v.filter(b=>vt(x(b))));for(const[,b]of Be(v,p)){const w=Ge.from(b,g,x),k=Qf(w,u);for(let M=0,A=b.length;M<A;++M)m[b[M]]=k.renderCell(M)}}return{data:a,facets:l,channels:{cells:{value:m}}}}),Kv)}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,cells:u}=r;return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(f=>{f.selectAll().data(e).enter().append("path").call(Q,this).attr("d",h=>u[h]).call(ut,this,r)}).node()}}class rx extends Oa{constructor(e,n){super(e,n,Qv),this.fill="none"}_render(e,n){return Qf(e,n).render()}}function Qf(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function ir(t,e,{x:n,y:r,...o}={}){return[n,r]=Wt(n,r),new t(e,{...o,x:n,y:r})}function ox(t,e){return ir(Jv,t,e)}function ix(t,e){return ir(tx,t,e)}function ax(t,e){return ir(ex,t,e)}function lx(t,{x:e,y:n,initializer:r,...o}={}){return ir(nx,t,{...jt({...o,x:e,y:n},ju),initializer:r})}function sx(t,e){return ir(rx,t,e)}const cx={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};let Jf=class extends et{constructor(e,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=th(a)&&(a="currentColor",!0),u=th(l)&&(l="currentColor",!0);super(e,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:$e({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},hx({...s,fill:a,stroke:l},c,u),cx),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(e){return e}render(e,n,r,o,i){const{contours:a}=r,l=Kt();return U("svg:g",i).call(ot,this,o,i).call(tt,this,{}).call(s=>s.selectAll().data(e).enter().append("path").call(Q,this).call(ut,this,r).attr("d",c=>l(a[c]))).node()}};function ux(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new Jf(t,{...r,x:e,y:n})}const fx=new Set(["x","y","z","weight"]);function hx(t,e,n){let{bandwidth:r,thresholds:o}=t;return r=r===void 0?20:+r,o=o===void 0?20:typeof o?.[Symbol.iterator]=="function"?St(o):+o,Lt(t,function(i,a,l,s,c,u){const f=l.weight?St(l.weight.value):null,h=l.z?.value,{z:d}=this,[p,m]=Ht(this,c),{width:$,height:y}=c,{x:g,y:x}=Hn(l,s,u),v=Object.fromEntries(Object.entries(l).filter(([L])=>!fx.has(L)).map(([L,C])=>[L,{...C,value:[]}])),b=e&&[],w=n&&[],k=Lm().x(g?L=>g[L]:p).y(x?L=>x[L]:m).weight(f?L=>f[L]:1).size([$,y]).bandwidth(r),M=[];for(const L of a){const C=[];M.push(C);for(const E of h?ji(L,h,d):[L]){const O=k.contours(E);C.push([E,O])}}let A=o;if(!(A instanceof kr)){let L=0;for(const C of M)for(const[,E]of C){const O=E.max;O>L&&(L=O)}A=Float64Array.from({length:o-1},(C,E)=>L*100*(E+1)/o)}const z=[],S=[];for(const L of M){const C=[];z.push(C);for(const[E,O]of L)for(const R of A){C.push(S.length),S.push(O(R/100)),b&&b.push(R),w&&w.push(R);for(const N in v)v[N].value.push(l[N].value[E[0]])}}return b&&b.push(0),w&&w.push(0),{data:i,facets:z,channels:{...v,...b&&{fill:{value:b,scale:"color"}},...w&&{stroke:{value:w,scale:"color"}},contours:{value:S}}}})}function th(t){return/^density$/i.test(t)}function dx(t,e){return eh("x",t,e)}function px(t,e){return eh("y",t,e)}function eh(t,e,{x1:n,x2:r,y1:o,y2:i,x:a=n===void 0&&r===void 0?t==="y"?gt:D:void 0,y:l=o===void 0&&i===void 0?t==="x"?gt:D:void 0,fill:s,positiveFill:c="#3ca951",negativeFill:u="#4269d0",fillOpacity:f=1,positiveFillOpacity:h=f,negativeFillOpacity:d=f,stroke:p,strokeOpacity:m,z:$=Mt(p)[0],clip:y,tip:g,render:x,...v}={}){return[n,r]=nh(a,n,r),[o,i]=nh(l,o,i),n===r&&o===i&&(t==="y"?o=he(0):n=he(0)),{tip:g}=je({tip:g},t==="y"?"x":"y"),It(lt(c)?null:Object.assign(ya(e,{x1:n,x2:r,y1:o,y2:i,z:$,fill:c,fillOpacity:h,render:ln(x,rh(t,!0)),clip:y,...v}),{ariaLabel:"positive difference"}),lt(u)?null:Object.assign(ya(e,{x1:n,x2:r,y1:o,y2:i,z:$,fill:u,fillOpacity:d,render:ln(x,rh(t,!1)),clip:y,...v}),{ariaLabel:"negative difference"}),go(e,{x:r,y:i,z:$,stroke:p,strokeOpacity:m,tip:g,clip:!0,...v}))}function nh(t,e,n){return e===void 0&&n===void 0?e=n=he(t):e===void 0?(n=he(n),e=t===void 0?n:he(t)):n===void 0?(e=he(e),n=t===void 0?e:he(t)):(e=he(e),n=he(n)),[e,n]}function he(t){let e;const{value:n,label:r=_t(n)}=tn(t);return{transform:o=>e||(e=V(o,n)),label:r}}function rh(t,e){const n=t==="x"?"y":"x",r=`${n}1`,o=`${n}2`,i=`${t}1`,a=`${t}2`;return(l,s,c,u,f,h)=>{const{[r]:d,[o]:p}=c,m=new Float32Array(d.length),$=new Float32Array(p.length),y=u[t==="y"?"height":"width"];(e===ac(s[t])<0?m:$).fill(y);const g=h(l,s,{...c,[o]:d,[a]:$},u,f),x=h(l,s,{...c,[r]:p,[i]:m},u,f),v=g.querySelector("g")??g,b=x.querySelector("g")??x;for(let w=0;v.firstChild;w+=2){const k=kc(),M=U("svg:clipPath",f).attr("id",k).node();M.appendChild(v.firstChild),b.childNodes[w].setAttribute("clip-path",`url(#${k})`),b.insertBefore(M,b.childNodes[w])}return x}}function oh({geometry:t=D,...e}={}){const n=on(r=>V(r,t));return Lt({...e,x:null,y:null,geometry:{transform:n}},(r,o,i,a,l,{projection:s})=>{const c=n(r),u=c.length,f=new Float64Array(u),h=new Float64Array(u),d=Kt(s);for(let p=0;p<u;++p)[f[p],h[p]]=d.centroid(c[p]);return{data:r,facets:o,channels:{x:{value:f,scale:s==null?"x":null,source:null},y:{value:h,scale:s==null?"y":null,source:null}}}})}function mx({geometry:t=D,...e}={}){const n=on(o=>V(o,t)),r=on(o=>V(n(o),zm));return{...e,x:{transform:o=>Float64Array.from(r(o),([i])=>i)},y:{transform:o=>Float64Array.from(r(o),([,i])=>i)},geometry:{transform:n}}}const yx={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let ih=class extends et{constructor(e,n={}){const[r,o]=ht(n.r,3);super(e,{x:{value:n.tip?n.x:null,scale:"x",optional:!0},y:{value:n.tip?n.y:null,scale:"y",optional:!0},r:{value:r,scale:"r",filter:Jt,optional:!0},geometry:{value:n.geometry,scale:"projection"}},xa(n),yx),this.r=o}render(e,n,r,o,i){const{geometry:a,r:l}=r,s=Kt(i.projection??gx(n)),{r:c}=this;return vr(c)?e=[]:c!==void 0&&s.pointRadius(c),U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(u=>{u.selectAll().data(e).enter().append("path").call(Q,this).attr("d",l?f=>s.pointRadius(l[f])(a[f]):f=>s(a[f])).call(ut,this,r)}).node()}};function gx({x:t,y:e}){if(t||e)return t??=n=>n,e??=n=>n,mr({point(n,r){this.stream.point(t(n),e(r))}})}function Ca(t,e={}){return e.tip&&e.x===void 0&&e.y===void 0?e=oh(e):e.geometry===void 0&&(e={...e,geometry:D}),new ih(t,e)}function $x({strokeWidth:t=1.5,...e}={}){return Ca({type:"Sphere"},{strokeWidth:t,...e})}function vx({strokeOpacity:t=.1,...e}={}){return Ca(Sm(),{strokeOpacity:t,...e})}const ar=.5,lr=0;function xx(t={fill:"count"},{binWidth:e,...n}={}){const{z:r}=n;return e=e===void 0?20:rt(e),t=Es(t,n),ve(t,"fill")&&(n.channels={...n.channels,fill:{value:[]}}),n.symbol===void 0&&(n.symbol="hexagon"),n.r===void 0&&!ve(t,"r")&&(n.r=e/2),Lt(n,(o,i,a,l,s,c)=>{let{x:u,y:f,z:h,fill:d,stroke:p,symbol:m}=a;if(u===void 0)throw new Error("missing channel: x");if(f===void 0)throw new Error("missing channel: y");({x:u,y:f}=Hn(a,l,c)),h=h?h.value:V(o,r),d=d?.value,p=p?.value,m=m?.value;const $=hi(t,{z:h,fill:d,stroke:p,symbol:m}),y=h&&[],g=d&&[],x=p&&[],v=m&&[],b=[],w=[],k=[];let M=-1;for(const L of t)L.initialize(o);for(const L of i){const C=[];for(const E of t)E.scope("facet",L);for(const[E,O]of Be(L,$))for(const{index:R,extent:N}of wx(o,O,u,f,e)){C.push(++M),w.push(N.x),k.push(N.y),h&&y.push($===h?E:h[R[0]]),d&&g.push($===d?E:d[R[0]]),p&&x.push($===p?E:p[R[0]]),m&&v.push($===m?E:m[R[0]]);for(const F of t)F.reduce(R,N)}b.push(C)}const A=a.x.scale,z=a.y.scale,S={x:{value:w,source:l[A]?{value:J(w,l[A].invert),scale:A}:null},y:{value:k,source:l[z]?{value:J(k,l[z].invert),scale:z}:null},...h&&{z:{value:y}},...d&&{fill:{value:g,scale:"auto"}},...p&&{stroke:{value:x,scale:"auto"}},...m&&{symbol:{value:v,scale:"auto"}},...Object.fromEntries(t.map(({name:L,output:C})=>[L,{scale:"auto",label:C.label,radius:L==="r"?e/2:void 0,value:C.transform()}]))};return{data:o,facets:b,channels:S}})}function wx(t,e,n,r,o){const i=o*(1.5/Ms),a=new Map;for(const l of e){let s=n[l],c=r[l];if(isNaN(s)||isNaN(c))continue;let u=Math.round(c=(c-lr)/i),f=Math.round(s=(s-ar)/o-(u&1)/2),h=c-u;if(Math.abs(h)*3>1){let m=s-f,$=f+(s<f?-1:1)/2,y=u+(c<u?-1:1),g=s-$,x=c-y;m*m+h*h>g*g+x*x&&(f=$+(u&1?1:-1)/2,u=y)}const d=`${f},${u}`;let p=a.get(d);p===void 0&&(p={index:[],extent:{data:t,x:(f+(u&1)/2)*o+ar,y:u*i+lr}},a.set(d,p)),p.index.push(l)}return a.values()}const bx={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function kx(t){return new ah(t)}class ah extends et{constructor({binWidth:e=20,clip:n=!0,...r}={}){super(Rn,void 0,{clip:n,...r},bx),this.binWidth=rt(e)}render(e,n,r,o,i){const{binWidth:a}=this,{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u,width:f,height:h}=o,d=u-ar,p=f-s-ar,m=l-lr,$=h-c-lr,y=a/2,g=y*As,x=g/2,v=y*2,b=g*1.5,w=Math.floor(d/v),k=Math.ceil(p/v),M=Math.floor((m+x)/b),A=Math.ceil(($-x)/b)+1,z=`m0,${ze(-g)}l${ze(y)},${ze(x)}v${ze(g)}l${ze(-y)},${ze(x)}`;let S=z;for(let L=M;L<A;++L)for(let C=w;C<k;++C)S+=`M${ze(C*v+(L&1)*y)},${ze(L*b)}${z}`;return U("svg:g",i).datum(0).call(ot,this,o,i).call(tt,this,{},wt+ar,wt+lr).call(L=>L.append("path").call(Q,this).call(ut,this,r).attr("d",S)).node()}}function ze(t){return Math.round(t*1e3)/1e3}const Mx={ariaLabel:"image",fill:null,stroke:null};function Ax(t){return/^\.*\//.test(t)}function Lx(t){return/^(blob|data|file|http|https):/i.test(t)}function zx(t){return typeof t=="string"&&(Ax(t)||Lx(t))?[void 0,t]:[t,void 0]}class lh extends et{constructor(e,n={}){let{x:r,y:o,r:i,width:a,height:l,rotate:s,src:c,preserveAspectRatio:u,crossOrigin:f,frameAnchor:h,imageRendering:d}=n;i==null&&(i=void 0),i===void 0&&a===void 0&&l===void 0?a=l=16:a===void 0&&l!==void 0?a=l:l===void 0&&a!==void 0&&(l=a);const[p,m]=zx(c),[$,y]=ht(i),[g,x]=ht(a,y!==void 0?y*2:void 0),[v,b]=ht(l,y!==void 0?y*2:void 0),[w,k]=ht(s,0);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:$,scale:"r",filter:Jt,optional:!0},width:{value:g,filter:Jt,optional:!0},height:{value:v,filter:Jt,optional:!0},rotate:{value:w,optional:!0},src:{value:p,optional:!0}},xa(n),Mx),this.src=m,this.width=x,this.rotate=k,this.height=b,this.r=y,this.preserveAspectRatio=pt(u,"xMidYMid"),this.crossOrigin=kt(f),this.frameAnchor=jn(h),this.imageRendering=pt(d,"auto")}render(e,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,width:u,height:f,r:h,rotate:d,src:p}=r,{r:m,width:$,height:y,rotate:g}=this,[x,v]=Ht(this,o);return U("svg:g",i).call(ot,this,o,i).call(tt,this,{x:s&&a,y:c&&l}).call(b=>b.selectAll().data(e).enter().append("image").call(Q,this).attr("x",sh(s,u,h,x,$,m)).attr("y",sh(c,f,h,v,y,m)).attr("width",u?w=>u[w]:$!==void 0?$:h?w=>h[w]*2:m*2).attr("height",f?w=>f[w]:y!==void 0?y:h?w=>h[w]*2:m*2).attr("transform",d?w=>`rotate(${d[w]})`:g?`rotate(${g})`:null).attr("transform-origin",d||g?cn`${s?w=>s[w]:x}px ${c?w=>c[w]:v}px`:null).call(q,"href",p?w=>p[w]:this.src).call(q,"preserveAspectRatio",this.preserveAspectRatio).call(q,"crossorigin",this.crossOrigin).call(q,"image-rendering",this.imageRendering).call(q,"clip-path",h?w=>`circle(${h[w]}px)`:m!==void 0?`circle(${m}px)`:null).call(ut,this,r)).node()}}function sh(t,e,n,r,o,i){return e&&t?a=>t[a]-e[a]/2:e?a=>r-e[a]/2:t&&o!==void 0?a=>t[a]-o/2:o!==void 0?r-o/2:n&&t?a=>t[a]-n[a]:n?a=>r-n[a]:t?a=>t[a]-i:r-i}function Sx(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new lh(t,{...r,x:e,y:n})}function Ex(t,e,n){var r=1e-8,o=e-1,i=n-1,a=0,l,s,c,u,f,h,d,p,m,$,y;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(c=t<.5?t:1-t,u=Math.sqrt(-2*Math.log(c)),d=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,t<.5&&(d=-d),p=(d*d-3)/6,m=2/(1/(2*e-1)+1/(2*n-1)),$=d*Math.sqrt(p+m)/m-(1/(2*n-1)-1/(2*e-1))*(p+5/6-2/(3*m)),d=e/(e+n*Math.exp(2*$))):(l=Math.log(e/(e+n)),s=Math.log(n/(e+n)),u=Math.exp(e*l)/e,f=Math.exp(n*s)/n,$=u+f,t<u/$?d=Math.pow(e*$*t,1/e):d=1-Math.pow(n*$*(1-t),1/n)),y=-bn(e)-bn(n)+bn(e+n);a<10;a++){if(d===0||d===1)return d;if(h=Ox(d,e,n)-t,u=Math.exp(o*Math.log(d)+i*Math.log(1-d)+y),f=h/u,d-=u=f/(1-.5*Math.min(1,f*(o/d-i/(1-d)))),d<=0&&(d=.5*(d+u)),d>=1&&(d=.5*(d+u+1)),Math.abs(u)<r*d&&a>0)break}return d}function Ox(t,e,n){var r=t===0||t===1?0:Math.exp(bn(e+n)-bn(e)-bn(n)+e*Math.log(t)+n*Math.log(1-t));return t<0||t>1?!1:t<(e+1)/(e+n+2)?r*ch(t,e,n)/e:1-r*ch(1-t,n,e)/n}function ch(t,e,n){var r=1e-30,o=1,i=e+n,a=e+1,l=e-1,s=1,c=1-i*t/a,u,f,h,d;for(Math.abs(c)<r&&(c=r),c=1/c,d=c;o<=100&&(u=2*o,f=o*(n-o)*t/((l+u)*(e+u)),c=1+f*c,Math.abs(c)<r&&(c=r),s=1+f/s,Math.abs(s)<r&&(s=r),c=1/c,d*=c*s,f=-(e+o)*(i+o)*t/((e+u)*(a+u)),c=1+f*c,Math.abs(c)<r&&(c=r),s=1+f/s,Math.abs(s)<r&&(s=r),c=1/c,h=c*s,d*=h,!(Math.abs(h-1)<3e-7));o++);return d}function bn(t){var e=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,o,i,a;for(a=(i=o=t)+5.5,a-=(o+.5)*Math.log(a);e<6;e++)r+=n[e]/++i;return Math.log(2.506628274631*r/o)-a}function Cx(t,e){var n=Ex(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Nx={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let uh=class extends et{constructor(e,n={}){const{x:r,y:o,z:i,ci:a=.95,precision:l=4}=n;if(super(e,{x:{value:r,scale:"x"},y:{value:o,scale:"y"},z:{value:$e(n),optional:!0}},n,Nx),this.z=i,this.ci=+a,this.precision=+l,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${a}`);if(!(this.precision>0))throw new Error(`invalid precision: ${l}`)}render(e,n,r,o,i){const{x:a,y:l,z:s}=r,{ci:c}=this;return U("svg:g",i).call(ot,this,o,i).call(tt,this,n).call(u=>u.selectAll().data(s?ji(e,s,this.z):[e]).enter().call(f=>f.append("path").attr("fill","none").call(Q,this).call(qr,this,{...r,fill:null,fillOpacity:null}).attr("d",h=>this._renderLine(h,a,l)).call(c&&!nn(this.fill)?h=>h.select(Rx).attr("stroke","none").call(Q,this).call(qr,this,{...r,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",d=>this._renderBand(d,a,l)):()=>{}))).node()}};function Rx(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Ne.svg,"path"),this)}let Tx=class extends uh{constructor(e,n){super(e,n)}_renderBand(e,n,r){const{ci:o,precision:i}=this,[a,l]=yt(e,u=>r[u]),s=ko(e,r,n),c=fh(e,r,n,(1-o)/2,s);return jo().y(u=>u).x0(u=>c(u,-1)).x1(u=>c(u,1))(Mn(a,l-i/2,i).concat(l))}_renderLine(e,n,r){const[o,i]=yt(e,l=>r[l]),a=ko(e,r,n);return`M${a(o)},${o}L${a(i)},${i}`}},Ix=class extends uh{constructor(e,n){super(e,n)}_renderBand(e,n,r){const{ci:o,precision:i}=this,[a,l]=yt(e,u=>n[u]),s=ko(e,n,r),c=fh(e,n,r,(1-o)/2,s);return jo().x(u=>u).y0(u=>c(u,-1)).y1(u=>c(u,1))(Mn(a,l-i/2,i).concat(l))}_renderLine(e,n,r){const[o,i]=yt(e,l=>n[l]),a=ko(e,n,r);return`M${o},${a(o)}L${i},${a(i)}`}};function Bx(t,{y:e=gt,x:n=D,stroke:r,fill:o=lt(r)?"currentColor":r,...i}={}){return new Tx(t,ha({...i,x:n,y:e,fill:o,stroke:r}))}function Wx(t,{x:e=gt,y:n=D,stroke:r,fill:o=lt(r)?"currentColor":r,...i}={}){return new Ix(t,fa({...i,x:e,y:n,fill:o,stroke:r}))}function ko(t,e,n){let r=0,o=0,i=0,a=0;for(const u of t){const f=e[u],h=n[u];r+=f,o+=h,i+=f*h,a+=f*f}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return u=>s*u+c}function fh(t,e,n,r,o){const i=qt(t,u=>e[u])/t.length;let a=0,l=0;for(const u of t)a+=(e[u]-i)**2,l+=(n[u]-o(e[u]))**2;const s=Math.sqrt(l/(t.length-2)),c=Cx(r,t.length-2);return(u,f)=>{const h=o(u),d=s*Math.sqrt(1/t.length+(u-i)**2/a);return h+f*c*d}}function Na({path:t=D,delimiter:e,frameAnchor:n,treeLayout:r=yr,treeSort:o,treeSeparation:i,treeAnchor:a,treeFilter:l,...s}={}){a=Ra(a),o=dh(o),l!=null&&(l=Ia(l)),n===void 0&&(n=a.frameAnchor);const c=mh(e),u=kh(s,Ia),[f,h]=Ct(),[d,p]=Ct();return{x:f,y:d,frameAnchor:n,...jt(s,(m,$)=>{const y=c(V(m,t)),g=h([]),x=p([]);let v=-1;const b=[],w=[],k=Ql().path(z=>y[z]),M=te(m)?z=>z.data=m[z.data]:z=>z.data=m.get(z.data),A=r();A.nodeSize&&A.nodeSize([1,1]),A.separation&&i!==void 0&&A.separation(i??Vo);for(const z of u)z[Ao]=z[wh]([]);for(const z of $){const S=[],L=k(z.filter(C=>y[C]!=null)).each(M);o!=null&&L.sort(o),A(L);for(const C of L.descendants())if(!(l!=null&&!l(C))){S.push(++v),b[v]=C.data,a.position(C,v,g,x);for(const E of u)E[Ao][v]=E[bh](C)}w.push(S)}return{data:b,facets:w}}),...Object.fromEntries(u)}}function hh({path:t=D,delimiter:e,curve:n="bump-x",stroke:r="#555",strokeWidth:o=1.5,strokeOpacity:i=.5,treeLayout:a=yr,treeSort:l,treeSeparation:s,treeAnchor:c,treeFilter:u,...f}={}){c=Ra(c),l=dh(l),u!=null&&(u=$h(u)),f={curve:n,stroke:r,strokeWidth:o,strokeOpacity:i,...f};const h=mh(e),d=kh(f,$h),[p,m]=Ct(),[$,y]=Ct(),[g,x]=Ct(),[v,b]=Ct();return{x1:p,x2:$,y1:g,y2:v,...jt(f,(w,k)=>{const M=h(V(w,t)),A=m([]),z=y([]),S=x([]),L=b([]);let C=-1;const E=[],O=[],R=Ql().path(F=>M[F]),N=a();N.nodeSize&&N.nodeSize([1,1]),N.separation&&s!==void 0&&N.separation(s??Vo);for(const F of d)F[Ao]=F[wh]([]);for(const F of k){const T=[],B=R(F.filter(j=>M[j]!=null)).each(j=>j.data=w[j.data]);l!=null&&B.sort(l),N(B);for(const{source:j,target:I}of B.links())if(!(u!=null&&!u(I,j))){T.push(++C),E[C]=I.data,c.position(j,C,A,S),c.position(I,C,z,L);for(const Y of d)Y[Ao][C]=Y[bh](I,j)}O.push(T)}return{data:E,facets:O}}),...Object.fromEntries(d)}}function Ra(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return jx;case"right":return Fx}throw new Error(`invalid tree anchor: ${t}`)}const jx={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},Fx={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function dh(t){return t==null||typeof t=="function"?t:`${t}`.trim().toLowerCase().startsWith("node:")?ph(Ia(t)):ph(Dx(t))}function ph(t){return(e,n)=>Rt(t(e),t(n))}function Dx(t){return e=>e.data?.[t]}function mh(t="/"){if(t=`${t}`,t==="/")return n=>n;if(t.length!==1)throw new Error("delimiter must be exactly one character");const e=t.charCodeAt(0);return n=>n.map(r=>qx(r,e))}const Ta=92,yh=47;function qx(t,e){if(e===Ta)throw new Error("delimiter cannot be backslash");let n=!1;for(let r=0,o=t.length;r<o;++r){switch(t.charCodeAt(r)){case Ta:if(!n){n=!0;continue}break;case e:n?(t=t.slice(0,r-1)+t.slice(r),--r,--o):t=t.slice(0,r)+"/"+t.slice(r+1);break;case yh:n?(t=t.slice(0,r)+"\\\\"+t.slice(r),r+=2,o+=2):(t=t.slice(0,r)+"\\"+t.slice(r),++r,++o);break}n=!1}return t}function Yx(t){let e=!1;for(let n=0,r=t.length;n<r;++n){switch(t.charCodeAt(n)){case Ta:if(!e){e=!0;continue}case yh:e&&(t=t.slice(0,n-1)+t.slice(n),--n,--r);break}e=!1}return t}function gh(t){return Tt(t)&&typeof t.node=="function"}function Px(t){return Tt(t)&&typeof t.link=="function"}function Ia(t){if(gh(t))return t.node;if(t=`${t}`.trim().toLowerCase(),!!t.startsWith("node:")){switch(t){case"node:name":return Wa;case"node:path":return Ba;case"node:internal":return vh;case"node:external":return xh;case"node:depth":return ja;case"node:height":return Fa}throw new Error(`invalid node value: ${t}`)}}function $h(t){if(gh(t))return t.node;if(Px(t))return t.link;if(t=`${t}`.trim().toLowerCase(),!(!t.startsWith("node:")&&!t.startsWith("parent:"))){switch(t){case"parent:name":return Mo(Wa);case"parent:path":return Mo(Ba);case"parent:depth":return Mo(ja);case"parent:height":return Mo(Fa);case"node:name":return Wa;case"node:path":return Ba;case"node:internal":return vh;case"node:external":return xh;case"node:depth":return ja;case"node:height":return Fa}throw new Error(`invalid link value: ${t}`)}}function Ba(t){return t.id}function Wa(t){return Xx(t.id)}function ja(t){return t.depth}function Fa(t){return t.height}function vh(t){return!!t.children}function xh(t){return!t.children}function Mo(t){return(e,n)=>n==null?void 0:t(n)}function Xx(t){let e=t.length;for(;--e>0&&!_x(t,e););return Yx(t.slice(e+1))}function _x(t,e){if(t[e]==="/"){let n=0;for(;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}const wh=2,bh=3,Ao=4;function kh(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);i!==void 0&&n.push([r,...Ct(o),i])}return n}function Mh(t,{fill:e,stroke:n,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,marker:u,markerStart:f=u,markerEnd:h=u,dot:d=lt(f)&&lt(h),text:p="node:name",textStroke:m="var(--plot-background)",title:$="node:path",dx:y,dy:g,textAnchor:x,treeLayout:v=yr,textLayout:b=v===yr||v===Jl?"mirrored":"normal",tip:w,...k}={}){if(y===void 0&&(y=Ra(k.treeAnchor).dx),x!==void 0)throw new Error("textAnchor is not a configurable tree option");b=Ot(b,"textLayout",["mirrored","normal"]);function M(A){return un(t,Na({treeLayout:v,text:p,fill:e===void 0?"currentColor":e,stroke:m,dx:y,dy:g,title:$,...A,...k}))}return It($f(t,hh({treeLayout:v,markerStart:f,markerEnd:h,stroke:n!==void 0?n:e===void 0?"node:internal":e,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,...k})),d?Le(t,Na({treeLayout:v,fill:e===void 0?"node:internal":e,title:$,tip:w,...k})):null,p!=null?b==="mirrored"?[M({textAnchor:"start",treeFilter:"node:external"}),M({textAnchor:"end",treeFilter:"node:internal",dx:-y})]:M():null)}function Gx(t,e){return Mh(t,{...e,treeLayout:Jl})}const Ah={ariaLabel:"waffle"};class Lh extends $a{constructor(e,{unit:n=1,gap:r=1,round:o,render:i,multiple:a,...l}={}){super(e,{...l,render:ln(i,Sh("x"))},Ah),this.unit=Math.max(0,n),this.gap=+r,this.round=Eh(o),this.multiple=Oh(a)}}class zh extends va{constructor(e,{unit:n=1,gap:r=1,round:o,render:i,multiple:a,...l}={}){super(e,{...l,render:ln(i,Sh("y"))},Ah),this.unit=Math.max(0,n),this.gap=+r,this.round=Eh(o),this.multiple=Oh(a)}}function Sh(t){return function(e,n,r,o,i){const{unit:a,gap:l,rx:s,ry:c,round:u}=this,{document:f}=i,h=r.channels[`${t}1`].value,d=r.channels[`${t}2`].value,p=this[t==="y"?"_width":"_height"](n,r,o),m=this[t==="y"?"_x":"_y"](n,r,o),$=a*Vx(n.scales[t]),{multiple:y=Math.max(1,Math.floor(Math.sqrt(p/$)))}=this,g=Math.min(p/y,$*y),x=$*y,v=t==="y"?([S,L])=>[S*g,-L*x]:([S,L])=>[L*x,S*g],b=(p-y*g)/2,w=typeof m=="function"?S=>m(S)+b:m+b,k=n[t](0),M=Yg(),A=f.createElementNS(Ne.svg,"pattern");A.setAttribute("width",t==="y"?g:x),A.setAttribute("height",t==="y"?x:g),A.setAttribute("patternUnits","userSpaceOnUse");const z=A.appendChild(f.createElementNS(Ne.svg,"rect"));return z.setAttribute("x",l/2),z.setAttribute("y",l/2),z.setAttribute("width",(t==="y"?g:x)-l),z.setAttribute("height",(t==="y"?x:g)-l),s!=null&&z.setAttribute("rx",s),c!=null&&z.setAttribute("ry",c),U("svg:g",i).call(ot,this,o,i).call(this._transform,this,n).call(S=>S.selectAll().data(e).enter().append(()=>A.cloneNode(!0)).attr("id",L=>`${M}-${L}`).select("rect").call(Q,this).call(ut,this,r)).call(S=>S.selectAll().data(e).enter().append("path").attr("transform",t==="y"?cn`translate(${w},${k})`:cn`translate(${k},${w})`).attr("d",L=>`M${Da(u(h[L]/a),u(d[L]/a),y).map(v).join("L")}Z`).attr("fill",L=>`url(#${M}-${L})`).attr("stroke",this.stroke==null?null:L=>`url(#${M}-${L})`)).node()}}function Da(t,e,n){if(t<0||e<0){const r=Math.ceil(-Math.min(t,e)/n);return Da(t+r*n,e+r*n,n).map(([o,i])=>[o,i-r])}return e<t?Da(e,t,n):[[0,Math.ceil(t/n)],[Math.floor(t%n),Math.ceil(t/n)],[Math.floor(t%n),Math.floor(t/n)+t%1],[Math.ceil(t%n),Math.floor(t/n)+t%1],...t%n>n-1?[]:[[Math.ceil(t%n),Math.floor(t/n)],[n,Math.floor(t/n)]],[n,Math.floor(e/n)],[Math.ceil(e%n),Math.floor(e/n)],[Math.ceil(e%n),Math.floor(e/n)+e%1],[Math.floor(e%n),Math.floor(e/n)+e%1],...e%n<1?[]:[[Math.floor(e%n),Math.ceil(e/n)],[0,Math.ceil(e/n)]]]}function Eh(t){if(t===void 0||t===!1)return Number;if(t===!0)return Math.round;if(typeof t!="function")throw new Error(`invalid round: ${t}`);return t}function Oh(t){return t===void 0?void 0:Math.max(1,Math.floor(t))}function Vx({domain:t,range:e}){return Ch(e)/Ch(t)}function Ch(t){const[e,n]=yt(t);return n-e}function Hx(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D}),new Lh(t,Qr(Gi(Zr(e))))}function Ux(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D}),new zh(t,Jr(Vi(Kr(e))))}const Zx=({marginLeft:t})=>[1,t],Kx=({width:t,marginRight:e})=>[-1,t-e],Qx=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Jx=({marginTop:t})=>[1,t],t1=({height:t,marginBottom:e})=>[-1,t-e],e1=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Nh(t){return typeof t=="string"?{anchor:t}:t}function n1(t={},e={}){arguments.length===1&&([t,e]=Rh(t));let{anchor:n="left",padding:r=1,r:o=e.r}=Nh(t);switch(`${n}`.toLowerCase()){case"left":n=Zx;break;case"right":n=Kx;break;case"middle":n=Qx;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Th("x","y",n,rt(r),o,e)}function r1(t={},e={}){arguments.length===1&&([t,e]=Rh(t));let{anchor:n="bottom",padding:r=1,r:o=e.r}=Nh(t);switch(`${n}`.toLowerCase()){case"top":n=Jx;break;case"bottom":n=t1;break;case"middle":n=e1;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Th("y","x",n,rt(r),o,e)}function Rh(t){const{anchor:e,padding:n,...r}=t,{r:o}=r;return[{anchor:e,padding:n,r:o},r]}function Th(t,e,n,r,o,i){if(o!=null&&typeof o!="number"){let{channels:a,sort:l,reverse:s}=i;a=Jo(a),a?.r===void 0&&(i={...i,channels:{...a,r:{value:o,scale:"r"}}}),l===void 0&&s===void 0&&(i.sort={channel:"-r"})}return Lt(i,function(a,l,s,c,u,f){let{[e]:h,r:d}=s;if(!s[e])throw new Error(`missing channel: ${e}`);({[e]:h}=Hn(s,c,f));const p=d?void 0:o!==void 0?rt(o):this.r!==void 0?this.r:3;d&&(d=V(d.value,c[d.scale]||D,Float64Array));let[m,$]=n(u);const y=m?i1:o1,g=new Float64Array(h.length),x=d?v=>d[v]:()=>p;for(let v of l){const b=Cm();v=v.filter(d?k=>$r(h[k])&&Jt(d[k]):k=>$r(h[k]));const w=new Float64Array(2*v.length+2);for(const k of v){const M=x(k),A=m?M+r:0,z=h[k]-M,S=h[k]+M;let L=2;b.queryInterval(z-r,S+r,([,,E])=>{const O=g[E]-A,R=h[k]-h[E],N=r+(d?d[k]+d[E]:2*p),F=Math.sqrt(N*N-R*R);w[L++]=O-F,w[L++]=O+F});let C=w.slice(0,L);m&&(C=C.filter(E=>E>=0));t:for(const E of C.sort(y)){for(let O=0;O<L;O+=2)if(w[O]+1e-6<E&&E<w[O+1]-1e-6)continue t;g[k]=E+A;break}b.insert([z,S,k])}}m||(m=1);for(const v of l)for(const b of v)g[b]=g[b]*m+$;return{data:a,facets:l,channels:{[t]:{value:g,source:null},[e]:{value:h,source:s[e]},...d&&{r:{value:d,source:s.r}}}}})}function o1(t,e){return Math.abs(t)-Math.abs(e)}function i1(t,e){return t-e}function a1(t,e){return arguments.length===1&&({basis:t,...e}=t),ba(qa(t),e)}function l1(t,e){return arguments.length===1&&({basis:t,...e}=t),ka(qa(t),e)}function qa(t){if(t===void 0)return Ih;if(typeof t=="function")return Lo(Zo(t));if(/^p\d{2}$/i.test(t))return kn(Ho(t));switch(`${t}`.toLowerCase()){case"deviation":return u1;case"first":return Ih;case"last":return c1;case"max":return f1;case"mean":return h1;case"median":return d1;case"min":return p1;case"sum":return m1;case"extent":return s1}throw new Error(`invalid basis: ${t}`)}function Lo(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const i of e)r[i]=n[i]===null?NaN:n[i]/o}}}function kn(t){return Lo((e,n)=>t(e,r=>n[r]))}const s1={mapIndex(t,e,n){const[r,o]=yt(t,a=>e[a]),i=o-r;for(const a of t)n[a]=e[a]===null?NaN:(e[a]-r)/i}},Ih=Lo((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(vt(r))return r}}),c1=Lo((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(vt(r))return r}}),u1={mapIndex(t,e,n){const r=ur(t,i=>e[i]),o=fr(t,i=>e[i]);for(const i of t)n[i]=e[i]===null?NaN:o?(e[i]-r)/o:0}},f1=kn(zt),h1=kn(ur),d1=kn(Sn),p1=kn(Nt),m1=kn(qt);function y1(t,e){return Bh("x",t,e)}function g1(t,e){return Bh("y",t,e)}function Bh(t,e,n={}){let r,o=1;if(typeof e=="number")o=e,r=(c,u)=>+c+u;else{if(typeof e=="string"){const c=e.startsWith("-")?-1:1;[e,o]=Po(e.replace(/^[+-]/,"")),o*=c}e=Sr(e),r=(c,u)=>e.offset(c,u)}const i=`${t}1`,a=`${t}2`,l=Ut({[i]:c=>c.map(u=>r(u,o)),[a]:c=>c},n),s=l[a].transform;return l[a].transform=()=>{const c=s(),[u,f]=yt(c);return c.domain=o<0?[u,r(f,o)]:[r(u,o),f],c},l}function $1(t,e={}){if(typeof t=="string")switch(t.toLowerCase()){case"first":return Wh(e);case"last":return jh(e)}if(typeof t=="function")return Se(null,t,e);let n,r;for(n in t){if(r!==void 0)throw new Error("ambiguous selector; multiple inputs");r=v1(t[n])}if(r===void 0)throw new Error(`invalid selector: ${t}`);return Se(n,r,e)}function v1(t){if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"min":return Ya;case"max":return Pa}throw new Error(`unknown selector: ${t}`)}function Wh(t){return Se(null,M1,t)}function jh(t){return Se(null,A1,t)}function x1(t){return Se("x",Ya,t)}function w1(t){return Se("y",Ya,t)}function b1(t){return Se("x",Pa,t)}function k1(t){return Se("y",Pa,t)}function*M1(t){yield t[0]}function*A1(t){yield t[t.length-1]}function*Ya(t,e){yield Em(t,n=>e[n])}function*Pa(t,e){yield Bo(t,n=>e[n])}function Se(t,e,n){if(t!=null){if(n[t]==null)throw new Error(`missing channel: ${t}`);t=n[t]}const r=$e(n);return jt(n,(o,i)=>{const a=V(o,r),l=V(o,t),s=[];for(const c of i){const u=[];for(const f of a?Ce(c,h=>a[h]).values():[c])for(const h of e(f,l))u.push(h);s.push(u)}return{data:o,facets:s}})}et.prototype.plot=function({marks:t=[],...e}={}){return tf({...e,marks:[...t,this]})};export{fo as Area,vf as Arrow,$a as BarX,va as BarY,po as Cell,Vf as Contour,Jf as Density,mo as Dot,Vu as Frame,ih as Geo,ah as Hexgrid,lh as Image,yo as Line,gf as Link,et as Mark,Ff as Raster,eo as Rect,_c as RuleX,Gc as RuleY,Gr as Text,Of as TickX,Cf as TickY,Hu as Tip,Vr as Vector,Lh as WaffleX,zh as WaffleY,ya as area,tr as areaX,$n as areaY,G$ as arrow,ov as auto,bf as autoSpec,vu as axisFx,$u as axisFy,Qi as axisX,Ki as axisY,De as barX,qe as barY,Fe as bin,Me as binX,Ae as binY,Ye as bollinger,kv as bollingerX,Mv as bollingerY,Lv as boxX,zv as boxY,vn as cell,U$ as cellX,Z$ as cellY,oh as centroid,tv as circle,Gx as cluster,Ct as column,qv as contour,Pv as crosshair,Xv as crosshairX,_v as crosshairY,ox as delaunayLink,ix as delaunayMesh,ux as density,dx as differenceX,px as differenceY,n1 as dodgeX,r1 as dodgeY,Le as dot,Q$ as dotX,J$ as dotY,iy as filter,xy as find,bc as formatIsoDate,Wg as formatMonth,wc as formatNumber,jg as formatWeekday,aa as frame,Ca as geo,mx as geoCentroid,vx as graticule,Au as gridFx,ku as gridFy,Mu as gridX,bu as gridY,ci as group,Yn as groupX,Pn as groupY,si as groupZ,ev as hexagon,xx as hexbin,kx as hexgrid,ax as hull,D as identity,Sx as image,gt as indexOf,Lt as initializer,Xf as interpolateNearest,Sa as interpolateNone,Pf as interpolatorBarycentric,_f as interpolatorRandomWalk,B0 as legend,go as line,er as lineX,nr as lineY,Bx as linearRegressionX,Wx as linearRegressionY,$f as link,Ut as map,ba as mapX,ka as mapY,It as marks,qa as normalize,a1 as normalizeX,l1 as normalizeY,$s as numberInterval,tf as plot,qi as pointer,Yi as pointerX,Pr as pointerY,Ev as raster,ia as rect,oo as rectX,io as rectY,ay as reverse,we as ruleX,be as ruleY,hg as scale,$1 as select,Wh as selectFirst,jh as selectLast,b1 as selectMaxX,k1 as selectMaxY,x1 as selectMinX,w1 as selectMinY,y1 as shiftX,g1 as shiftY,ly as shuffle,Ls as sort,$x as sphere,M0 as spike,Fu as stackX,q0 as stackX1,Y0 as stackX2,Du as stackY,P0 as stackY1,X0 as stackY2,un as text,Zc as textX,Kc as textY,Nf as tickX,Rf as tickY,Xo as timeInterval,Uu as tip,jt as transform,Mh as tree,hh as treeLink,Na as treeNode,br as utcInterval,V as valueof,fu as vector,hu as vectorX,du as vectorY,lx as voronoi,sx as voronoiMesh,Hx as waffleX,Ux as waffleY,xo as window,fv as windowX,hv as windowY};
