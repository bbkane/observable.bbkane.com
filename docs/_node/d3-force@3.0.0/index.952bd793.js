import{quadtree as S}from"../d3-quadtree@3.0.1/index.e9fed2eb.js";import{dispatch as I}from"../d3-dispatch@3.0.1/index.be49ca5f.js";import{timer as T}from"../d3-timer@3.0.1/index.0ee6092b.js";function F(n,o){var f,v=1;n==null&&(n=0),o==null&&(o=0);function x(){var c,s=f.length,t,h=0,r=0;for(c=0;c<s;++c)t=f[c],h+=t.x,r+=t.y;for(h=(h/s-n)*v,r=(r/s-o)*v,c=0;c<s;++c)t=f[c],t.x-=h,t.y-=r}return x.initialize=function(c){f=c},x.x=function(c){return arguments.length?(n=+c,x):n},x.y=function(c){return arguments.length?(o=+c,x):o},x.strength=function(c){return arguments.length?(v=+c,x):v},x}function M(n){return function(){return n}}function D(n){return(n()-.5)*1e-6}function J(n){return n.x+n.vx}function L(n){return n.y+n.vy}function O(n){var o,f,v,x=1,c=1;typeof n!="function"&&(n=M(n==null?1:+n));function s(){for(var r,y=o.length,z,d,i,m,u,e,a=0;a<c;++a)for(z=S(o,J,L).visitAfter(t),r=0;r<y;++r)d=o[r],u=f[d.index],e=u*u,i=d.x+d.vx,m=d.y+d.vy,z.visit(g);function g(p,l,N,q,k){var w=p.data,E=p.r,A=u+E;if(w){if(w.index>d.index){var b=i-w.x-w.vx,C=m-w.y-w.vy,j=b*b+C*C;j<A*A&&(b===0&&(b=D(v),j+=b*b),C===0&&(C=D(v),j+=C*C),j=(A-(j=Math.sqrt(j)))/j*x,d.vx+=(b*=j)*(A=(E*=E)/(e+E)),d.vy+=(C*=j)*A,w.vx-=b*(A=1-A),w.vy-=C*A)}return}return l>i+A||q<i-A||N>m+A||k<m-A}}function t(r){if(r.data)return r.r=f[r.data.index];for(var y=r.r=0;y<4;++y)r[y]&&r[y].r>r.r&&(r.r=r[y].r)}function h(){if(o){var r,y=o.length,z;for(f=new Array(y),r=0;r<y;++r)z=o[r],f[z.index]=+n(z,r,o)}}return s.initialize=function(r,y){o=r,v=y,h()},s.iterations=function(r){return arguments.length?(c=+r,s):c},s.strength=function(r){return arguments.length?(x=+r,s):x},s.radius=function(r){return arguments.length?(n=typeof r=="function"?r:M(+r),h(),s):n},s}function P(n){return n.index}function B(n,o){var f=n.get(o);if(!f)throw new Error("node not found: "+o);return f}function R(n){var o=P,f=z,v,x=M(30),c,s,t,h,r,y=1;n==null&&(n=[]);function z(e){return 1/Math.min(t[e.source.index],t[e.target.index])}function d(e){for(var a=0,g=n.length;a<y;++a)for(var p=0,l,N,q,k,w,E,A;p<g;++p)l=n[p],N=l.source,q=l.target,k=q.x+q.vx-N.x-N.vx||D(r),w=q.y+q.vy-N.y-N.vy||D(r),E=Math.sqrt(k*k+w*w),E=(E-c[p])/E*e*v[p],k*=E,w*=E,q.vx-=k*(A=h[p]),q.vy-=w*A,N.vx+=k*(A=1-A),N.vy+=w*A}function i(){if(s){var e,a=s.length,g=n.length,p=new Map(s.map((N,q)=>[o(N,q,s),N])),l;for(e=0,t=new Array(a);e<g;++e)l=n[e],l.index=e,typeof l.source!="object"&&(l.source=B(p,l.source)),typeof l.target!="object"&&(l.target=B(p,l.target)),t[l.source.index]=(t[l.source.index]||0)+1,t[l.target.index]=(t[l.target.index]||0)+1;for(e=0,h=new Array(g);e<g;++e)l=n[e],h[e]=t[l.source.index]/(t[l.source.index]+t[l.target.index]);v=new Array(g),m(),c=new Array(g),u()}}function m(){if(s)for(var e=0,a=n.length;e<a;++e)v[e]=+f(n[e],e,n)}function u(){if(s)for(var e=0,a=n.length;e<a;++e)c[e]=+x(n[e],e,n)}return d.initialize=function(e,a){s=e,r=a,i()},d.links=function(e){return arguments.length?(n=e,i(),d):n},d.id=function(e){return arguments.length?(o=e,d):o},d.iterations=function(e){return arguments.length?(y=+e,d):y},d.strength=function(e){return arguments.length?(f=typeof e=="function"?e:M(+e),m(),d):f},d.distance=function(e){return arguments.length?(x=typeof e=="function"?e:M(+e),u(),d):x},d}function X(){let n=1;return()=>(n=(1664525*n+1013904223)%4294967296)/4294967296}function Y(n){return n.x}function G(n){return n.y}var H=10,K=Math.PI*(3-Math.sqrt(5));function Q(n){var o,f=1,v=.001,x=1-Math.pow(v,1/300),c=0,s=.6,t=new Map,h=T(z),r=I("tick","end"),y=X();n==null&&(n=[]);function z(){d(),r.call("tick",o),f<v&&(h.stop(),r.call("end",o))}function d(u){var e,a=n.length,g;u===void 0&&(u=1);for(var p=0;p<u;++p)for(f+=(c-f)*x,t.forEach(function(l){l(f)}),e=0;e<a;++e)g=n[e],g.fx==null?g.x+=g.vx*=s:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=s:(g.y=g.fy,g.vy=0);return o}function i(){for(var u=0,e=n.length,a;u<e;++u){if(a=n[u],a.index=u,a.fx!=null&&(a.x=a.fx),a.fy!=null&&(a.y=a.fy),isNaN(a.x)||isNaN(a.y)){var g=H*Math.sqrt(.5+u),p=u*K;a.x=g*Math.cos(p),a.y=g*Math.sin(p)}(isNaN(a.vx)||isNaN(a.vy))&&(a.vx=a.vy=0)}}function m(u){return u.initialize&&u.initialize(n,y),u}return i(),o={tick:d,restart:function(){return h.restart(z),o},stop:function(){return h.stop(),o},nodes:function(u){return arguments.length?(n=u,i(),t.forEach(m),o):n},alpha:function(u){return arguments.length?(f=+u,o):f},alphaMin:function(u){return arguments.length?(v=+u,o):v},alphaDecay:function(u){return arguments.length?(x=+u,o):+x},alphaTarget:function(u){return arguments.length?(c=+u,o):c},velocityDecay:function(u){return arguments.length?(s=1-u,o):1-s},randomSource:function(u){return arguments.length?(y=u,t.forEach(m),o):y},force:function(u,e){return arguments.length>1?(e==null?t.delete(u):t.set(u,m(e)),o):t.get(u)},find:function(u,e,a){var g=0,p=n.length,l,N,q,k,w;for(a==null?a=1/0:a*=a,g=0;g<p;++g)k=n[g],l=u-k.x,N=e-k.y,q=l*l+N*N,q<a&&(w=k,a=q);return w},on:function(u,e){return arguments.length>1?(r.on(u,e),o):r.on(u)}}}function U(){var n,o,f,v,x=M(-30),c,s=1,t=1/0,h=.81;function r(i){var m,u=n.length,e=S(n,Y,G).visitAfter(z);for(v=i,m=0;m<u;++m)o=n[m],e.visit(d)}function y(){if(n){var i,m=n.length,u;for(c=new Array(m),i=0;i<m;++i)u=n[i],c[u.index]=+x(u,i,n)}}function z(i){var m=0,u,e,a=0,g,p,l;if(i.length){for(g=p=l=0;l<4;++l)(u=i[l])&&(e=Math.abs(u.value))&&(m+=u.value,a+=e,g+=e*u.x,p+=e*u.y);i.x=g/a,i.y=p/a}else{u=i,u.x=u.data.x,u.y=u.data.y;do m+=c[u.data.index];while(u=u.next)}i.value=m}function d(i,m,u,e){if(!i.value)return!0;var a=i.x-o.x,g=i.y-o.y,p=e-m,l=a*a+g*g;if(p*p/h<l)return l<t&&(a===0&&(a=D(f),l+=a*a),g===0&&(g=D(f),l+=g*g),l<s&&(l=Math.sqrt(s*l)),o.vx+=a*i.value*v/l,o.vy+=g*i.value*v/l),!0;if(!(i.length||l>=t)){(i.data!==o||i.next)&&(a===0&&(a=D(f),l+=a*a),g===0&&(g=D(f),l+=g*g),l<s&&(l=Math.sqrt(s*l)));do i.data!==o&&(p=c[i.data.index]*v/l,o.vx+=a*p,o.vy+=g*p);while(i=i.next)}}return r.initialize=function(i,m){n=i,f=m,y()},r.strength=function(i){return arguments.length?(x=typeof i=="function"?i:M(+i),y(),r):x},r.distanceMin=function(i){return arguments.length?(s=i*i,r):Math.sqrt(s)},r.distanceMax=function(i){return arguments.length?(t=i*i,r):Math.sqrt(t)},r.theta=function(i){return arguments.length?(h=i*i,r):Math.sqrt(h)},r}function V(n,o,f){var v,x=M(.1),c,s;typeof n!="function"&&(n=M(+n)),o==null&&(o=0),f==null&&(f=0);function t(r){for(var y=0,z=v.length;y<z;++y){var d=v[y],i=d.x-o||1e-6,m=d.y-f||1e-6,u=Math.sqrt(i*i+m*m),e=(s[y]-u)*c[y]*r/u;d.vx+=i*e,d.vy+=m*e}}function h(){if(v){var r,y=v.length;for(c=new Array(y),s=new Array(y),r=0;r<y;++r)s[r]=+n(v[r],r,v),c[r]=isNaN(s[r])?0:+x(v[r],r,v)}}return t.initialize=function(r){v=r,h()},t.strength=function(r){return arguments.length?(x=typeof r=="function"?r:M(+r),h(),t):x},t.radius=function(r){return arguments.length?(n=typeof r=="function"?r:M(+r),h(),t):n},t.x=function(r){return arguments.length?(o=+r,t):o},t.y=function(r){return arguments.length?(f=+r,t):f},t}function W(n){var o=M(.1),f,v,x;typeof n!="function"&&(n=M(n==null?0:+n));function c(t){for(var h=0,r=f.length,y;h<r;++h)y=f[h],y.vx+=(x[h]-y.x)*v[h]*t}function s(){if(f){var t,h=f.length;for(v=new Array(h),x=new Array(h),t=0;t<h;++t)v[t]=isNaN(x[t]=+n(f[t],t,f))?0:+o(f[t],t,f)}}return c.initialize=function(t){f=t,s()},c.strength=function(t){return arguments.length?(o=typeof t=="function"?t:M(+t),s(),c):o},c.x=function(t){return arguments.length?(n=typeof t=="function"?t:M(+t),s(),c):n},c}function Z(n){var o=M(.1),f,v,x;typeof n!="function"&&(n=M(n==null?0:+n));function c(t){for(var h=0,r=f.length,y;h<r;++h)y=f[h],y.vy+=(x[h]-y.y)*v[h]*t}function s(){if(f){var t,h=f.length;for(v=new Array(h),x=new Array(h),t=0;t<h;++t)v[t]=isNaN(x[t]=+n(f[t],t,f))?0:+o(f[t],t,f)}}return c.initialize=function(t){f=t,s()},c.strength=function(t){return arguments.length?(o=typeof t=="function"?t:M(+t),s(),c):o},c.y=function(t){return arguments.length?(n=typeof t=="function"?t:M(+t),s(),c):n},c}export{F as forceCenter,O as forceCollide,R as forceLink,U as forceManyBody,V as forceRadial,Q as forceSimulation,W as forceX,Z as forceY};
